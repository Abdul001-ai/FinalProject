/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/get-session/route";
exports.ids = ["app/api/get-session/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Admin_Desktop_FinalProject_src_app_api_get_session_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/get-session/route.ts */ \"(rsc)/./src/app/api/get-session/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/get-session/route\",\n        pathname: \"/api/get-session\",\n        filename: \"route\",\n        bundlePath: \"app/api/get-session/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Admin\\\\Desktop\\\\FinalProject\\\\src\\\\app\\\\api\\\\get-session\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Admin_Desktop_FinalProject_src_app_api_get_session_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS4zLjVfQGJhYmVsK2NvcmVANy4yXzU5YTY4NWNlY2M4NjE0NmRiMjk1NjBkNmZkNWYwMTZjL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci9pbmRleC5qcz9uYW1lPWFwcCUyRmFwaSUyRmdldC1zZXNzaW9uJTJGcm91dGUmcGFnZT0lMkZhcGklMkZnZXQtc2Vzc2lvbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdldC1zZXNzaW9uJTJGcm91dGUudHMmYXBwRGlyPUMlM0ElNUNVc2VycyU1Q0FkbWluJTVDRGVza3RvcCU1Q0ZpbmFsUHJvamVjdCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDQWRtaW4lNUNEZXNrdG9wJTVDRmluYWxQcm9qZWN0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUM2QjtBQUMxRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcQWRtaW5cXFxcRGVza3RvcFxcXFxGaW5hbFByb2plY3RcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcZ2V0LXNlc3Npb25cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dldC1zZXNzaW9uL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2V0LXNlc3Npb25cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2dldC1zZXNzaW9uL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcQWRtaW5cXFxcRGVza3RvcFxcXFxGaW5hbFByb2plY3RcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcZ2V0LXNlc3Npb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/get-session/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/get-session/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/utils/auth */ \"(rsc)/./src/utils/auth.ts\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_try_catch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/try-catch */ \"(rsc)/./src/lib/try-catch.ts\");\n/* harmony import */ var _flags__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/flags */ \"(rsc)/./src/flags.ts\");\n\n\n\n\nasync function GET() {\n    const { data: session, error } = await (0,_lib_try_catch__WEBPACK_IMPORTED_MODULE_2__.tryCatch)((0,_utils_auth__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCookie)());\n    const config = await (0,_flags__WEBPACK_IMPORTED_MODULE_3__.getConfig)();\n    const headers = new Headers();\n    headers.set(\"Cache-Control\", \"no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0\");\n    headers.set(\"Pragma\", \"no-cache\");\n    headers.set(\"Expires\", \"0\");\n    if (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            session: null,\n            config\n        }, {\n            headers\n        });\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n        session,\n        config\n    }, {\n        headers\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9nZXQtc2Vzc2lvbi9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFtRDtBQUNUO0FBQ0E7QUFDUDtBQUU1QixlQUFlSTtJQUNwQixNQUFNLEVBQUVDLE1BQU1DLE9BQU8sRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUwsd0RBQVFBLENBQUNGLGlFQUFvQkE7SUFDcEUsTUFBTVEsU0FBUyxNQUFNTCxpREFBU0E7SUFFOUIsTUFBTU0sVUFBVSxJQUFJQztJQUNwQkQsUUFBUUUsR0FBRyxDQUFDLGlCQUFpQjtJQUM3QkYsUUFBUUUsR0FBRyxDQUFDLFVBQVU7SUFDdEJGLFFBQVFFLEdBQUcsQ0FBQyxXQUFXO0lBRXZCLElBQUlKLE9BQU87UUFDVCxPQUFPTixxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO1lBQ3ZCTixTQUFTO1lBQ1RFO1FBQ0YsR0FBRztZQUNEQztRQUNGO0lBQ0Y7SUFFQSxPQUFPUixxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO1FBQ3ZCTjtRQUNBRTtJQUNGLEdBQUc7UUFDREM7SUFDRjtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFkbWluXFxEZXNrdG9wXFxGaW5hbFByb2plY3RcXHNyY1xcYXBwXFxhcGlcXGdldC1zZXNzaW9uXFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRTZXNzaW9uRnJvbUNvb2tpZSB9IGZyb20gXCJAL3V0aWxzL2F1dGhcIlxyXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxyXG5pbXBvcnQgeyB0cnlDYXRjaCB9IGZyb20gXCJAL2xpYi90cnktY2F0Y2hcIlxyXG5pbXBvcnQgeyBnZXRDb25maWcgfSBmcm9tIFwiQC9mbGFnc1wiXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xyXG4gIGNvbnN0IHsgZGF0YTogc2Vzc2lvbiwgZXJyb3IgfSA9IGF3YWl0IHRyeUNhdGNoKGdldFNlc3Npb25Gcm9tQ29va2llKCkpXHJcbiAgY29uc3QgY29uZmlnID0gYXdhaXQgZ2V0Q29uZmlnKClcclxuXHJcbiAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKClcclxuICBoZWFkZXJzLnNldChcIkNhY2hlLUNvbnRyb2xcIiwgXCJuby1zdG9yZSwgbm8tY2FjaGUsIG11c3QtcmV2YWxpZGF0ZSwgcHJveHktcmV2YWxpZGF0ZSwgbWF4LWFnZT0wXCIpXHJcbiAgaGVhZGVycy5zZXQoXCJQcmFnbWFcIiwgXCJuby1jYWNoZVwiKVxyXG4gIGhlYWRlcnMuc2V0KFwiRXhwaXJlc1wiLCBcIjBcIilcclxuXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICBzZXNzaW9uOiBudWxsLFxyXG4gICAgICBjb25maWcsXHJcbiAgICB9LCB7XHJcbiAgICAgIGhlYWRlcnNcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgc2Vzc2lvbixcclxuICAgIGNvbmZpZyxcclxuICB9LCB7XHJcbiAgICBoZWFkZXJzXHJcbiAgfSlcclxufVxyXG4iXSwibmFtZXMiOlsiZ2V0U2Vzc2lvbkZyb21Db29raWUiLCJOZXh0UmVzcG9uc2UiLCJ0cnlDYXRjaCIsImdldENvbmZpZyIsIkdFVCIsImRhdGEiLCJzZXNzaW9uIiwiZXJyb3IiLCJjb25maWciLCJoZWFkZXJzIiwiSGVhZGVycyIsInNldCIsImpzb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/get-session/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CREDITS_EXPIRATION_YEARS: () => (/* binding */ CREDITS_EXPIRATION_YEARS),\n/* harmony export */   CREDIT_PACKAGES: () => (/* binding */ CREDIT_PACKAGES),\n/* harmony export */   EMAIL_VERIFICATION_TOKEN_EXPIRATION_SECONDS: () => (/* binding */ EMAIL_VERIFICATION_TOKEN_EXPIRATION_SECONDS),\n/* harmony export */   FREE_MONTHLY_CREDITS: () => (/* binding */ FREE_MONTHLY_CREDITS),\n/* harmony export */   GITHUB_REPO_URL: () => (/* binding */ GITHUB_REPO_URL),\n/* harmony export */   GOOGLE_OAUTH_CODE_VERIFIER_COOKIE_NAME: () => (/* binding */ GOOGLE_OAUTH_CODE_VERIFIER_COOKIE_NAME),\n/* harmony export */   GOOGLE_OAUTH_STATE_COOKIE_NAME: () => (/* binding */ GOOGLE_OAUTH_STATE_COOKIE_NAME),\n/* harmony export */   MAX_SESSIONS_PER_USER: () => (/* binding */ MAX_SESSIONS_PER_USER),\n/* harmony export */   MAX_TEAMS_CREATED_PER_USER: () => (/* binding */ MAX_TEAMS_CREATED_PER_USER),\n/* harmony export */   MAX_TEAMS_JOINED_PER_USER: () => (/* binding */ MAX_TEAMS_JOINED_PER_USER),\n/* harmony export */   MAX_TRANSACTIONS_PER_PAGE: () => (/* binding */ MAX_TRANSACTIONS_PER_PAGE),\n/* harmony export */   PASSWORD_RESET_TOKEN_EXPIRATION_SECONDS: () => (/* binding */ PASSWORD_RESET_TOKEN_EXPIRATION_SECONDS),\n/* harmony export */   REDIRECT_AFTER_SIGN_IN: () => (/* binding */ REDIRECT_AFTER_SIGN_IN),\n/* harmony export */   SESSION_COOKIE_NAME: () => (/* binding */ SESSION_COOKIE_NAME),\n/* harmony export */   SITE_DESCRIPTION: () => (/* binding */ SITE_DESCRIPTION),\n/* harmony export */   SITE_DOMAIN: () => (/* binding */ SITE_DOMAIN),\n/* harmony export */   SITE_NAME: () => (/* binding */ SITE_NAME),\n/* harmony export */   SITE_URL: () => (/* binding */ SITE_URL)\n/* harmony export */ });\nconst SITE_NAME = \"Azad Call\";\nconst SITE_DESCRIPTION = \"Azad Call is an AI Call Agent that answers, routes, and automates phone conversations with human‑like voice, real‑time intelligence, and CRM integrations.\";\nconst SITE_URL =  true ? \"http://localhost:3000\" : 0;\nconst GITHUB_REPO_URL = \"https://github.com/LubomirGeorgiev/cloudflare-workers-nextjs-saas-template\";\nconst SITE_DOMAIN = new URL(SITE_URL).hostname;\nconst PASSWORD_RESET_TOKEN_EXPIRATION_SECONDS = 24 * 60 * 60 // 24 hours\n;\nconst EMAIL_VERIFICATION_TOKEN_EXPIRATION_SECONDS = 24 * 60 * 60 // 24 hours\n;\nconst MAX_SESSIONS_PER_USER = 5;\nconst MAX_TEAMS_CREATED_PER_USER = 3;\nconst MAX_TEAMS_JOINED_PER_USER = 10;\nconst SESSION_COOKIE_NAME = \"session\";\nconst GOOGLE_OAUTH_STATE_COOKIE_NAME = \"google-oauth-state\";\nconst GOOGLE_OAUTH_CODE_VERIFIER_COOKIE_NAME = \"google-oauth-code-verifier\";\nconst CREDIT_PACKAGES = [\n    {\n        id: \"package-1\",\n        credits: 500,\n        price: 5\n    },\n    {\n        id: \"package-2\",\n        credits: 1200,\n        price: 10\n    },\n    {\n        id: \"package-3\",\n        credits: 3000,\n        price: 20\n    }\n];\nconst CREDITS_EXPIRATION_YEARS = 2;\nconst FREE_MONTHLY_CREDITS = CREDIT_PACKAGES[0].credits * 0.1;\nconst MAX_TRANSACTIONS_PER_PAGE = 10;\nconst REDIRECT_AFTER_SIGN_IN = \"/dashboard\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29uc3RhbnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVPLE1BQU1BLFlBQVksWUFBVztBQUM3QixNQUFNQyxtQkFBbUIsNkpBQTRKO0FBQ3JMLE1BQU1DLFdBQVdDLEtBQXNDLEdBQUcsMEJBQTBCLENBQWdEO0FBQ3BJLE1BQU1DLGtCQUFrQiw2RUFBNEU7QUFFcEcsTUFBTUMsY0FBYyxJQUFJQyxJQUFJSixVQUFVSyxRQUFRO0FBQzlDLE1BQU1DLDBDQUEwQyxLQUFLLEtBQUssR0FBRyxXQUFXO0NBQVo7QUFDNUQsTUFBTUMsOENBQThDLEtBQUssS0FBSyxHQUFHLFdBQVc7Q0FBWjtBQUNoRSxNQUFNQyx3QkFBd0IsRUFBRTtBQUNoQyxNQUFNQyw2QkFBNkIsRUFBRTtBQUNyQyxNQUFNQyw0QkFBNEIsR0FBRztBQUNyQyxNQUFNQyxzQkFBc0IsVUFBVTtBQUN0QyxNQUFNQyxpQ0FBaUMscUJBQXFCO0FBQzVELE1BQU1DLHlDQUF5Qyw2QkFBNkI7QUFFNUUsTUFBTUMsa0JBQWtCO0lBQzdCO1FBQUVDLElBQUk7UUFBYUMsU0FBUztRQUFLQyxPQUFPO0lBQUU7SUFDMUM7UUFBRUYsSUFBSTtRQUFhQyxTQUFTO1FBQU1DLE9BQU87SUFBRztJQUM1QztRQUFFRixJQUFJO1FBQWFDLFNBQVM7UUFBTUMsT0FBTztJQUFHO0NBQzdDLENBQVU7QUFFSixNQUFNQywyQkFBMkIsRUFBRTtBQUVuQyxNQUFNQyx1QkFBdUJMLGVBQWUsQ0FBQyxFQUFFLENBQUNFLE9BQU8sR0FBRyxJQUFJO0FBQzlELE1BQU1JLDRCQUE0QixHQUFHO0FBQ3JDLE1BQU1DLHlCQUF5QixhQUFzQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pblxcRGVza3RvcFxcRmluYWxQcm9qZWN0XFxzcmNcXGNvbnN0YW50cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFJvdXRlIH0gZnJvbSBcIm5leHRcIlxyXG5cclxuZXhwb3J0IGNvbnN0IFNJVEVfTkFNRSA9IFwiQXphZCBDYWxsXCJcclxuZXhwb3J0IGNvbnN0IFNJVEVfREVTQ1JJUFRJT04gPSBcIkF6YWQgQ2FsbCBpcyBhbiBBSSBDYWxsIEFnZW50IHRoYXQgYW5zd2Vycywgcm91dGVzLCBhbmQgYXV0b21hdGVzIHBob25lIGNvbnZlcnNhdGlvbnMgd2l0aCBodW1hbuKAkWxpa2Ugdm9pY2UsIHJlYWzigJF0aW1lIGludGVsbGlnZW5jZSwgYW5kIENSTSBpbnRlZ3JhdGlvbnMuXCJcclxuZXhwb3J0IGNvbnN0IFNJVEVfVVJMID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIiA/IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIgOiBcImh0dHBzOi8vbmV4dGpzLXNhYXMtdGVtcGxhdGUuYWdlbnRpY2Rldi5hZ2VuY3lcIlxyXG5leHBvcnQgY29uc3QgR0lUSFVCX1JFUE9fVVJMID0gXCJodHRwczovL2dpdGh1Yi5jb20vTHVib21pckdlb3JnaWV2L2Nsb3VkZmxhcmUtd29ya2Vycy1uZXh0anMtc2Fhcy10ZW1wbGF0ZVwiXHJcblxyXG5leHBvcnQgY29uc3QgU0lURV9ET01BSU4gPSBuZXcgVVJMKFNJVEVfVVJMKS5ob3N0bmFtZVxyXG5leHBvcnQgY29uc3QgUEFTU1dPUkRfUkVTRVRfVE9LRU5fRVhQSVJBVElPTl9TRUNPTkRTID0gMjQgKiA2MCAqIDYwIC8vIDI0IGhvdXJzXHJcbmV4cG9ydCBjb25zdCBFTUFJTF9WRVJJRklDQVRJT05fVE9LRU5fRVhQSVJBVElPTl9TRUNPTkRTID0gMjQgKiA2MCAqIDYwIC8vIDI0IGhvdXJzXHJcbmV4cG9ydCBjb25zdCBNQVhfU0VTU0lPTlNfUEVSX1VTRVIgPSA1O1xyXG5leHBvcnQgY29uc3QgTUFYX1RFQU1TX0NSRUFURURfUEVSX1VTRVIgPSAzO1xyXG5leHBvcnQgY29uc3QgTUFYX1RFQU1TX0pPSU5FRF9QRVJfVVNFUiA9IDEwO1xyXG5leHBvcnQgY29uc3QgU0VTU0lPTl9DT09LSUVfTkFNRSA9IFwic2Vzc2lvblwiO1xyXG5leHBvcnQgY29uc3QgR09PR0xFX09BVVRIX1NUQVRFX0NPT0tJRV9OQU1FID0gXCJnb29nbGUtb2F1dGgtc3RhdGVcIjtcclxuZXhwb3J0IGNvbnN0IEdPT0dMRV9PQVVUSF9DT0RFX1ZFUklGSUVSX0NPT0tJRV9OQU1FID0gXCJnb29nbGUtb2F1dGgtY29kZS12ZXJpZmllclwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IENSRURJVF9QQUNLQUdFUyA9IFtcclxuICB7IGlkOiBcInBhY2thZ2UtMVwiLCBjcmVkaXRzOiA1MDAsIHByaWNlOiA1IH0sXHJcbiAgeyBpZDogXCJwYWNrYWdlLTJcIiwgY3JlZGl0czogMTIwMCwgcHJpY2U6IDEwIH0sXHJcbiAgeyBpZDogXCJwYWNrYWdlLTNcIiwgY3JlZGl0czogMzAwMCwgcHJpY2U6IDIwIH0sXHJcbl0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgQ1JFRElUU19FWFBJUkFUSU9OX1lFQVJTID0gMjtcclxuXHJcbmV4cG9ydCBjb25zdCBGUkVFX01PTlRITFlfQ1JFRElUUyA9IENSRURJVF9QQUNLQUdFU1swXS5jcmVkaXRzICogMC4xO1xyXG5leHBvcnQgY29uc3QgTUFYX1RSQU5TQUNUSU9OU19QRVJfUEFHRSA9IDEwO1xyXG5leHBvcnQgY29uc3QgUkVESVJFQ1RfQUZURVJfU0lHTl9JTiA9IFwiL2Rhc2hib2FyZFwiIGFzIFJvdXRlO1xyXG4iXSwibmFtZXMiOlsiU0lURV9OQU1FIiwiU0lURV9ERVNDUklQVElPTiIsIlNJVEVfVVJMIiwicHJvY2VzcyIsIkdJVEhVQl9SRVBPX1VSTCIsIlNJVEVfRE9NQUlOIiwiVVJMIiwiaG9zdG5hbWUiLCJQQVNTV09SRF9SRVNFVF9UT0tFTl9FWFBJUkFUSU9OX1NFQ09ORFMiLCJFTUFJTF9WRVJJRklDQVRJT05fVE9LRU5fRVhQSVJBVElPTl9TRUNPTkRTIiwiTUFYX1NFU1NJT05TX1BFUl9VU0VSIiwiTUFYX1RFQU1TX0NSRUFURURfUEVSX1VTRVIiLCJNQVhfVEVBTVNfSk9JTkVEX1BFUl9VU0VSIiwiU0VTU0lPTl9DT09LSUVfTkFNRSIsIkdPT0dMRV9PQVVUSF9TVEFURV9DT09LSUVfTkFNRSIsIkdPT0dMRV9PQVVUSF9DT0RFX1ZFUklGSUVSX0NPT0tJRV9OQU1FIiwiQ1JFRElUX1BBQ0tBR0VTIiwiaWQiLCJjcmVkaXRzIiwicHJpY2UiLCJDUkVESVRTX0VYUElSQVRJT05fWUVBUlMiLCJGUkVFX01PTlRITFlfQ1JFRElUUyIsIk1BWF9UUkFOU0FDVElPTlNfUEVSX1BBR0UiLCJSRURJUkVDVF9BRlRFUl9TSUdOX0lOIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/constants.ts\n");

/***/ }),

/***/ "(rsc)/./src/db/index.ts":
/*!*************************!*\
  !*** ./src/db/index.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getDB: () => (/* binding */ getDB)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_d1__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/d1 */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/d1/driver.js\");\n/* harmony import */ var _opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @opennextjs/cloudflare */ \"(rsc)/./node_modules/.pnpm/@opennextjs+cloudflare@1.6.5_wrangler@4.28.0/node_modules/@opennextjs/cloudflare/dist/api/index.js\");\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./schema */ \"(rsc)/./src/db/schema.ts\");\n\n\n\nlet db = null;\nconst getDB = ()=>{\n    if (db) {\n        return db;\n    }\n    const { env } = (0,_opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_0__.getCloudflareContext)();\n    if (!env.NEXT_TAG_CACHE_D1) {\n        throw new Error(\"D1 database not found\");\n    }\n    db = (0,drizzle_orm_d1__WEBPACK_IMPORTED_MODULE_2__.drizzle)(env.NEXT_TAG_CACHE_D1, {\n        schema: _schema__WEBPACK_IMPORTED_MODULE_1__,\n        logger: true\n    });\n    return db;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZGIvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBeUM7QUFDcUI7QUFHM0I7QUFFNUIsSUFBSUcsS0FBOEMsS0FBSztBQUV2RCxNQUFNQyxRQUFRO0lBQ25CLElBQUlELElBQUk7UUFDTixPQUFPQTtJQUNUO0lBRUEsTUFBTSxFQUFFRSxHQUFHLEVBQUUsR0FBR0osNEVBQW9CQTtJQUVwQyxJQUFJLENBQUNJLElBQUlDLGlCQUFpQixFQUFFO1FBQzFCLE1BQU0sSUFBSUMsTUFBTTtJQUNsQjtJQUVBSixLQUFLSCx1REFBT0EsQ0FBQ0ssSUFBSUMsaUJBQWlCLEVBQUU7UUFBRUosTUFBTUEsc0NBQUFBO1FBQUVNLFFBQVE7SUFBSztJQUUzRCxPQUFPTDtBQUNULEVBQUUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW5cXERlc2t0b3BcXEZpbmFsUHJvamVjdFxcc3JjXFxkYlxcaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZHJpenpsZSB9IGZyb20gXCJkcml6emxlLW9ybS9kMVwiO1xyXG5pbXBvcnQgeyBnZXRDbG91ZGZsYXJlQ29udGV4dCB9IGZyb20gXCJAb3Blbm5leHRqcy9jbG91ZGZsYXJlXCI7XHJcbmltcG9ydCB0eXBlIHsgRHJpenpsZUQxRGF0YWJhc2UgfSBmcm9tIFwiZHJpenpsZS1vcm0vZDFcIjtcclxuXHJcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tIFwiLi9zY2hlbWFcIjtcclxuXHJcbmV4cG9ydCBsZXQgZGI6IERyaXp6bGVEMURhdGFiYXNlPHR5cGVvZiBzY2hlbWE+IHwgbnVsbCA9IG51bGw7XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0REIgPSAoKSA9PiB7XHJcbiAgaWYgKGRiKSB7XHJcbiAgICByZXR1cm4gZGI7XHJcbiAgfVxyXG5cclxuICBjb25zdCB7IGVudiB9ID0gZ2V0Q2xvdWRmbGFyZUNvbnRleHQoKTtcclxuXHJcbiAgaWYgKCFlbnYuTkVYVF9UQUdfQ0FDSEVfRDEpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkQxIGRhdGFiYXNlIG5vdCBmb3VuZFwiKTtcclxuICB9XHJcblxyXG4gIGRiID0gZHJpenpsZShlbnYuTkVYVF9UQUdfQ0FDSEVfRDEsIHsgc2NoZW1hLCBsb2dnZXI6IHRydWUgfSk7XHJcblxyXG4gIHJldHVybiBkYjtcclxufTtcclxuIl0sIm5hbWVzIjpbImRyaXp6bGUiLCJnZXRDbG91ZGZsYXJlQ29udGV4dCIsInNjaGVtYSIsImRiIiwiZ2V0REIiLCJlbnYiLCJORVhUX1RBR19DQUNIRV9EMSIsIkVycm9yIiwibG9nZ2VyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/db/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/db/schema.ts":
/*!**************************!*\
  !*** ./src/db/schema.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CREDIT_TRANSACTION_TYPE: () => (/* binding */ CREDIT_TRANSACTION_TYPE),\n/* harmony export */   PURCHASABLE_ITEM_TYPE: () => (/* binding */ PURCHASABLE_ITEM_TYPE),\n/* harmony export */   ROLES_ENUM: () => (/* binding */ ROLES_ENUM),\n/* harmony export */   SYSTEM_ROLES_ENUM: () => (/* binding */ SYSTEM_ROLES_ENUM),\n/* harmony export */   TEAM_PERMISSIONS: () => (/* binding */ TEAM_PERMISSIONS),\n/* harmony export */   creditTransactionRelations: () => (/* binding */ creditTransactionRelations),\n/* harmony export */   creditTransactionTable: () => (/* binding */ creditTransactionTable),\n/* harmony export */   creditTransactionTypeTuple: () => (/* binding */ creditTransactionTypeTuple),\n/* harmony export */   passKeyCredentialRelations: () => (/* binding */ passKeyCredentialRelations),\n/* harmony export */   passKeyCredentialTable: () => (/* binding */ passKeyCredentialTable),\n/* harmony export */   purchasableItemTypeTuple: () => (/* binding */ purchasableItemTypeTuple),\n/* harmony export */   purchasedItemsRelations: () => (/* binding */ purchasedItemsRelations),\n/* harmony export */   purchasedItemsTable: () => (/* binding */ purchasedItemsTable),\n/* harmony export */   systemRoleTuple: () => (/* binding */ systemRoleTuple),\n/* harmony export */   teamInvitationRelations: () => (/* binding */ teamInvitationRelations),\n/* harmony export */   teamInvitationTable: () => (/* binding */ teamInvitationTable),\n/* harmony export */   teamMembershipRelations: () => (/* binding */ teamMembershipRelations),\n/* harmony export */   teamMembershipTable: () => (/* binding */ teamMembershipTable),\n/* harmony export */   teamRelations: () => (/* binding */ teamRelations),\n/* harmony export */   teamRoleRelations: () => (/* binding */ teamRoleRelations),\n/* harmony export */   teamRoleTable: () => (/* binding */ teamRoleTable),\n/* harmony export */   teamTable: () => (/* binding */ teamTable),\n/* harmony export */   userRelations: () => (/* binding */ userRelations),\n/* harmony export */   userTable: () => (/* binding */ userTable)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sqlite-core/columns/integer.js\");\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sqlite-core/table.js\");\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sqlite-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sqlite-core/indexes.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sql/sql.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/relations.js\");\n/* harmony import */ var _paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @paralleldrive/cuid2 */ \"(rsc)/./node_modules/.pnpm/@paralleldrive+cuid2@2.2.2/node_modules/@paralleldrive/cuid2/index.js\");\n\n\n\nconst ROLES_ENUM = {\n    ADMIN: 'admin',\n    USER: 'user'\n};\nconst roleTuple = Object.values(ROLES_ENUM);\nconst commonColumns = {\n    createdAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).$defaultFn(()=>new Date()).notNull(),\n    updatedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).$onUpdateFn(()=>new Date()).notNull(),\n    updateCounter: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).$onUpdate(()=>(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.sql)`updateCounter + 1`)\n};\nconst userTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"user\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`usr_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    firstName: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    lastName: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    email: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).unique(),\n    passwordHash: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)(),\n    role: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        enum: roleTuple\n    }).default(ROLES_ENUM.USER).notNull(),\n    emailVerified: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    signUpIpAddress: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 100\n    }),\n    googleAccountId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    /**\r\n   * This can either be an absolute or relative path to an image\r\n   */ avatar: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 600\n    }),\n    // Credit system fields\n    currentCredits: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).notNull(),\n    lastCreditRefreshAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    })\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('email_idx').on(table.email),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('google_account_id_idx').on(table.googleAccountId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('role_idx').on(table.role)\n    ]);\nconst passKeyCredentialTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"passkey_credential\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`pkey_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    credentialId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull().unique(),\n    credentialPublicKey: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    counter: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().notNull(),\n    // Optional array of AuthenticatorTransport as JSON string\n    transports: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    // Authenticator Attestation GUID. We use this to identify the device/authenticator app that created the passkey\n    aaguid: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    // The user agent of the device that created the passkey\n    userAgent: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    // The IP address that created the passkey\n    ipAddress: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 100\n    })\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('user_id_idx').on(table.userId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credential_id_idx').on(table.credentialId)\n    ]);\n// Credit transaction types\nconst CREDIT_TRANSACTION_TYPE = {\n    PURCHASE: 'PURCHASE',\n    USAGE: 'USAGE',\n    MONTHLY_REFRESH: 'MONTHLY_REFRESH'\n};\nconst creditTransactionTypeTuple = Object.values(CREDIT_TRANSACTION_TYPE);\nconst creditTransactionTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"credit_transaction\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`ctxn_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    amount: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().notNull(),\n    // Track how many credits are still available from this transaction\n    remainingAmount: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).notNull(),\n    type: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        enum: creditTransactionTypeTuple\n    }).notNull(),\n    description: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    expirationDate: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    expirationDateProcessedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    paymentIntentId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    })\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_user_id_idx').on(table.userId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_type_idx').on(table.type),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_created_at_idx').on(table.createdAt),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_expiration_date_idx').on(table.expirationDate),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_payment_intent_id_idx').on(table.paymentIntentId)\n    ]);\n// Define item types that can be purchased\nconst PURCHASABLE_ITEM_TYPE = {\n    COMPONENT: 'COMPONENT'\n};\nconst purchasableItemTypeTuple = Object.values(PURCHASABLE_ITEM_TYPE);\nconst purchasedItemsTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"purchased_item\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`pitem_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    // The type of item (e.g., COMPONENT, TEMPLATE, etc.)\n    itemType: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        enum: purchasableItemTypeTuple\n    }).notNull(),\n    // The ID of the item within its type (e.g., componentId)\n    itemId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull(),\n    purchasedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).$defaultFn(()=>new Date()).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('purchased_item_user_id_idx').on(table.userId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('purchased_item_type_idx').on(table.itemType),\n        // Composite index for checking if a user owns a specific item of a specific type\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('purchased_item_user_item_idx').on(table.userId, table.itemType, table.itemId)\n    ]);\n// System-defined roles - these are always available\nconst SYSTEM_ROLES_ENUM = {\n    OWNER: 'owner',\n    ADMIN: 'admin',\n    MEMBER: 'member',\n    GUEST: 'guest'\n};\nconst systemRoleTuple = Object.values(SYSTEM_ROLES_ENUM);\n// Define available permissions\nconst TEAM_PERMISSIONS = {\n    // Resource access\n    ACCESS_DASHBOARD: 'access_dashboard',\n    ACCESS_BILLING: 'access_billing',\n    // User management\n    INVITE_MEMBERS: 'invite_members',\n    REMOVE_MEMBERS: 'remove_members',\n    CHANGE_MEMBER_ROLES: 'change_member_roles',\n    // Team management\n    EDIT_TEAM_SETTINGS: 'edit_team_settings',\n    DELETE_TEAM: 'delete_team',\n    // Role management\n    CREATE_ROLES: 'create_roles',\n    EDIT_ROLES: 'edit_roles',\n    DELETE_ROLES: 'delete_roles',\n    ASSIGN_ROLES: 'assign_roles',\n    // Content permissions\n    CREATE_COMPONENTS: 'create_components',\n    EDIT_COMPONENTS: 'edit_components',\n    DELETE_COMPONENTS: 'delete_components'\n};\n// Team table\nconst teamTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`team_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    name: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    slug: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull().unique(),\n    description: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 1000\n    }),\n    avatarUrl: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 600\n    }),\n    // Settings could be stored as JSON\n    settings: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 10000\n    }),\n    // Optional billing-related fields\n    billingEmail: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    planId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 100\n    }),\n    planExpiresAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    creditBalance: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_slug_idx').on(table.slug)\n    ]);\n// Team membership table\nconst teamMembershipTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team_membership\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`tmem_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    teamId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>teamTable.id),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    // This can be either a system role or a custom role ID\n    roleId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull(),\n    // Flag to indicate if this is a system role\n    isSystemRole: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull(),\n    invitedBy: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().references(()=>userTable.id),\n    invitedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    joinedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    expiresAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    isActive: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_membership_team_id_idx').on(table.teamId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_membership_user_id_idx').on(table.userId),\n        // Instead of unique() which causes linter errors, we'll create a unique constraint on columns\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_membership_unique_idx').on(table.teamId, table.userId)\n    ]);\n// Team role table\nconst teamRoleTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team_role\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`trole_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    teamId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>teamTable.id),\n    name: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    description: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 1000\n    }),\n    // Store permissions as a JSON array of permission keys\n    permissions: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        mode: 'json'\n    }).notNull().$type(),\n    // A JSON field for storing UI-specific settings like color, icon, etc.\n    metadata: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 5000\n    }),\n    // Optional flag to mark some roles as non-editable\n    isEditable: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_role_team_id_idx').on(table.teamId),\n        // Instead of unique() which causes linter errors, we'll create a unique constraint on columns\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_role_name_unique_idx').on(table.teamId, table.name)\n    ]);\n// Team invitation table\nconst teamInvitationTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team_invitation\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`tinv_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    teamId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>teamTable.id),\n    email: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    // This can be either a system role or a custom role ID\n    roleId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull(),\n    // Flag to indicate if this is a system role\n    isSystemRole: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull(),\n    token: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull().unique(),\n    invitedBy: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    expiresAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).notNull(),\n    acceptedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    acceptedBy: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().references(()=>userTable.id)\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_invitation_team_id_idx').on(table.teamId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_invitation_email_idx').on(table.email),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_invitation_token_idx').on(table.token)\n    ]);\nconst teamRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamTable, ({ many })=>({\n        memberships: many(teamMembershipTable),\n        invitations: many(teamInvitationTable),\n        roles: many(teamRoleTable)\n    }));\nconst teamRoleRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamRoleTable, ({ one })=>({\n        team: one(teamTable, {\n            fields: [\n                teamRoleTable.teamId\n            ],\n            references: [\n                teamTable.id\n            ]\n        })\n    }));\nconst teamMembershipRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamMembershipTable, ({ one })=>({\n        team: one(teamTable, {\n            fields: [\n                teamMembershipTable.teamId\n            ],\n            references: [\n                teamTable.id\n            ]\n        }),\n        user: one(userTable, {\n            fields: [\n                teamMembershipTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        }),\n        invitedByUser: one(userTable, {\n            fields: [\n                teamMembershipTable.invitedBy\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst teamInvitationRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamInvitationTable, ({ one })=>({\n        team: one(teamTable, {\n            fields: [\n                teamInvitationTable.teamId\n            ],\n            references: [\n                teamTable.id\n            ]\n        }),\n        invitedByUser: one(userTable, {\n            fields: [\n                teamInvitationTable.invitedBy\n            ],\n            references: [\n                userTable.id\n            ]\n        }),\n        acceptedByUser: one(userTable, {\n            fields: [\n                teamInvitationTable.acceptedBy\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst creditTransactionRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(creditTransactionTable, ({ one })=>({\n        user: one(userTable, {\n            fields: [\n                creditTransactionTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst purchasedItemsRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(purchasedItemsTable, ({ one })=>({\n        user: one(userTable, {\n            fields: [\n                purchasedItemsTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst userRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(userTable, ({ many })=>({\n        passkeys: many(passKeyCredentialTable),\n        creditTransactions: many(creditTransactionTable),\n        purchasedItems: many(purchasedItemsTable),\n        teamMemberships: many(teamMembershipTable)\n    }));\nconst passKeyCredentialRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(passKeyCredentialTable, ({ one })=>({\n        user: one(userTable, {\n            fields: [\n                passKeyCredentialTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDeEIsSUFBSTtBQUVHLE1BQU11Qyw2QkFBNkJ6SSxzREFBU0EsQ0FBQ3VDLHdCQUF3QixDQUFDLEVBQUVtRixHQUFHLEVBQUUsR0FBTTtRQUN4RkksTUFBTUosSUFBSXRHLFdBQVc7WUFDbkJ3RyxRQUFRO2dCQUFDckYsdUJBQXVCQyxNQUFNO2FBQUM7WUFDdkNDLFlBQVk7Z0JBQUNyQixVQUFVQyxFQUFFO2FBQUM7UUFDNUI7SUFDRixJQUFJIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFkbWluXFxEZXNrdG9wXFxGaW5hbFByb2plY3RcXHNyY1xcZGJcXHNjaGVtYS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcWxpdGVUYWJsZSwgaW50ZWdlciwgdGV4dCwgaW5kZXggfSBmcm9tIFwiZHJpenpsZS1vcm0vc3FsaXRlLWNvcmVcIjtcclxuaW1wb3J0IHsgcmVsYXRpb25zLCBzcWwgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcclxuaW1wb3J0IHsgdHlwZSBJbmZlclNlbGVjdE1vZGVsIH0gZnJvbSBcImRyaXp6bGUtb3JtXCI7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVJZCB9IGZyb20gJ0BwYXJhbGxlbGRyaXZlL2N1aWQyJ1xyXG5cclxuZXhwb3J0IGNvbnN0IFJPTEVTX0VOVU0gPSB7XHJcbiAgQURNSU46ICdhZG1pbicsXHJcbiAgVVNFUjogJ3VzZXInLFxyXG59IGFzIGNvbnN0O1xyXG5cclxuY29uc3Qgcm9sZVR1cGxlID0gT2JqZWN0LnZhbHVlcyhST0xFU19FTlVNKSBhcyBbc3RyaW5nLCAuLi5zdHJpbmdbXV07XHJcblxyXG5jb25zdCBjb21tb25Db2x1bW5zID0ge1xyXG4gIGNyZWF0ZWRBdDogaW50ZWdlcih7XHJcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxyXG4gIH0pLiRkZWZhdWx0Rm4oKCkgPT4gbmV3IERhdGUoKSkubm90TnVsbCgpLFxyXG4gIHVwZGF0ZWRBdDogaW50ZWdlcih7XHJcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxyXG4gIH0pLiRvblVwZGF0ZUZuKCgpID0+IG5ldyBEYXRlKCkpLm5vdE51bGwoKSxcclxuICB1cGRhdGVDb3VudGVyOiBpbnRlZ2VyKCkuZGVmYXVsdCgwKS4kb25VcGRhdGUoKCkgPT4gc3FsYHVwZGF0ZUNvdW50ZXIgKyAxYCksXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB1c2VyVGFibGUgPSBzcWxpdGVUYWJsZShcInVzZXJcIiwge1xyXG4gIC4uLmNvbW1vbkNvbHVtbnMsXHJcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgdXNyXyR7Y3JlYXRlSWQoKX1gKS5ub3ROdWxsKCksXHJcbiAgZmlyc3ROYW1lOiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMjU1LFxyXG4gIH0pLFxyXG4gIGxhc3ROYW1lOiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMjU1LFxyXG4gIH0pLFxyXG4gIGVtYWlsOiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMjU1LFxyXG4gIH0pLnVuaXF1ZSgpLFxyXG4gIHBhc3N3b3JkSGFzaDogdGV4dCgpLFxyXG4gIHJvbGU6IHRleHQoe1xyXG4gICAgZW51bTogcm9sZVR1cGxlLFxyXG4gIH0pLmRlZmF1bHQoUk9MRVNfRU5VTS5VU0VSKS5ub3ROdWxsKCksXHJcbiAgZW1haWxWZXJpZmllZDogaW50ZWdlcih7XHJcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxyXG4gIH0pLFxyXG4gIHNpZ25VcElwQWRkcmVzczogdGV4dCh7XHJcbiAgICBsZW5ndGg6IDEwMCxcclxuICB9KSxcclxuICBnb29nbGVBY2NvdW50SWQ6IHRleHQoe1xyXG4gICAgbGVuZ3RoOiAyNTUsXHJcbiAgfSksXHJcbiAgLyoqXHJcbiAgICogVGhpcyBjYW4gZWl0aGVyIGJlIGFuIGFic29sdXRlIG9yIHJlbGF0aXZlIHBhdGggdG8gYW4gaW1hZ2VcclxuICAgKi9cclxuICBhdmF0YXI6IHRleHQoe1xyXG4gICAgbGVuZ3RoOiA2MDAsXHJcbiAgfSksXHJcbiAgLy8gQ3JlZGl0IHN5c3RlbSBmaWVsZHNcclxuICBjdXJyZW50Q3JlZGl0czogaW50ZWdlcigpLmRlZmF1bHQoMCkubm90TnVsbCgpLFxyXG4gIGxhc3RDcmVkaXRSZWZyZXNoQXQ6IGludGVnZXIoe1xyXG4gICAgbW9kZTogXCJ0aW1lc3RhbXBcIixcclxuICB9KSxcclxufSwgKHRhYmxlKSA9PiAoW1xyXG4gIGluZGV4KCdlbWFpbF9pZHgnKS5vbih0YWJsZS5lbWFpbCksXHJcbiAgaW5kZXgoJ2dvb2dsZV9hY2NvdW50X2lkX2lkeCcpLm9uKHRhYmxlLmdvb2dsZUFjY291bnRJZCksXHJcbiAgaW5kZXgoJ3JvbGVfaWR4Jykub24odGFibGUucm9sZSksXHJcbl0pKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwYXNzS2V5Q3JlZGVudGlhbFRhYmxlID0gc3FsaXRlVGFibGUoXCJwYXNza2V5X2NyZWRlbnRpYWxcIiwge1xyXG4gIC4uLmNvbW1vbkNvbHVtbnMsXHJcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgcGtleV8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxyXG4gIHVzZXJJZDogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHVzZXJUYWJsZS5pZCksXHJcbiAgY3JlZGVudGlhbElkOiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMjU1LFxyXG4gIH0pLm5vdE51bGwoKS51bmlxdWUoKSxcclxuICBjcmVkZW50aWFsUHVibGljS2V5OiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMjU1LFxyXG4gIH0pLm5vdE51bGwoKSxcclxuICBjb3VudGVyOiBpbnRlZ2VyKCkubm90TnVsbCgpLFxyXG4gIC8vIE9wdGlvbmFsIGFycmF5IG9mIEF1dGhlbnRpY2F0b3JUcmFuc3BvcnQgYXMgSlNPTiBzdHJpbmdcclxuICB0cmFuc3BvcnRzOiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMjU1LFxyXG4gIH0pLFxyXG4gIC8vIEF1dGhlbnRpY2F0b3IgQXR0ZXN0YXRpb24gR1VJRC4gV2UgdXNlIHRoaXMgdG8gaWRlbnRpZnkgdGhlIGRldmljZS9hdXRoZW50aWNhdG9yIGFwcCB0aGF0IGNyZWF0ZWQgdGhlIHBhc3NrZXlcclxuICBhYWd1aWQ6IHRleHQoe1xyXG4gICAgbGVuZ3RoOiAyNTUsXHJcbiAgfSksXHJcbiAgLy8gVGhlIHVzZXIgYWdlbnQgb2YgdGhlIGRldmljZSB0aGF0IGNyZWF0ZWQgdGhlIHBhc3NrZXlcclxuICB1c2VyQWdlbnQ6IHRleHQoe1xyXG4gICAgbGVuZ3RoOiAyNTUsXHJcbiAgfSksXHJcbiAgLy8gVGhlIElQIGFkZHJlc3MgdGhhdCBjcmVhdGVkIHRoZSBwYXNza2V5XHJcbiAgaXBBZGRyZXNzOiB0ZXh0KHtcclxuICAgIGxlbmd0aDogMTAwLFxyXG4gIH0pLFxyXG59LCAodGFibGUpID0+IChbXHJcbiAgaW5kZXgoJ3VzZXJfaWRfaWR4Jykub24odGFibGUudXNlcklkKSxcclxuICBpbmRleCgnY3JlZGVudGlhbF9pZF9pZHgnKS5vbih0YWJsZS5jcmVkZW50aWFsSWQpLFxyXG5dKSk7XHJcblxyXG4vLyBDcmVkaXQgdHJhbnNhY3Rpb24gdHlwZXNcclxuZXhwb3J0IGNvbnN0IENSRURJVF9UUkFOU0FDVElPTl9UWVBFID0ge1xyXG4gIFBVUkNIQVNFOiAnUFVSQ0hBU0UnLFxyXG4gIFVTQUdFOiAnVVNBR0UnLFxyXG4gIE1PTlRITFlfUkVGUkVTSDogJ01PTlRITFlfUkVGUkVTSCcsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlZGl0VHJhbnNhY3Rpb25UeXBlVHVwbGUgPSBPYmplY3QudmFsdWVzKENSRURJVF9UUkFOU0FDVElPTl9UWVBFKSBhcyBbc3RyaW5nLCAuLi5zdHJpbmdbXV07XHJcblxyXG5leHBvcnQgY29uc3QgY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSA9IHNxbGl0ZVRhYmxlKFwiY3JlZGl0X3RyYW5zYWN0aW9uXCIsIHtcclxuICAuLi5jb21tb25Db2x1bW5zLFxyXG4gIGlkOiB0ZXh0KCkucHJpbWFyeUtleSgpLiRkZWZhdWx0Rm4oKCkgPT4gYGN0eG5fJHtjcmVhdGVJZCgpfWApLm5vdE51bGwoKSxcclxuICB1c2VySWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB1c2VyVGFibGUuaWQpLFxyXG4gIGFtb3VudDogaW50ZWdlcigpLm5vdE51bGwoKSxcclxuICAvLyBUcmFjayBob3cgbWFueSBjcmVkaXRzIGFyZSBzdGlsbCBhdmFpbGFibGUgZnJvbSB0aGlzIHRyYW5zYWN0aW9uXHJcbiAgcmVtYWluaW5nQW1vdW50OiBpbnRlZ2VyKCkuZGVmYXVsdCgwKS5ub3ROdWxsKCksXHJcbiAgdHlwZTogdGV4dCh7XHJcbiAgICBlbnVtOiBjcmVkaXRUcmFuc2FjdGlvblR5cGVUdXBsZSxcclxuICB9KS5ub3ROdWxsKCksXHJcbiAgZGVzY3JpcHRpb246IHRleHQoe1xyXG4gICAgbGVuZ3RoOiAyNTUsXHJcbiAgfSkubm90TnVsbCgpLFxyXG4gIGV4cGlyYXRpb25EYXRlOiBpbnRlZ2VyKHtcclxuICAgIG1vZGU6IFwidGltZXN0YW1wXCIsXHJcbiAgfSksXHJcbiAgZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdDogaW50ZWdlcih7XHJcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxyXG4gIH0pLFxyXG4gIHBheW1lbnRJbnRlbnRJZDogdGV4dCh7XHJcbiAgICBsZW5ndGg6IDI1NSxcclxuICB9KSxcclxufSwgKHRhYmxlKSA9PiAoW1xyXG4gIGluZGV4KCdjcmVkaXRfdHJhbnNhY3Rpb25fdXNlcl9pZF9pZHgnKS5vbih0YWJsZS51c2VySWQpLFxyXG4gIGluZGV4KCdjcmVkaXRfdHJhbnNhY3Rpb25fdHlwZV9pZHgnKS5vbih0YWJsZS50eXBlKSxcclxuICBpbmRleCgnY3JlZGl0X3RyYW5zYWN0aW9uX2NyZWF0ZWRfYXRfaWR4Jykub24odGFibGUuY3JlYXRlZEF0KSxcclxuICBpbmRleCgnY3JlZGl0X3RyYW5zYWN0aW9uX2V4cGlyYXRpb25fZGF0ZV9pZHgnKS5vbih0YWJsZS5leHBpcmF0aW9uRGF0ZSksXHJcbiAgaW5kZXgoJ2NyZWRpdF90cmFuc2FjdGlvbl9wYXltZW50X2ludGVudF9pZF9pZHgnKS5vbih0YWJsZS5wYXltZW50SW50ZW50SWQpLFxyXG5dKSk7XHJcblxyXG4vLyBEZWZpbmUgaXRlbSB0eXBlcyB0aGF0IGNhbiBiZSBwdXJjaGFzZWRcclxuZXhwb3J0IGNvbnN0IFBVUkNIQVNBQkxFX0lURU1fVFlQRSA9IHtcclxuICBDT01QT05FTlQ6ICdDT01QT05FTlQnLFxyXG4gIC8vIEFkZCBtb3JlIHR5cGVzIGluIHRoZSBmdXR1cmUgKGUuZy4sIFRFTVBMQVRFLCBQTFVHSU4sIGV0Yy4pXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgcHVyY2hhc2FibGVJdGVtVHlwZVR1cGxlID0gT2JqZWN0LnZhbHVlcyhQVVJDSEFTQUJMRV9JVEVNX1RZUEUpIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXTtcclxuXHJcbmV4cG9ydCBjb25zdCBwdXJjaGFzZWRJdGVtc1RhYmxlID0gc3FsaXRlVGFibGUoXCJwdXJjaGFzZWRfaXRlbVwiLCB7XHJcbiAgLi4uY29tbW9uQ29sdW1ucyxcclxuICBpZDogdGV4dCgpLnByaW1hcnlLZXkoKS4kZGVmYXVsdEZuKCgpID0+IGBwaXRlbV8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxyXG4gIHVzZXJJZDogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHVzZXJUYWJsZS5pZCksXHJcbiAgLy8gVGhlIHR5cGUgb2YgaXRlbSAoZS5nLiwgQ09NUE9ORU5ULCBURU1QTEFURSwgZXRjLilcclxuICBpdGVtVHlwZTogdGV4dCh7XHJcbiAgICBlbnVtOiBwdXJjaGFzYWJsZUl0ZW1UeXBlVHVwbGUsXHJcbiAgfSkubm90TnVsbCgpLFxyXG4gIC8vIFRoZSBJRCBvZiB0aGUgaXRlbSB3aXRoaW4gaXRzIHR5cGUgKGUuZy4sIGNvbXBvbmVudElkKVxyXG4gIGl0ZW1JZDogdGV4dCgpLm5vdE51bGwoKSxcclxuICBwdXJjaGFzZWRBdDogaW50ZWdlcih7XHJcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxyXG4gIH0pLiRkZWZhdWx0Rm4oKCkgPT4gbmV3IERhdGUoKSkubm90TnVsbCgpLFxyXG59LCAodGFibGUpID0+IChbXHJcbiAgaW5kZXgoJ3B1cmNoYXNlZF9pdGVtX3VzZXJfaWRfaWR4Jykub24odGFibGUudXNlcklkKSxcclxuICBpbmRleCgncHVyY2hhc2VkX2l0ZW1fdHlwZV9pZHgnKS5vbih0YWJsZS5pdGVtVHlwZSksXHJcbiAgLy8gQ29tcG9zaXRlIGluZGV4IGZvciBjaGVja2luZyBpZiBhIHVzZXIgb3ducyBhIHNwZWNpZmljIGl0ZW0gb2YgYSBzcGVjaWZpYyB0eXBlXHJcbiAgaW5kZXgoJ3B1cmNoYXNlZF9pdGVtX3VzZXJfaXRlbV9pZHgnKS5vbih0YWJsZS51c2VySWQsIHRhYmxlLml0ZW1UeXBlLCB0YWJsZS5pdGVtSWQpLFxyXG5dKSk7XHJcblxyXG4vLyBTeXN0ZW0tZGVmaW5lZCByb2xlcyAtIHRoZXNlIGFyZSBhbHdheXMgYXZhaWxhYmxlXHJcbmV4cG9ydCBjb25zdCBTWVNURU1fUk9MRVNfRU5VTSA9IHtcclxuICBPV05FUjogJ293bmVyJyxcclxuICBBRE1JTjogJ2FkbWluJyxcclxuICBNRU1CRVI6ICdtZW1iZXInLFxyXG4gIEdVRVNUOiAnZ3Vlc3QnLFxyXG59IGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IGNvbnN0IHN5c3RlbVJvbGVUdXBsZSA9IE9iamVjdC52YWx1ZXMoU1lTVEVNX1JPTEVTX0VOVU0pIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXTtcclxuXHJcbi8vIERlZmluZSBhdmFpbGFibGUgcGVybWlzc2lvbnNcclxuZXhwb3J0IGNvbnN0IFRFQU1fUEVSTUlTU0lPTlMgPSB7XHJcbiAgLy8gUmVzb3VyY2UgYWNjZXNzXHJcbiAgQUNDRVNTX0RBU0hCT0FSRDogJ2FjY2Vzc19kYXNoYm9hcmQnLFxyXG4gIEFDQ0VTU19CSUxMSU5HOiAnYWNjZXNzX2JpbGxpbmcnLFxyXG5cclxuICAvLyBVc2VyIG1hbmFnZW1lbnRcclxuICBJTlZJVEVfTUVNQkVSUzogJ2ludml0ZV9tZW1iZXJzJyxcclxuICBSRU1PVkVfTUVNQkVSUzogJ3JlbW92ZV9tZW1iZXJzJyxcclxuICBDSEFOR0VfTUVNQkVSX1JPTEVTOiAnY2hhbmdlX21lbWJlcl9yb2xlcycsXHJcblxyXG4gIC8vIFRlYW0gbWFuYWdlbWVudFxyXG4gIEVESVRfVEVBTV9TRVRUSU5HUzogJ2VkaXRfdGVhbV9zZXR0aW5ncycsXHJcbiAgREVMRVRFX1RFQU06ICdkZWxldGVfdGVhbScsXHJcblxyXG4gIC8vIFJvbGUgbWFuYWdlbWVudFxyXG4gIENSRUFURV9ST0xFUzogJ2NyZWF0ZV9yb2xlcycsXHJcbiAgRURJVF9ST0xFUzogJ2VkaXRfcm9sZXMnLFxyXG4gIERFTEVURV9ST0xFUzogJ2RlbGV0ZV9yb2xlcycsXHJcbiAgQVNTSUdOX1JPTEVTOiAnYXNzaWduX3JvbGVzJyxcclxuXHJcbiAgLy8gQ29udGVudCBwZXJtaXNzaW9uc1xyXG4gIENSRUFURV9DT01QT05FTlRTOiAnY3JlYXRlX2NvbXBvbmVudHMnLFxyXG4gIEVESVRfQ09NUE9ORU5UUzogJ2VkaXRfY29tcG9uZW50cycsXHJcbiAgREVMRVRFX0NPTVBPTkVOVFM6ICdkZWxldGVfY29tcG9uZW50cycsXHJcblxyXG4gIC8vIEFkZCBtb3JlIGFzIG5lZWRlZFxyXG59IGFzIGNvbnN0O1xyXG5cclxuLy8gVGVhbSB0YWJsZVxyXG5leHBvcnQgY29uc3QgdGVhbVRhYmxlID0gc3FsaXRlVGFibGUoXCJ0ZWFtXCIsIHtcclxuICAuLi5jb21tb25Db2x1bW5zLFxyXG4gIGlkOiB0ZXh0KCkucHJpbWFyeUtleSgpLiRkZWZhdWx0Rm4oKCkgPT4gYHRlYW1fJHtjcmVhdGVJZCgpfWApLm5vdE51bGwoKSxcclxuICBuYW1lOiB0ZXh0KHsgbGVuZ3RoOiAyNTUgfSkubm90TnVsbCgpLFxyXG4gIHNsdWc6IHRleHQoeyBsZW5ndGg6IDI1NSB9KS5ub3ROdWxsKCkudW5pcXVlKCksXHJcbiAgZGVzY3JpcHRpb246IHRleHQoeyBsZW5ndGg6IDEwMDAgfSksXHJcbiAgYXZhdGFyVXJsOiB0ZXh0KHsgbGVuZ3RoOiA2MDAgfSksXHJcbiAgLy8gU2V0dGluZ3MgY291bGQgYmUgc3RvcmVkIGFzIEpTT05cclxuICBzZXR0aW5nczogdGV4dCh7IGxlbmd0aDogMTAwMDAgfSksXHJcbiAgLy8gT3B0aW9uYWwgYmlsbGluZy1yZWxhdGVkIGZpZWxkc1xyXG4gIGJpbGxpbmdFbWFpbDogdGV4dCh7IGxlbmd0aDogMjU1IH0pLFxyXG4gIHBsYW5JZDogdGV4dCh7IGxlbmd0aDogMTAwIH0pLFxyXG4gIHBsYW5FeHBpcmVzQXQ6IGludGVnZXIoeyBtb2RlOiBcInRpbWVzdGFtcFwiIH0pLFxyXG4gIGNyZWRpdEJhbGFuY2U6IGludGVnZXIoKS5kZWZhdWx0KDApLm5vdE51bGwoKSxcclxufSwgKHRhYmxlKSA9PiAoW1xyXG4gIGluZGV4KCd0ZWFtX3NsdWdfaWR4Jykub24odGFibGUuc2x1ZyksXHJcbl0pKTtcclxuXHJcbi8vIFRlYW0gbWVtYmVyc2hpcCB0YWJsZVxyXG5leHBvcnQgY29uc3QgdGVhbU1lbWJlcnNoaXBUYWJsZSA9IHNxbGl0ZVRhYmxlKFwidGVhbV9tZW1iZXJzaGlwXCIsIHtcclxuICAuLi5jb21tb25Db2x1bW5zLFxyXG4gIGlkOiB0ZXh0KCkucHJpbWFyeUtleSgpLiRkZWZhdWx0Rm4oKCkgPT4gYHRtZW1fJHtjcmVhdGVJZCgpfWApLm5vdE51bGwoKSxcclxuICB0ZWFtSWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB0ZWFtVGFibGUuaWQpLFxyXG4gIHVzZXJJZDogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHVzZXJUYWJsZS5pZCksXHJcbiAgLy8gVGhpcyBjYW4gYmUgZWl0aGVyIGEgc3lzdGVtIHJvbGUgb3IgYSBjdXN0b20gcm9sZSBJRFxyXG4gIHJvbGVJZDogdGV4dCgpLm5vdE51bGwoKSxcclxuICAvLyBGbGFnIHRvIGluZGljYXRlIGlmIHRoaXMgaXMgYSBzeXN0ZW0gcm9sZVxyXG4gIGlzU3lzdGVtUm9sZTogaW50ZWdlcigpLmRlZmF1bHQoMSkubm90TnVsbCgpLFxyXG4gIGludml0ZWRCeTogdGV4dCgpLnJlZmVyZW5jZXMoKCkgPT4gdXNlclRhYmxlLmlkKSxcclxuICBpbnZpdGVkQXQ6IGludGVnZXIoeyBtb2RlOiBcInRpbWVzdGFtcFwiIH0pLFxyXG4gIGpvaW5lZEF0OiBpbnRlZ2VyKHsgbW9kZTogXCJ0aW1lc3RhbXBcIiB9KSxcclxuICBleHBpcmVzQXQ6IGludGVnZXIoeyBtb2RlOiBcInRpbWVzdGFtcFwiIH0pLFxyXG4gIGlzQWN0aXZlOiBpbnRlZ2VyKCkuZGVmYXVsdCgxKS5ub3ROdWxsKCksXHJcbn0sICh0YWJsZSkgPT4gKFtcclxuICBpbmRleCgndGVhbV9tZW1iZXJzaGlwX3RlYW1faWRfaWR4Jykub24odGFibGUudGVhbUlkKSxcclxuICBpbmRleCgndGVhbV9tZW1iZXJzaGlwX3VzZXJfaWRfaWR4Jykub24odGFibGUudXNlcklkKSxcclxuICAvLyBJbnN0ZWFkIG9mIHVuaXF1ZSgpIHdoaWNoIGNhdXNlcyBsaW50ZXIgZXJyb3JzLCB3ZSdsbCBjcmVhdGUgYSB1bmlxdWUgY29uc3RyYWludCBvbiBjb2x1bW5zXHJcbiAgaW5kZXgoJ3RlYW1fbWVtYmVyc2hpcF91bmlxdWVfaWR4Jykub24odGFibGUudGVhbUlkLCB0YWJsZS51c2VySWQpLFxyXG5dKSk7XHJcblxyXG4vLyBUZWFtIHJvbGUgdGFibGVcclxuZXhwb3J0IGNvbnN0IHRlYW1Sb2xlVGFibGUgPSBzcWxpdGVUYWJsZShcInRlYW1fcm9sZVwiLCB7XHJcbiAgLi4uY29tbW9uQ29sdW1ucyxcclxuICBpZDogdGV4dCgpLnByaW1hcnlLZXkoKS4kZGVmYXVsdEZuKCgpID0+IGB0cm9sZV8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxyXG4gIHRlYW1JZDogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHRlYW1UYWJsZS5pZCksXHJcbiAgbmFtZTogdGV4dCh7IGxlbmd0aDogMjU1IH0pLm5vdE51bGwoKSxcclxuICBkZXNjcmlwdGlvbjogdGV4dCh7IGxlbmd0aDogMTAwMCB9KSxcclxuICAvLyBTdG9yZSBwZXJtaXNzaW9ucyBhcyBhIEpTT04gYXJyYXkgb2YgcGVybWlzc2lvbiBrZXlzXHJcbiAgcGVybWlzc2lvbnM6IHRleHQoeyBtb2RlOiAnanNvbicgfSkubm90TnVsbCgpLiR0eXBlPHN0cmluZ1tdPigpLFxyXG4gIC8vIEEgSlNPTiBmaWVsZCBmb3Igc3RvcmluZyBVSS1zcGVjaWZpYyBzZXR0aW5ncyBsaWtlIGNvbG9yLCBpY29uLCBldGMuXHJcbiAgbWV0YWRhdGE6IHRleHQoeyBsZW5ndGg6IDUwMDAgfSksXHJcbiAgLy8gT3B0aW9uYWwgZmxhZyB0byBtYXJrIHNvbWUgcm9sZXMgYXMgbm9uLWVkaXRhYmxlXHJcbiAgaXNFZGl0YWJsZTogaW50ZWdlcigpLmRlZmF1bHQoMSkubm90TnVsbCgpLFxyXG59LCAodGFibGUpID0+IChbXHJcbiAgaW5kZXgoJ3RlYW1fcm9sZV90ZWFtX2lkX2lkeCcpLm9uKHRhYmxlLnRlYW1JZCksXHJcbiAgLy8gSW5zdGVhZCBvZiB1bmlxdWUoKSB3aGljaCBjYXVzZXMgbGludGVyIGVycm9ycywgd2UnbGwgY3JlYXRlIGEgdW5pcXVlIGNvbnN0cmFpbnQgb24gY29sdW1uc1xyXG4gIGluZGV4KCd0ZWFtX3JvbGVfbmFtZV91bmlxdWVfaWR4Jykub24odGFibGUudGVhbUlkLCB0YWJsZS5uYW1lKSxcclxuXSkpO1xyXG5cclxuLy8gVGVhbSBpbnZpdGF0aW9uIHRhYmxlXHJcbmV4cG9ydCBjb25zdCB0ZWFtSW52aXRhdGlvblRhYmxlID0gc3FsaXRlVGFibGUoXCJ0ZWFtX2ludml0YXRpb25cIiwge1xyXG4gIC4uLmNvbW1vbkNvbHVtbnMsXHJcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgdGludl8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxyXG4gIHRlYW1JZDogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHRlYW1UYWJsZS5pZCksXHJcbiAgZW1haWw6IHRleHQoeyBsZW5ndGg6IDI1NSB9KS5ub3ROdWxsKCksXHJcbiAgLy8gVGhpcyBjYW4gYmUgZWl0aGVyIGEgc3lzdGVtIHJvbGUgb3IgYSBjdXN0b20gcm9sZSBJRFxyXG4gIHJvbGVJZDogdGV4dCgpLm5vdE51bGwoKSxcclxuICAvLyBGbGFnIHRvIGluZGljYXRlIGlmIHRoaXMgaXMgYSBzeXN0ZW0gcm9sZVxyXG4gIGlzU3lzdGVtUm9sZTogaW50ZWdlcigpLmRlZmF1bHQoMSkubm90TnVsbCgpLFxyXG4gIHRva2VuOiB0ZXh0KHsgbGVuZ3RoOiAyNTUgfSkubm90TnVsbCgpLnVuaXF1ZSgpLFxyXG4gIGludml0ZWRCeTogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHVzZXJUYWJsZS5pZCksXHJcbiAgZXhwaXJlc0F0OiBpbnRlZ2VyKHsgbW9kZTogXCJ0aW1lc3RhbXBcIiB9KS5ub3ROdWxsKCksXHJcbiAgYWNjZXB0ZWRBdDogaW50ZWdlcih7IG1vZGU6IFwidGltZXN0YW1wXCIgfSksXHJcbiAgYWNjZXB0ZWRCeTogdGV4dCgpLnJlZmVyZW5jZXMoKCkgPT4gdXNlclRhYmxlLmlkKSxcclxufSwgKHRhYmxlKSA9PiAoW1xyXG4gIGluZGV4KCd0ZWFtX2ludml0YXRpb25fdGVhbV9pZF9pZHgnKS5vbih0YWJsZS50ZWFtSWQpLFxyXG4gIGluZGV4KCd0ZWFtX2ludml0YXRpb25fZW1haWxfaWR4Jykub24odGFibGUuZW1haWwpLFxyXG4gIGluZGV4KCd0ZWFtX2ludml0YXRpb25fdG9rZW5faWR4Jykub24odGFibGUudG9rZW4pLFxyXG5dKSk7XHJcblxyXG5leHBvcnQgY29uc3QgdGVhbVJlbGF0aW9ucyA9IHJlbGF0aW9ucyh0ZWFtVGFibGUsICh7IG1hbnkgfSkgPT4gKHtcclxuICBtZW1iZXJzaGlwczogbWFueSh0ZWFtTWVtYmVyc2hpcFRhYmxlKSxcclxuICBpbnZpdGF0aW9uczogbWFueSh0ZWFtSW52aXRhdGlvblRhYmxlKSxcclxuICByb2xlczogbWFueSh0ZWFtUm9sZVRhYmxlKSxcclxufSkpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHRlYW1Sb2xlUmVsYXRpb25zID0gcmVsYXRpb25zKHRlYW1Sb2xlVGFibGUsICh7IG9uZSB9KSA9PiAoe1xyXG4gIHRlYW06IG9uZSh0ZWFtVGFibGUsIHtcclxuICAgIGZpZWxkczogW3RlYW1Sb2xlVGFibGUudGVhbUlkXSxcclxuICAgIHJlZmVyZW5jZXM6IFt0ZWFtVGFibGUuaWRdLFxyXG4gIH0pLFxyXG59KSk7XHJcblxyXG5leHBvcnQgY29uc3QgdGVhbU1lbWJlcnNoaXBSZWxhdGlvbnMgPSByZWxhdGlvbnModGVhbU1lbWJlcnNoaXBUYWJsZSwgKHsgb25lIH0pID0+ICh7XHJcbiAgdGVhbTogb25lKHRlYW1UYWJsZSwge1xyXG4gICAgZmllbGRzOiBbdGVhbU1lbWJlcnNoaXBUYWJsZS50ZWFtSWRdLFxyXG4gICAgcmVmZXJlbmNlczogW3RlYW1UYWJsZS5pZF0sXHJcbiAgfSksXHJcbiAgdXNlcjogb25lKHVzZXJUYWJsZSwge1xyXG4gICAgZmllbGRzOiBbdGVhbU1lbWJlcnNoaXBUYWJsZS51c2VySWRdLFxyXG4gICAgcmVmZXJlbmNlczogW3VzZXJUYWJsZS5pZF0sXHJcbiAgfSksXHJcbiAgaW52aXRlZEJ5VXNlcjogb25lKHVzZXJUYWJsZSwge1xyXG4gICAgZmllbGRzOiBbdGVhbU1lbWJlcnNoaXBUYWJsZS5pbnZpdGVkQnldLFxyXG4gICAgcmVmZXJlbmNlczogW3VzZXJUYWJsZS5pZF0sXHJcbiAgfSksXHJcbn0pKTtcclxuXHJcbmV4cG9ydCBjb25zdCB0ZWFtSW52aXRhdGlvblJlbGF0aW9ucyA9IHJlbGF0aW9ucyh0ZWFtSW52aXRhdGlvblRhYmxlLCAoeyBvbmUgfSkgPT4gKHtcclxuICB0ZWFtOiBvbmUodGVhbVRhYmxlLCB7XHJcbiAgICBmaWVsZHM6IFt0ZWFtSW52aXRhdGlvblRhYmxlLnRlYW1JZF0sXHJcbiAgICByZWZlcmVuY2VzOiBbdGVhbVRhYmxlLmlkXSxcclxuICB9KSxcclxuICBpbnZpdGVkQnlVc2VyOiBvbmUodXNlclRhYmxlLCB7XHJcbiAgICBmaWVsZHM6IFt0ZWFtSW52aXRhdGlvblRhYmxlLmludml0ZWRCeV0sXHJcbiAgICByZWZlcmVuY2VzOiBbdXNlclRhYmxlLmlkXSxcclxuICB9KSxcclxuICBhY2NlcHRlZEJ5VXNlcjogb25lKHVzZXJUYWJsZSwge1xyXG4gICAgZmllbGRzOiBbdGVhbUludml0YXRpb25UYWJsZS5hY2NlcHRlZEJ5XSxcclxuICAgIHJlZmVyZW5jZXM6IFt1c2VyVGFibGUuaWRdLFxyXG4gIH0pLFxyXG59KSk7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlZGl0VHJhbnNhY3Rpb25SZWxhdGlvbnMgPSByZWxhdGlvbnMoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSwgKHsgb25lIH0pID0+ICh7XHJcbiAgdXNlcjogb25lKHVzZXJUYWJsZSwge1xyXG4gICAgZmllbGRzOiBbY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS51c2VySWRdLFxyXG4gICAgcmVmZXJlbmNlczogW3VzZXJUYWJsZS5pZF0sXHJcbiAgfSksXHJcbn0pKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwdXJjaGFzZWRJdGVtc1JlbGF0aW9ucyA9IHJlbGF0aW9ucyhwdXJjaGFzZWRJdGVtc1RhYmxlLCAoeyBvbmUgfSkgPT4gKHtcclxuICB1c2VyOiBvbmUodXNlclRhYmxlLCB7XHJcbiAgICBmaWVsZHM6IFtwdXJjaGFzZWRJdGVtc1RhYmxlLnVzZXJJZF0sXHJcbiAgICByZWZlcmVuY2VzOiBbdXNlclRhYmxlLmlkXSxcclxuICB9KSxcclxufSkpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHVzZXJSZWxhdGlvbnMgPSByZWxhdGlvbnModXNlclRhYmxlLCAoeyBtYW55IH0pID0+ICh7XHJcbiAgcGFzc2tleXM6IG1hbnkocGFzc0tleUNyZWRlbnRpYWxUYWJsZSksXHJcbiAgY3JlZGl0VHJhbnNhY3Rpb25zOiBtYW55KGNyZWRpdFRyYW5zYWN0aW9uVGFibGUpLFxyXG4gIHB1cmNoYXNlZEl0ZW1zOiBtYW55KHB1cmNoYXNlZEl0ZW1zVGFibGUpLFxyXG4gIHRlYW1NZW1iZXJzaGlwczogbWFueSh0ZWFtTWVtYmVyc2hpcFRhYmxlKSxcclxufSkpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHBhc3NLZXlDcmVkZW50aWFsUmVsYXRpb25zID0gcmVsYXRpb25zKHBhc3NLZXlDcmVkZW50aWFsVGFibGUsICh7IG9uZSB9KSA9PiAoe1xyXG4gIHVzZXI6IG9uZSh1c2VyVGFibGUsIHtcclxuICAgIGZpZWxkczogW3Bhc3NLZXlDcmVkZW50aWFsVGFibGUudXNlcklkXSxcclxuICAgIHJlZmVyZW5jZXM6IFt1c2VyVGFibGUuaWRdLFxyXG4gIH0pLFxyXG59KSk7XHJcblxyXG5leHBvcnQgdHlwZSBVc2VyID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgdXNlclRhYmxlPjtcclxuZXhwb3J0IHR5cGUgUGFzc0tleUNyZWRlbnRpYWwgPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiBwYXNzS2V5Q3JlZGVudGlhbFRhYmxlPjtcclxuZXhwb3J0IHR5cGUgQ3JlZGl0VHJhbnNhY3Rpb24gPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiBjcmVkaXRUcmFuc2FjdGlvblRhYmxlPjtcclxuZXhwb3J0IHR5cGUgUHVyY2hhc2VkSXRlbSA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIHB1cmNoYXNlZEl0ZW1zVGFibGU+O1xyXG5leHBvcnQgdHlwZSBUZWFtID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgdGVhbVRhYmxlPjtcclxuZXhwb3J0IHR5cGUgVGVhbU1lbWJlcnNoaXAgPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiB0ZWFtTWVtYmVyc2hpcFRhYmxlPjtcclxuZXhwb3J0IHR5cGUgVGVhbVJvbGUgPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiB0ZWFtUm9sZVRhYmxlPjtcclxuZXhwb3J0IHR5cGUgVGVhbUludml0YXRpb24gPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiB0ZWFtSW52aXRhdGlvblRhYmxlPjtcclxuIl0sIm5hbWVzIjpbInNxbGl0ZVRhYmxlIiwiaW50ZWdlciIsInRleHQiLCJpbmRleCIsInJlbGF0aW9ucyIsInNxbCIsImNyZWF0ZUlkIiwiUk9MRVNfRU5VTSIsIkFETUlOIiwiVVNFUiIsInJvbGVUdXBsZSIsIk9iamVjdCIsInZhbHVlcyIsImNvbW1vbkNvbHVtbnMiLCJjcmVhdGVkQXQiLCJtb2RlIiwiJGRlZmF1bHRGbiIsIkRhdGUiLCJub3ROdWxsIiwidXBkYXRlZEF0IiwiJG9uVXBkYXRlRm4iLCJ1cGRhdGVDb3VudGVyIiwiZGVmYXVsdCIsIiRvblVwZGF0ZSIsInVzZXJUYWJsZSIsImlkIiwicHJpbWFyeUtleSIsImZpcnN0TmFtZSIsImxlbmd0aCIsImxhc3ROYW1lIiwiZW1haWwiLCJ1bmlxdWUiLCJwYXNzd29yZEhhc2giLCJyb2xlIiwiZW51bSIsImVtYWlsVmVyaWZpZWQiLCJzaWduVXBJcEFkZHJlc3MiLCJnb29nbGVBY2NvdW50SWQiLCJhdmF0YXIiLCJjdXJyZW50Q3JlZGl0cyIsImxhc3RDcmVkaXRSZWZyZXNoQXQiLCJ0YWJsZSIsIm9uIiwicGFzc0tleUNyZWRlbnRpYWxUYWJsZSIsInVzZXJJZCIsInJlZmVyZW5jZXMiLCJjcmVkZW50aWFsSWQiLCJjcmVkZW50aWFsUHVibGljS2V5IiwiY291bnRlciIsInRyYW5zcG9ydHMiLCJhYWd1aWQiLCJ1c2VyQWdlbnQiLCJpcEFkZHJlc3MiLCJDUkVESVRfVFJBTlNBQ1RJT05fVFlQRSIsIlBVUkNIQVNFIiwiVVNBR0UiLCJNT05USExZX1JFRlJFU0giLCJjcmVkaXRUcmFuc2FjdGlvblR5cGVUdXBsZSIsImNyZWRpdFRyYW5zYWN0aW9uVGFibGUiLCJhbW91bnQiLCJyZW1haW5pbmdBbW91bnQiLCJ0eXBlIiwiZGVzY3JpcHRpb24iLCJleHBpcmF0aW9uRGF0ZSIsImV4cGlyYXRpb25EYXRlUHJvY2Vzc2VkQXQiLCJwYXltZW50SW50ZW50SWQiLCJQVVJDSEFTQUJMRV9JVEVNX1RZUEUiLCJDT01QT05FTlQiLCJwdXJjaGFzYWJsZUl0ZW1UeXBlVHVwbGUiLCJwdXJjaGFzZWRJdGVtc1RhYmxlIiwiaXRlbVR5cGUiLCJpdGVtSWQiLCJwdXJjaGFzZWRBdCIsIlNZU1RFTV9ST0xFU19FTlVNIiwiT1dORVIiLCJNRU1CRVIiLCJHVUVTVCIsInN5c3RlbVJvbGVUdXBsZSIsIlRFQU1fUEVSTUlTU0lPTlMiLCJBQ0NFU1NfREFTSEJPQVJEIiwiQUNDRVNTX0JJTExJTkciLCJJTlZJVEVfTUVNQkVSUyIsIlJFTU9WRV9NRU1CRVJTIiwiQ0hBTkdFX01FTUJFUl9ST0xFUyIsIkVESVRfVEVBTV9TRVRUSU5HUyIsIkRFTEVURV9URUFNIiwiQ1JFQVRFX1JPTEVTIiwiRURJVF9ST0xFUyIsIkRFTEVURV9ST0xFUyIsIkFTU0lHTl9ST0xFUyIsIkNSRUFURV9DT01QT05FTlRTIiwiRURJVF9DT01QT05FTlRTIiwiREVMRVRFX0NPTVBPTkVOVFMiLCJ0ZWFtVGFibGUiLCJuYW1lIiwic2x1ZyIsImF2YXRhclVybCIsInNldHRpbmdzIiwiYmlsbGluZ0VtYWlsIiwicGxhbklkIiwicGxhbkV4cGlyZXNBdCIsImNyZWRpdEJhbGFuY2UiLCJ0ZWFtTWVtYmVyc2hpcFRhYmxlIiwidGVhbUlkIiwicm9sZUlkIiwiaXNTeXN0ZW1Sb2xlIiwiaW52aXRlZEJ5IiwiaW52aXRlZEF0Iiwiam9pbmVkQXQiLCJleHBpcmVzQXQiLCJpc0FjdGl2ZSIsInRlYW1Sb2xlVGFibGUiLCJwZXJtaXNzaW9ucyIsIiR0eXBlIiwibWV0YWRhdGEiLCJpc0VkaXRhYmxlIiwidGVhbUludml0YXRpb25UYWJsZSIsInRva2VuIiwiYWNjZXB0ZWRBdCIsImFjY2VwdGVkQnkiLCJ0ZWFtUmVsYXRpb25zIiwibWFueSIsIm1lbWJlcnNoaXBzIiwiaW52aXRhdGlvbnMiLCJyb2xlcyIsInRlYW1Sb2xlUmVsYXRpb25zIiwib25lIiwidGVhbSIsImZpZWxkcyIsInRlYW1NZW1iZXJzaGlwUmVsYXRpb25zIiwidXNlciIsImludml0ZWRCeVVzZXIiLCJ0ZWFtSW52aXRhdGlvblJlbGF0aW9ucyIsImFjY2VwdGVkQnlVc2VyIiwiY3JlZGl0VHJhbnNhY3Rpb25SZWxhdGlvbnMiLCJwdXJjaGFzZWRJdGVtc1JlbGF0aW9ucyIsInVzZXJSZWxhdGlvbnMiLCJwYXNza2V5cyIsImNyZWRpdFRyYW5zYWN0aW9ucyIsInB1cmNoYXNlZEl0ZW1zIiwidGVhbU1lbWJlcnNoaXBzIiwicGFzc0tleUNyZWRlbnRpYWxSZWxhdGlvbnMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/db/schema.ts\n");

/***/ }),

/***/ "(rsc)/./src/flags.ts":
/*!**********************!*\
  !*** ./src/flags.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getConfig: () => (/* binding */ getConfig),\n/* harmony export */   isGoogleSSOEnabled: () => (/* binding */ isGoogleSSOEnabled),\n/* harmony export */   isTurnstileEnabled: () => (/* binding */ isTurnstileEnabled)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function isGoogleSSOEnabled() {\n    return Boolean(process.env.GOOGLE_CLIENT_ID && process.env.GOOGLE_CLIENT_SECRET);\n}\nasync function isTurnstileEnabled() {\n    return Boolean(process.env.TURNSTILE_SECRET_KEY);\n}\nconst getConfig = (0,react__WEBPACK_IMPORTED_MODULE_1__.cache)(async ()=>{\n    return {\n        isGoogleSSOEnabled: await isGoogleSSOEnabled(),\n        isTurnstileEnabled: await isTurnstileEnabled()\n    };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZmxhZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFvQjtBQUVTO0FBRXRCLGVBQWVDO0lBQ3BCLE9BQU9DLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCLElBQUlGLFFBQVFDLEdBQUcsQ0FBQ0Usb0JBQW9CO0FBQ2pGO0FBRU8sZUFBZUM7SUFDcEIsT0FBT0wsUUFBUUMsUUFBUUMsR0FBRyxDQUFDSSxvQkFBb0I7QUFDakQ7QUFFTyxNQUFNQyxZQUFZVCw0Q0FBS0EsQ0FBQztJQUM3QixPQUFPO1FBQ0xDLG9CQUFvQixNQUFNQTtRQUMxQk0sb0JBQW9CLE1BQU1BO0lBQzVCO0FBQ0YsR0FBRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pblxcRGVza3RvcFxcRmluYWxQcm9qZWN0XFxzcmNcXGZsYWdzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcInNlcnZlci1vbmx5XCJcclxuXHJcbmltcG9ydCB7IGNhY2hlIH0gZnJvbSBcInJlYWN0XCJcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc0dvb2dsZVNTT0VuYWJsZWQoKSB7XHJcbiAgcmV0dXJuIEJvb2xlYW4ocHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCAmJiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVClcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzVHVybnN0aWxlRW5hYmxlZCgpIHtcclxuICByZXR1cm4gQm9vbGVhbihwcm9jZXNzLmVudi5UVVJOU1RJTEVfU0VDUkVUX0tFWSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldENvbmZpZyA9IGNhY2hlKGFzeW5jICgpID0+IHtcclxuICByZXR1cm4ge1xyXG4gICAgaXNHb29nbGVTU09FbmFibGVkOiBhd2FpdCBpc0dvb2dsZVNTT0VuYWJsZWQoKSxcclxuICAgIGlzVHVybnN0aWxlRW5hYmxlZDogYXdhaXQgaXNUdXJuc3RpbGVFbmFibGVkKCksXHJcbiAgfVxyXG59KVxyXG4iXSwibmFtZXMiOlsiY2FjaGUiLCJpc0dvb2dsZVNTT0VuYWJsZWQiLCJCb29sZWFuIiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9DTElFTlRfSUQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsImlzVHVybnN0aWxlRW5hYmxlZCIsIlRVUk5TVElMRV9TRUNSRVRfS0VZIiwiZ2V0Q29uZmlnIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/flags.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/try-catch.ts":
/*!******************************!*\
  !*** ./src/lib/try-catch.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   tryCatch: () => (/* binding */ tryCatch)\n/* harmony export */ });\n// Taken from https://gist.github.com/t3dotgg/a486c4ae66d32bf17c09c73609dacc5b\nasync function tryCatch(promise) {\n    try {\n        const data = await promise;\n        return {\n            data,\n            error: null\n        };\n    } catch (error) {\n        return {\n            data: null,\n            error: error\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3RyeS1jYXRjaC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBWUEsOEVBQThFO0FBQ3ZFLGVBQWVBLFNBQ3BCQyxPQUFtQjtJQUVuQixJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRDtRQUNuQixPQUFPO1lBQUVDO1lBQU1DLE9BQU87UUFBSztJQUM3QixFQUFFLE9BQU9BLE9BQU87UUFDZCxPQUFPO1lBQUVELE1BQU07WUFBTUMsT0FBT0E7UUFBVztJQUN6QztBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFkbWluXFxEZXNrdG9wXFxGaW5hbFByb2plY3RcXHNyY1xcbGliXFx0cnktY2F0Y2gudHMiXSwic291cmNlc0NvbnRlbnQiOlsidHlwZSBTdWNjZXNzPFQ+ID0ge1xyXG4gIGRhdGE6IFQ7XHJcbiAgZXJyb3I6IG51bGw7XHJcbn07XHJcblxyXG50eXBlIEZhaWx1cmU8RT4gPSB7XHJcbiAgZGF0YTogbnVsbDtcclxuICBlcnJvcjogRTtcclxufTtcclxuXHJcbnR5cGUgUmVzdWx0PFQsIEUgPSBFcnJvcj4gPSBTdWNjZXNzPFQ+IHwgRmFpbHVyZTxFPjtcclxuXHJcbi8vIFRha2VuIGZyb20gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vdDNkb3RnZy9hNDg2YzRhZTY2ZDMyYmYxN2MwOWM3MzYwOWRhY2M1YlxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdHJ5Q2F0Y2g8VCwgRSA9IEVycm9yPihcclxuICBwcm9taXNlOiBQcm9taXNlPFQ+LFxyXG4pOiBQcm9taXNlPFJlc3VsdDxULCBFPj4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcHJvbWlzZTtcclxuICAgIHJldHVybiB7IGRhdGEsIGVycm9yOiBudWxsIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiBlcnJvciBhcyBFIH07XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJ0cnlDYXRjaCIsInByb21pc2UiLCJkYXRhIiwiZXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/try-catch.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/auth.ts":
/*!***************************!*\
  !*** ./src/utils/auth.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   canSignUp: () => (/* binding */ canSignUp),\n/* harmony export */   createAndStoreSession: () => (/* binding */ createAndStoreSession),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   deleteSessionTokenCookie: () => (/* binding */ deleteSessionTokenCookie),\n/* harmony export */   generateSessionToken: () => (/* binding */ generateSessionToken),\n/* harmony export */   getSessionFromCookie: () => (/* binding */ getSessionFromCookie),\n/* harmony export */   getUserFromDB: () => (/* binding */ getUserFromDB),\n/* harmony export */   getUserTeamsWithPermissions: () => (/* binding */ getUserTeamsWithPermissions),\n/* harmony export */   invalidateSession: () => (/* binding */ invalidateSession),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   requireVerifiedEmail: () => (/* binding */ requireVerifiedEmail),\n/* harmony export */   setSessionTokenCookie: () => (/* binding */ setSessionTokenCookie)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/db/schema */ \"(rsc)/./src/db/schema.ts\");\n/* harmony import */ var _paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @paralleldrive/cuid2 */ \"(rsc)/./node_modules/.pnpm/@paralleldrive+cuid2@2.2.2/node_modules/@paralleldrive/cuid2/index.js\");\n/* harmony import */ var _oslojs_encoding__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @oslojs/encoding */ \"(rsc)/./node_modules/.pnpm/@oslojs+encoding@1.1.0/node_modules/@oslojs/encoding/dist/index.js\");\n/* harmony import */ var ms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ms */ \"(rsc)/./node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js\");\n/* harmony import */ var ms__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ms__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/db */ \"(rsc)/./src/db/index.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _utils_is_prod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/utils/is-prod */ \"(rsc)/./src/utils/is-prod.ts\");\n/* harmony import */ var _kv_session__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./kv-session */ \"(rsc)/./src/utils/kv-session.ts\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/constants */ \"(rsc)/./src/constants.ts\");\n/* harmony import */ var zsa__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! zsa */ \"(rsc)/./node_modules/.pnpm/zsa@0.6.0_zod@3.25.67/node_modules/zsa/dist/index.mjs\");\n/* harmony import */ var _credits__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./credits */ \"(rsc)/./src/utils/credits.ts\");\n/* harmony import */ var _name_initials__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./name-initials */ \"(rsc)/./src/utils/name-initials.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst getSessionLength = ()=>{\n    return ms__WEBPACK_IMPORTED_MODULE_4___default()(\"30d\");\n};\n/**\r\n * This file is based on https://lucia-auth.com\r\n */ async function getUserFromDB(userId) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_5__.getDB)();\n    return await db.query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_13__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.userTable.id, userId),\n        columns: {\n            id: true,\n            email: true,\n            firstName: true,\n            lastName: true,\n            role: true,\n            emailVerified: true,\n            avatar: true,\n            createdAt: true,\n            updatedAt: true,\n            currentCredits: true,\n            lastCreditRefreshAt: true\n        }\n    });\n}\nconst createId = (0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_2__.init)({\n    length: 32\n});\nfunction generateSessionToken() {\n    return createId();\n}\nasync function generateSessionId(token) {\n    const hashBuffer = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(token));\n    return (0,_oslojs_encoding__WEBPACK_IMPORTED_MODULE_3__.encodeHexLowerCase)(new Uint8Array(hashBuffer));\n}\nfunction encodeSessionCookie(userId, token) {\n    return `${userId}:${token}`;\n}\nfunction decodeSessionCookie(cookie) {\n    const parts = cookie.split(':');\n    if (parts.length !== 2) return null;\n    return {\n        userId: parts[0],\n        token: parts[1]\n    };\n}\nasync function getUserTeamsWithPermissions(userId) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_5__.getDB)();\n    // Get user's team memberships\n    const userTeamMemberships = await db.query.teamMembershipTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_13__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.teamMembershipTable.userId, userId),\n        with: {\n            team: true\n        }\n    });\n    // Fetch permissions for each membership\n    return Promise.all(userTeamMemberships.map(async (membership)=>{\n        let roleName = '';\n        let permissions = [];\n        // Handle system roles\n        if (membership.isSystemRole) {\n            roleName = membership.roleId; // For system roles, roleId contains the role name\n            // For system roles, get permissions based on role\n            if (membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.OWNER || membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.ADMIN) {\n                // Owners and admins have all permissions\n                permissions = Object.values(_db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS);\n            } else if (membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.MEMBER) {\n                // Default permissions for members\n                permissions = [\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.ACCESS_DASHBOARD,\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.CREATE_COMPONENTS,\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.EDIT_COMPONENTS\n                ];\n            } else if (membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.GUEST) {\n                // Guest permissions are limited\n                permissions = [\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.ACCESS_DASHBOARD\n                ];\n            }\n        } else {\n            // Handle custom roles\n            const role = await db.query.teamRoleTable.findFirst({\n                where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_13__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.teamRoleTable.id, membership.roleId)\n            });\n            if (role) {\n                roleName = role.name;\n                // Parse the stored JSON permissions\n                permissions = role.permissions;\n            }\n        }\n        return {\n            id: membership.teamId,\n            name: membership.team.name,\n            slug: membership.team.slug,\n            role: {\n                id: membership.roleId,\n                name: roleName,\n                isSystemRole: !!membership.isSystemRole\n            },\n            permissions\n        };\n    }));\n}\nasync function createSession({ token, userId, authenticationType, passkeyCredentialId }) {\n    const sessionId = await generateSessionId(token);\n    const expiresAt = new Date(Date.now() + getSessionLength());\n    const user = await getUserFromDB(userId);\n    if (!user) {\n        throw new Error(\"User not found\");\n    }\n    const teamsWithPermissions = await getUserTeamsWithPermissions(userId);\n    return (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.createKVSession)({\n        sessionId,\n        userId,\n        expiresAt,\n        user,\n        authenticationType,\n        passkeyCredentialId,\n        teams: teamsWithPermissions\n    });\n}\nasync function createAndStoreSession(userId, authenticationType, passkeyCredentialId) {\n    const sessionToken = generateSessionToken();\n    const session = await createSession({\n        token: sessionToken,\n        userId,\n        authenticationType,\n        passkeyCredentialId\n    });\n    await setSessionTokenCookie({\n        token: sessionToken,\n        userId,\n        expiresAt: new Date(session.expiresAt)\n    });\n}\nasync function validateSessionToken(token, userId) {\n    const sessionId = await generateSessionId(token);\n    const session = await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.getKVSession)(sessionId, userId);\n    if (!session) return null;\n    // If the session has expired, delete it and return null\n    if (Date.now() >= session.expiresAt) {\n        await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.deleteKVSession)(sessionId, userId);\n        return null;\n    }\n    // Check if session version needs to be updated\n    if (!session.version || session.version !== _kv_session__WEBPACK_IMPORTED_MODULE_8__.CURRENT_SESSION_VERSION) {\n        const updatedSession = await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.updateKVSession)(sessionId, userId, new Date(session.expiresAt));\n        if (!updatedSession) {\n            return null;\n        }\n        // Update the user initials\n        updatedSession.user.initials = (0,_name_initials__WEBPACK_IMPORTED_MODULE_12__.getInitials)(`${updatedSession.user.firstName} ${updatedSession.user.lastName}`);\n        return updatedSession;\n    }\n    // Check and refresh credits if needed\n    const currentCredits = await (0,_credits__WEBPACK_IMPORTED_MODULE_11__.addFreeMonthlyCreditsIfNeeded)(session);\n    // If credits were refreshed, update the session\n    if (session?.user?.currentCredits && currentCredits !== session.user.currentCredits) {\n        session.user.currentCredits = currentCredits;\n    }\n    // Update the user initials\n    session.user.initials = (0,_name_initials__WEBPACK_IMPORTED_MODULE_12__.getInitials)(`${session.user.firstName} ${session.user.lastName}`);\n    // Return the user data directly from the session\n    return session;\n}\nasync function invalidateSession(sessionId, userId) {\n    await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.deleteKVSession)(sessionId, userId);\n}\nasync function setSessionTokenCookie({ token, userId, expiresAt }) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_6__.cookies)();\n    cookieStore.set(_constants__WEBPACK_IMPORTED_MODULE_10__.SESSION_COOKIE_NAME, encodeSessionCookie(userId, token), {\n        httpOnly: true,\n        sameSite: _utils_is_prod__WEBPACK_IMPORTED_MODULE_7__[\"default\"] ? \"strict\" : \"lax\",\n        secure: _utils_is_prod__WEBPACK_IMPORTED_MODULE_7__[\"default\"],\n        expires: expiresAt,\n        path: \"/\"\n    });\n}\nasync function deleteSessionTokenCookie() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_6__.cookies)();\n    cookieStore.delete(_constants__WEBPACK_IMPORTED_MODULE_10__.SESSION_COOKIE_NAME);\n}\n/**\r\n * This function can only be called in a Server Components, Server Action or Route Handler\r\n */ const getSessionFromCookie = (0,react__WEBPACK_IMPORTED_MODULE_9__.cache)(async ()=>{\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_6__.cookies)();\n    const sessionCookie = cookieStore.get(_constants__WEBPACK_IMPORTED_MODULE_10__.SESSION_COOKIE_NAME)?.value;\n    if (!sessionCookie) {\n        return null;\n    }\n    const decoded = decodeSessionCookie(sessionCookie);\n    if (!decoded || !decoded.token || !decoded.userId) {\n        return null;\n    }\n    return validateSessionToken(decoded.token, decoded.userId);\n});\nconst requireVerifiedEmail = (0,react__WEBPACK_IMPORTED_MODULE_9__.cache)(async ({ doNotThrowError = false } = {})=>{\n    const session = await getSessionFromCookie();\n    if (!session) {\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"NOT_AUTHORIZED\", \"Not authenticated\");\n    }\n    if (!session?.user?.emailVerified) {\n        if (doNotThrowError) {\n            return null;\n        }\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"FORBIDDEN\", \"Please verify your email first\");\n    }\n    return session;\n});\nconst requireAdmin = (0,react__WEBPACK_IMPORTED_MODULE_9__.cache)(async ({ doNotThrowError = false } = {})=>{\n    const session = await getSessionFromCookie();\n    if (!session) {\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"NOT_AUTHORIZED\", \"Not authenticated\");\n    }\n    if (session.user.role !== _db_schema__WEBPACK_IMPORTED_MODULE_1__.ROLES_ENUM.ADMIN) {\n        if (doNotThrowError) {\n            return null;\n        }\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"FORBIDDEN\", \"Not authorized\");\n    }\n    return session;\n});\n/**\r\n * Checks if an email is disposable using debounce.io\r\n */ async function checkWithDebounce(email) {\n    try {\n        const response = await fetch(`https://disposable.debounce.io/?email=${encodeURIComponent(email)}`);\n        if (!response.ok) {\n            console.error(\"Debounce.io API error:\", response.status);\n            return {\n                success: false,\n                isDisposable: false\n            };\n        }\n        const data = await response.json();\n        return {\n            success: true,\n            isDisposable: data.disposable === \"true\"\n        };\n    } catch (error) {\n        console.error(\"Failed to check disposable email with debounce.io:\", error);\n        return {\n            success: false,\n            isDisposable: false\n        };\n    }\n}\n/**\r\n * Checks if an email is disposable using mailcheck.ai\r\n */ async function checkWithMailcheck(email) {\n    try {\n        const response = await fetch(`https://api.mailcheck.ai/email/${encodeURIComponent(email)}`);\n        if (!response.ok) {\n            console.error(\"Mailcheck.ai API error:\", response.status);\n            return {\n                success: false,\n                isDisposable: false\n            };\n        }\n        const data = await response.json();\n        return {\n            success: true,\n            isDisposable: data.disposable\n        };\n    } catch (error) {\n        console.error(\"Failed to check disposable email with mailcheck.ai:\", error);\n        return {\n            success: false,\n            isDisposable: false\n        };\n    }\n}\n/**\r\n * Checks if an email is allowed for sign up by verifying it's not a disposable email\r\n * Uses multiple services in sequence for redundancy.\r\n *\r\n * @throws {ZSAError} If email is disposable or if all services fail\r\n */ async function canSignUp({ email }) {\n    // Skip disposable email check in development\n    if (!_utils_is_prod__WEBPACK_IMPORTED_MODULE_7__[\"default\"]) {\n        return;\n    }\n    const validators = [\n        checkWithDebounce,\n        checkWithMailcheck\n    ];\n    for (const validator of validators){\n        const result = await validator(email);\n        // If the validator failed (network error, rate limit, etc), try the next one\n        if (!result.success) {\n            continue;\n        }\n        // If we got a successful response and it's disposable, reject the signup\n        if (result.isDisposable) {\n            throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"PRECONDITION_FAILED\", \"Disposable email addresses are not allowed\");\n        }\n        // If we got a successful response and it's not disposable, allow the signup\n        return;\n    }\n    // If all validators failed, we can't verify the email\n    throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"PRECONDITION_FAILED\", \"Unable to verify email address at this time. Please try again later.\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxNQUFNRSxTQUFTLE1BQU1ELFVBQVV6RztRQUUvQiw2RUFBNkU7UUFDN0UsSUFBSSxDQUFDMEcsT0FBT1QsT0FBTyxFQUFFO1lBQ25CO1FBQ0Y7UUFFQSx5RUFBeUU7UUFDekUsSUFBSVMsT0FBT1IsWUFBWSxFQUFFO1lBQ3ZCLE1BQU0sSUFBSTlHLDBDQUFRQSxDQUNoQix1QkFDQTtRQUVKO1FBRUEsNEVBQTRFO1FBQzVFO0lBQ0Y7SUFFQSxzREFBc0Q7SUFDdEQsTUFBTSxJQUFJQSwwQ0FBUUEsQ0FDaEIsdUJBQ0E7QUFFSiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pblxcRGVza3RvcFxcRmluYWxQcm9qZWN0XFxzcmNcXHV0aWxzXFxhdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcInNlcnZlci1vbmx5XCI7XHJcblxyXG5pbXBvcnQgeyBST0xFU19FTlVNLCB1c2VyVGFibGUsIHRlYW1NZW1iZXJzaGlwVGFibGUsIFNZU1RFTV9ST0xFU19FTlVNLCB0ZWFtUm9sZVRhYmxlLCBURUFNX1BFUk1JU1NJT05TIH0gZnJvbSBcIkAvZGIvc2NoZW1hXCI7XHJcbmltcG9ydCB7IGluaXQgfSBmcm9tIFwiQHBhcmFsbGVsZHJpdmUvY3VpZDJcIjtcclxuaW1wb3J0IHsgZW5jb2RlSGV4TG93ZXJDYXNlIH0gZnJvbSBcIkBvc2xvanMvZW5jb2RpbmdcIlxyXG5pbXBvcnQgbXMgZnJvbSBcIm1zXCJcclxuaW1wb3J0IHsgZ2V0REIgfSBmcm9tIFwiQC9kYlwiO1xyXG5pbXBvcnQgeyBlcSB9IGZyb20gXCJkcml6emxlLW9ybVwiO1xyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xyXG5pbXBvcnQgaXNQcm9kIGZyb20gXCJAL3V0aWxzL2lzLXByb2RcIjtcclxuaW1wb3J0IHtcclxuICBjcmVhdGVLVlNlc3Npb24sXHJcbiAgZGVsZXRlS1ZTZXNzaW9uLFxyXG4gIHR5cGUgS1ZTZXNzaW9uLFxyXG4gIHR5cGUgQ3JlYXRlS1ZTZXNzaW9uUGFyYW1zLFxyXG4gIGdldEtWU2Vzc2lvbixcclxuICB1cGRhdGVLVlNlc3Npb24sXHJcbiAgQ1VSUkVOVF9TRVNTSU9OX1ZFUlNJT05cclxufSBmcm9tIFwiLi9rdi1zZXNzaW9uXCI7XHJcbmltcG9ydCB7IGNhY2hlIH0gZnJvbSBcInJlYWN0XCJcclxuaW1wb3J0IHR5cGUgeyBTZXNzaW9uVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gXCJAL3R5cGVzXCI7XHJcbmltcG9ydCB7IFNFU1NJT05fQ09PS0lFX05BTUUgfSBmcm9tIFwiQC9jb25zdGFudHNcIjtcclxuaW1wb3J0IHsgWlNBRXJyb3IgfSBmcm9tIFwienNhXCI7XHJcbmltcG9ydCB7IGFkZEZyZWVNb250aGx5Q3JlZGl0c0lmTmVlZGVkIH0gZnJvbSBcIi4vY3JlZGl0c1wiO1xyXG5pbXBvcnQgeyBnZXRJbml0aWFscyB9IGZyb20gXCIuL25hbWUtaW5pdGlhbHNcIjtcclxuXHJcbmNvbnN0IGdldFNlc3Npb25MZW5ndGggPSAoKSA9PiB7XHJcbiAgcmV0dXJuIG1zKFwiMzBkXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogVGhpcyBmaWxlIGlzIGJhc2VkIG9uIGh0dHBzOi8vbHVjaWEtYXV0aC5jb21cclxuICovXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckZyb21EQih1c2VySWQ6IHN0cmluZykge1xyXG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcclxuICByZXR1cm4gYXdhaXQgZGIucXVlcnkudXNlclRhYmxlLmZpbmRGaXJzdCh7XHJcbiAgICB3aGVyZTogZXEodXNlclRhYmxlLmlkLCB1c2VySWQpLFxyXG4gICAgY29sdW1uczoge1xyXG4gICAgICBpZDogdHJ1ZSxcclxuICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcclxuICAgICAgbGFzdE5hbWU6IHRydWUsXHJcbiAgICAgIHJvbGU6IHRydWUsXHJcbiAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXHJcbiAgICAgIGF2YXRhcjogdHJ1ZSxcclxuICAgICAgY3JlYXRlZEF0OiB0cnVlLFxyXG4gICAgICB1cGRhdGVkQXQ6IHRydWUsXHJcbiAgICAgIGN1cnJlbnRDcmVkaXRzOiB0cnVlLFxyXG4gICAgICBsYXN0Q3JlZGl0UmVmcmVzaEF0OiB0cnVlLFxyXG4gICAgfSxcclxuICB9KTtcclxufVxyXG5cclxuY29uc3QgY3JlYXRlSWQgPSBpbml0KHtcclxuICBsZW5ndGg6IDMyLFxyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNlc3Npb25Ub2tlbigpOiBzdHJpbmcge1xyXG4gIHJldHVybiBjcmVhdGVJZCgpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVNlc3Npb25JZCh0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICBjb25zdCBoYXNoQnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kaWdlc3QoJ1NIQS0yNTYnLCBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUodG9rZW4pKTtcclxuICByZXR1cm4gZW5jb2RlSGV4TG93ZXJDYXNlKG5ldyBVaW50OEFycmF5KGhhc2hCdWZmZXIpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5jb2RlU2Vzc2lvbkNvb2tpZSh1c2VySWQ6IHN0cmluZywgdG9rZW46IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGAke3VzZXJJZH06JHt0b2tlbn1gO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWNvZGVTZXNzaW9uQ29va2llKGNvb2tpZTogc3RyaW5nKTogeyB1c2VySWQ6IHN0cmluZzsgdG9rZW46IHN0cmluZyB9IHwgbnVsbCB7XHJcbiAgY29uc3QgcGFydHMgPSBjb29raWUuc3BsaXQoJzonKTtcclxuICBpZiAocGFydHMubGVuZ3RoICE9PSAyKSByZXR1cm4gbnVsbDtcclxuICByZXR1cm4geyB1c2VySWQ6IHBhcnRzWzBdLCB0b2tlbjogcGFydHNbMV0gfTtcclxufVxyXG5cclxuaW50ZXJmYWNlIENyZWF0ZVNlc3Npb25QYXJhbXMgZXh0ZW5kcyBQaWNrPENyZWF0ZUtWU2Vzc2lvblBhcmFtcywgXCJhdXRoZW50aWNhdGlvblR5cGVcIiB8IFwicGFzc2tleUNyZWRlbnRpYWxJZFwiIHwgXCJ1c2VySWRcIj4ge1xyXG4gIHRva2VuOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnModXNlcklkOiBzdHJpbmcpIHtcclxuICBjb25zdCBkYiA9IGdldERCKCk7XHJcblxyXG4gIC8vIEdldCB1c2VyJ3MgdGVhbSBtZW1iZXJzaGlwc1xyXG4gIGNvbnN0IHVzZXJUZWFtTWVtYmVyc2hpcHMgPSBhd2FpdCBkYi5xdWVyeS50ZWFtTWVtYmVyc2hpcFRhYmxlLmZpbmRNYW55KHtcclxuICAgIHdoZXJlOiBlcSh0ZWFtTWVtYmVyc2hpcFRhYmxlLnVzZXJJZCwgdXNlcklkKSxcclxuICAgIHdpdGg6IHtcclxuICAgICAgdGVhbTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIC8vIEZldGNoIHBlcm1pc3Npb25zIGZvciBlYWNoIG1lbWJlcnNoaXBcclxuICByZXR1cm4gUHJvbWlzZS5hbGwoXHJcbiAgICB1c2VyVGVhbU1lbWJlcnNoaXBzLm1hcChhc3luYyAobWVtYmVyc2hpcCkgPT4ge1xyXG4gICAgICBsZXQgcm9sZU5hbWUgPSAnJztcclxuICAgICAgbGV0IHBlcm1pc3Npb25zOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgICAgLy8gSGFuZGxlIHN5c3RlbSByb2xlc1xyXG4gICAgICBpZiAobWVtYmVyc2hpcC5pc1N5c3RlbVJvbGUpIHtcclxuICAgICAgICByb2xlTmFtZSA9IG1lbWJlcnNoaXAucm9sZUlkOyAvLyBGb3Igc3lzdGVtIHJvbGVzLCByb2xlSWQgY29udGFpbnMgdGhlIHJvbGUgbmFtZVxyXG5cclxuICAgICAgICAvLyBGb3Igc3lzdGVtIHJvbGVzLCBnZXQgcGVybWlzc2lvbnMgYmFzZWQgb24gcm9sZVxyXG4gICAgICAgIGlmIChtZW1iZXJzaGlwLnJvbGVJZCA9PT0gU1lTVEVNX1JPTEVTX0VOVU0uT1dORVIgfHwgbWVtYmVyc2hpcC5yb2xlSWQgPT09IFNZU1RFTV9ST0xFU19FTlVNLkFETUlOKSB7XHJcbiAgICAgICAgICAvLyBPd25lcnMgYW5kIGFkbWlucyBoYXZlIGFsbCBwZXJtaXNzaW9uc1xyXG4gICAgICAgICAgcGVybWlzc2lvbnMgPSBPYmplY3QudmFsdWVzKFRFQU1fUEVSTUlTU0lPTlMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobWVtYmVyc2hpcC5yb2xlSWQgPT09IFNZU1RFTV9ST0xFU19FTlVNLk1FTUJFUikge1xyXG4gICAgICAgICAgLy8gRGVmYXVsdCBwZXJtaXNzaW9ucyBmb3IgbWVtYmVyc1xyXG4gICAgICAgICAgcGVybWlzc2lvbnMgPSBbXHJcbiAgICAgICAgICAgIFRFQU1fUEVSTUlTU0lPTlMuQUNDRVNTX0RBU0hCT0FSRCxcclxuICAgICAgICAgICAgVEVBTV9QRVJNSVNTSU9OUy5DUkVBVEVfQ09NUE9ORU5UUyxcclxuICAgICAgICAgICAgVEVBTV9QRVJNSVNTSU9OUy5FRElUX0NPTVBPTkVOVFMsXHJcbiAgICAgICAgICBdO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobWVtYmVyc2hpcC5yb2xlSWQgPT09IFNZU1RFTV9ST0xFU19FTlVNLkdVRVNUKSB7XHJcbiAgICAgICAgICAvLyBHdWVzdCBwZXJtaXNzaW9ucyBhcmUgbGltaXRlZFxyXG4gICAgICAgICAgcGVybWlzc2lvbnMgPSBbXHJcbiAgICAgICAgICAgIFRFQU1fUEVSTUlTU0lPTlMuQUNDRVNTX0RBU0hCT0FSRCxcclxuICAgICAgICAgIF07XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEhhbmRsZSBjdXN0b20gcm9sZXNcclxuICAgICAgICBjb25zdCByb2xlID0gYXdhaXQgZGIucXVlcnkudGVhbVJvbGVUYWJsZS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgd2hlcmU6IGVxKHRlYW1Sb2xlVGFibGUuaWQsIG1lbWJlcnNoaXAucm9sZUlkKSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHJvbGUpIHtcclxuICAgICAgICAgIHJvbGVOYW1lID0gcm9sZS5uYW1lO1xyXG4gICAgICAgICAgLy8gUGFyc2UgdGhlIHN0b3JlZCBKU09OIHBlcm1pc3Npb25zXHJcbiAgICAgICAgICBwZXJtaXNzaW9ucyA9IHJvbGUucGVybWlzc2lvbnMgYXMgc3RyaW5nW107XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBtZW1iZXJzaGlwLnRlYW1JZCxcclxuICAgICAgICBuYW1lOiBtZW1iZXJzaGlwLnRlYW0ubmFtZSxcclxuICAgICAgICBzbHVnOiBtZW1iZXJzaGlwLnRlYW0uc2x1ZyxcclxuICAgICAgICByb2xlOiB7XHJcbiAgICAgICAgICBpZDogbWVtYmVyc2hpcC5yb2xlSWQsXHJcbiAgICAgICAgICBuYW1lOiByb2xlTmFtZSxcclxuICAgICAgICAgIGlzU3lzdGVtUm9sZTogISFtZW1iZXJzaGlwLmlzU3lzdGVtUm9sZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBlcm1pc3Npb25zLFxyXG4gICAgICB9O1xyXG4gICAgfSlcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbih7XHJcbiAgdG9rZW4sXHJcbiAgdXNlcklkLFxyXG4gIGF1dGhlbnRpY2F0aW9uVHlwZSxcclxuICBwYXNza2V5Q3JlZGVudGlhbElkXHJcbn06IENyZWF0ZVNlc3Npb25QYXJhbXMpOiBQcm9taXNlPEtWU2Vzc2lvbj4ge1xyXG4gIGNvbnN0IHNlc3Npb25JZCA9IGF3YWl0IGdlbmVyYXRlU2Vzc2lvbklkKHRva2VuKTtcclxuICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgZ2V0U2Vzc2lvbkxlbmd0aCgpKTtcclxuXHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldFVzZXJGcm9tREIodXNlcklkKTtcclxuXHJcbiAgaWYgKCF1c2VyKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVc2VyIG5vdCBmb3VuZFwiKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRlYW1zV2l0aFBlcm1pc3Npb25zID0gYXdhaXQgZ2V0VXNlclRlYW1zV2l0aFBlcm1pc3Npb25zKHVzZXJJZCk7XHJcblxyXG4gIHJldHVybiBjcmVhdGVLVlNlc3Npb24oe1xyXG4gICAgc2Vzc2lvbklkLFxyXG4gICAgdXNlcklkLFxyXG4gICAgZXhwaXJlc0F0LFxyXG4gICAgdXNlcixcclxuICAgIGF1dGhlbnRpY2F0aW9uVHlwZSxcclxuICAgIHBhc3NrZXlDcmVkZW50aWFsSWQsXHJcbiAgICB0ZWFtczogdGVhbXNXaXRoUGVybWlzc2lvbnNcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFuZFN0b3JlU2Vzc2lvbihcclxuICB1c2VySWQ6IHN0cmluZyxcclxuICBhdXRoZW50aWNhdGlvblR5cGU/OiBDcmVhdGVLVlNlc3Npb25QYXJhbXNbXCJhdXRoZW50aWNhdGlvblR5cGVcIl0sXHJcbiAgcGFzc2tleUNyZWRlbnRpYWxJZD86IENyZWF0ZUtWU2Vzc2lvblBhcmFtc1tcInBhc3NrZXlDcmVkZW50aWFsSWRcIl1cclxuKSB7XHJcbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2VuZXJhdGVTZXNzaW9uVG9rZW4oKTtcclxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3JlYXRlU2Vzc2lvbih7XHJcbiAgICB0b2tlbjogc2Vzc2lvblRva2VuLFxyXG4gICAgdXNlcklkLFxyXG4gICAgYXV0aGVudGljYXRpb25UeXBlLFxyXG4gICAgcGFzc2tleUNyZWRlbnRpYWxJZFxyXG4gIH0pO1xyXG4gIGF3YWl0IHNldFNlc3Npb25Ub2tlbkNvb2tpZSh7XHJcbiAgICB0b2tlbjogc2Vzc2lvblRva2VuLFxyXG4gICAgdXNlcklkLFxyXG4gICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzZXNzaW9uLmV4cGlyZXNBdClcclxuICB9KTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVTZXNzaW9uVG9rZW4odG9rZW46IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFNlc3Npb25WYWxpZGF0aW9uUmVzdWx0IHwgbnVsbD4ge1xyXG4gIGNvbnN0IHNlc3Npb25JZCA9IGF3YWl0IGdlbmVyYXRlU2Vzc2lvbklkKHRva2VuKTtcclxuXHJcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldEtWU2Vzc2lvbihzZXNzaW9uSWQsIHVzZXJJZCk7XHJcblxyXG4gIGlmICghc2Vzc2lvbikgcmV0dXJuIG51bGw7XHJcblxyXG4gIC8vIElmIHRoZSBzZXNzaW9uIGhhcyBleHBpcmVkLCBkZWxldGUgaXQgYW5kIHJldHVybiBudWxsXHJcbiAgaWYgKERhdGUubm93KCkgPj0gc2Vzc2lvbi5leHBpcmVzQXQpIHtcclxuICAgIGF3YWl0IGRlbGV0ZUtWU2Vzc2lvbihzZXNzaW9uSWQsIHVzZXJJZCk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIHNlc3Npb24gdmVyc2lvbiBuZWVkcyB0byBiZSB1cGRhdGVkXHJcbiAgaWYgKCFzZXNzaW9uLnZlcnNpb24gfHwgc2Vzc2lvbi52ZXJzaW9uICE9PSBDVVJSRU5UX1NFU1NJT05fVkVSU0lPTikge1xyXG4gICAgY29uc3QgdXBkYXRlZFNlc3Npb24gPSBhd2FpdCB1cGRhdGVLVlNlc3Npb24oc2Vzc2lvbklkLCB1c2VySWQsIG5ldyBEYXRlKHNlc3Npb24uZXhwaXJlc0F0KSk7XHJcblxyXG4gICAgaWYgKCF1cGRhdGVkU2Vzc2lvbikge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHVzZXIgaW5pdGlhbHNcclxuICAgIHVwZGF0ZWRTZXNzaW9uLnVzZXIuaW5pdGlhbHMgPSBnZXRJbml0aWFscyhgJHt1cGRhdGVkU2Vzc2lvbi51c2VyLmZpcnN0TmFtZX0gJHt1cGRhdGVkU2Vzc2lvbi51c2VyLmxhc3ROYW1lfWApO1xyXG5cclxuICAgIHJldHVybiB1cGRhdGVkU2Vzc2lvbjtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGFuZCByZWZyZXNoIGNyZWRpdHMgaWYgbmVlZGVkXHJcbiAgY29uc3QgY3VycmVudENyZWRpdHMgPSBhd2FpdCBhZGRGcmVlTW9udGhseUNyZWRpdHNJZk5lZWRlZChzZXNzaW9uKTtcclxuXHJcbiAgLy8gSWYgY3JlZGl0cyB3ZXJlIHJlZnJlc2hlZCwgdXBkYXRlIHRoZSBzZXNzaW9uXHJcbiAgaWYgKFxyXG4gICAgc2Vzc2lvbj8udXNlcj8uY3VycmVudENyZWRpdHMgJiZcclxuICAgIGN1cnJlbnRDcmVkaXRzICE9PSBzZXNzaW9uLnVzZXIuY3VycmVudENyZWRpdHNcclxuICApIHtcclxuICAgIHNlc3Npb24udXNlci5jdXJyZW50Q3JlZGl0cyA9IGN1cnJlbnRDcmVkaXRzO1xyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlIHRoZSB1c2VyIGluaXRpYWxzXHJcbiAgc2Vzc2lvbi51c2VyLmluaXRpYWxzID0gZ2V0SW5pdGlhbHMoYCR7c2Vzc2lvbi51c2VyLmZpcnN0TmFtZX0gJHtzZXNzaW9uLnVzZXIubGFzdE5hbWV9YCk7XHJcblxyXG4gIC8vIFJldHVybiB0aGUgdXNlciBkYXRhIGRpcmVjdGx5IGZyb20gdGhlIHNlc3Npb25cclxuICByZXR1cm4gc2Vzc2lvbjtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGludmFsaWRhdGVTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGRlbGV0ZUtWU2Vzc2lvbihzZXNzaW9uSWQsIHVzZXJJZCk7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTZXRTZXNzaW9uVG9rZW5Db29raWVQYXJhbXMge1xyXG4gIHRva2VuOiBzdHJpbmc7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgZXhwaXJlc0F0OiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0U2Vzc2lvblRva2VuQ29va2llKHsgdG9rZW4sIHVzZXJJZCwgZXhwaXJlc0F0IH06IFNldFNlc3Npb25Ub2tlbkNvb2tpZVBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xyXG4gIGNvb2tpZVN0b3JlLnNldChTRVNTSU9OX0NPT0tJRV9OQU1FLCBlbmNvZGVTZXNzaW9uQ29va2llKHVzZXJJZCwgdG9rZW4pLCB7XHJcbiAgICBodHRwT25seTogdHJ1ZSxcclxuICAgIHNhbWVTaXRlOiBpc1Byb2QgPyBcInN0cmljdFwiIDogXCJsYXhcIixcclxuICAgIHNlY3VyZTogaXNQcm9kLFxyXG4gICAgZXhwaXJlczogZXhwaXJlc0F0LFxyXG4gICAgcGF0aDogXCIvXCIsXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTZXNzaW9uVG9rZW5Db29raWUoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XHJcbiAgY29va2llU3RvcmUuZGVsZXRlKFNFU1NJT05fQ09PS0lFX05BTUUpO1xyXG59XHJcblxyXG4vKipcclxuICogVGhpcyBmdW5jdGlvbiBjYW4gb25seSBiZSBjYWxsZWQgaW4gYSBTZXJ2ZXIgQ29tcG9uZW50cywgU2VydmVyIEFjdGlvbiBvciBSb3V0ZSBIYW5kbGVyXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgZ2V0U2Vzc2lvbkZyb21Db29raWUgPSBjYWNoZShhc3luYyAoKTogUHJvbWlzZTxTZXNzaW9uVmFsaWRhdGlvblJlc3VsdCB8IG51bGw+ID0+IHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKTtcclxuICBjb25zdCBzZXNzaW9uQ29va2llID0gY29va2llU3RvcmUuZ2V0KFNFU1NJT05fQ09PS0lFX05BTUUpPy52YWx1ZTtcclxuXHJcbiAgaWYgKCFzZXNzaW9uQ29va2llKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIGNvbnN0IGRlY29kZWQgPSBkZWNvZGVTZXNzaW9uQ29va2llKHNlc3Npb25Db29raWUpO1xyXG5cclxuICBpZiAoIWRlY29kZWQgfHwgIWRlY29kZWQudG9rZW4gfHwgIWRlY29kZWQudXNlcklkKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIHJldHVybiB2YWxpZGF0ZVNlc3Npb25Ub2tlbihkZWNvZGVkLnRva2VuLCBkZWNvZGVkLnVzZXJJZCk7XHJcbn0pXHJcblxyXG5leHBvcnQgY29uc3QgcmVxdWlyZVZlcmlmaWVkRW1haWwgPSBjYWNoZShhc3luYyAoe1xyXG4gIGRvTm90VGhyb3dFcnJvciA9IGZhbHNlLFxyXG59OiB7XHJcbiAgZG9Ob3RUaHJvd0Vycm9yPzogYm9vbGVhbjtcclxufSA9IHt9KSA9PiB7XHJcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ29va2llKCk7XHJcblxyXG4gIGlmICghc2Vzc2lvbikge1xyXG4gICAgdGhyb3cgbmV3IFpTQUVycm9yKFwiTk9UX0FVVEhPUklaRURcIiwgXCJOb3QgYXV0aGVudGljYXRlZFwiKTtcclxuICB9XHJcblxyXG4gIGlmICghc2Vzc2lvbj8udXNlcj8uZW1haWxWZXJpZmllZCkge1xyXG4gICAgaWYgKGRvTm90VGhyb3dFcnJvcikge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICB0aHJvdyBuZXcgWlNBRXJyb3IoXCJGT1JCSURERU5cIiwgXCJQbGVhc2UgdmVyaWZ5IHlvdXIgZW1haWwgZmlyc3RcIik7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gc2Vzc2lvbjtcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgcmVxdWlyZUFkbWluID0gY2FjaGUoYXN5bmMgKHtcclxuICBkb05vdFRocm93RXJyb3IgPSBmYWxzZSxcclxufToge1xyXG4gIGRvTm90VGhyb3dFcnJvcj86IGJvb2xlYW47XHJcbn0gPSB7fSkgPT4ge1xyXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUNvb2tpZSgpO1xyXG5cclxuICBpZiAoIXNlc3Npb24pIHtcclxuICAgIHRocm93IG5ldyBaU0FFcnJvcihcIk5PVF9BVVRIT1JJWkVEXCIsIFwiTm90IGF1dGhlbnRpY2F0ZWRcIik7XHJcbiAgfVxyXG5cclxuICBpZiAoc2Vzc2lvbi51c2VyLnJvbGUgIT09IFJPTEVTX0VOVU0uQURNSU4pIHtcclxuICAgIGlmIChkb05vdFRocm93RXJyb3IpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbmV3IFpTQUVycm9yKFwiRk9SQklEREVOXCIsIFwiTm90IGF1dGhvcml6ZWRcIik7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gc2Vzc2lvbjtcclxufSk7XHJcblxyXG5pbnRlcmZhY2UgRGlzcG9zYWJsZUVtYWlsUmVzcG9uc2Uge1xyXG4gIGRpc3Bvc2FibGU6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIE1haWxjaGVja1Jlc3BvbnNlIHtcclxuICBzdGF0dXM6IG51bWJlcjtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIGRvbWFpbjogc3RyaW5nO1xyXG4gIG14OiBib29sZWFuO1xyXG4gIGRpc3Bvc2FibGU6IGJvb2xlYW47XHJcbiAgcHVibGljX2RvbWFpbjogYm9vbGVhbjtcclxuICByZWxheV9kb21haW46IGJvb2xlYW47XHJcbiAgYWxpYXM6IGJvb2xlYW47XHJcbiAgcm9sZV9hY2NvdW50OiBib29sZWFuO1xyXG4gIGRpZF95b3VfbWVhbjogc3RyaW5nIHwgbnVsbDtcclxufVxyXG5cclxudHlwZSBWYWxpZGF0b3JSZXN1bHQgPSB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBpc0Rpc3Bvc2FibGU6IGJvb2xlYW47XHJcbn07XHJcblxyXG4vKipcclxuICogQ2hlY2tzIGlmIGFuIGVtYWlsIGlzIGRpc3Bvc2FibGUgdXNpbmcgZGVib3VuY2UuaW9cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGNoZWNrV2l0aERlYm91bmNlKGVtYWlsOiBzdHJpbmcpOiBQcm9taXNlPFZhbGlkYXRvclJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2Rpc3Bvc2FibGUuZGVib3VuY2UuaW8vP2VtYWlsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGVtYWlsKX1gKTtcclxuXHJcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEZWJvdW5jZS5pbyBBUEkgZXJyb3I6XCIsIHJlc3BvbnNlLnN0YXR1cyk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBpc0Rpc3Bvc2FibGU6IGZhbHNlIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyBEaXNwb3NhYmxlRW1haWxSZXNwb25zZTtcclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBpc0Rpc3Bvc2FibGU6IGRhdGEuZGlzcG9zYWJsZSA9PT0gXCJ0cnVlXCIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBjaGVjayBkaXNwb3NhYmxlIGVtYWlsIHdpdGggZGVib3VuY2UuaW86XCIsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBpc0Rpc3Bvc2FibGU6IGZhbHNlIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2tzIGlmIGFuIGVtYWlsIGlzIGRpc3Bvc2FibGUgdXNpbmcgbWFpbGNoZWNrLmFpXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBjaGVja1dpdGhNYWlsY2hlY2soZW1haWw6IHN0cmluZyk6IFByb21pc2U8VmFsaWRhdG9yUmVzdWx0PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLm1haWxjaGVjay5haS9lbWFpbC8ke2VuY29kZVVSSUNvbXBvbmVudChlbWFpbCl9YCk7XHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTWFpbGNoZWNrLmFpIEFQSSBlcnJvcjpcIiwgcmVzcG9uc2Uuc3RhdHVzKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGlzRGlzcG9zYWJsZTogZmFsc2UgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpIGFzIE1haWxjaGVja1Jlc3BvbnNlO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaXNEaXNwb3NhYmxlOiBkYXRhLmRpc3Bvc2FibGUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBjaGVjayBkaXNwb3NhYmxlIGVtYWlsIHdpdGggbWFpbGNoZWNrLmFpOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgaXNEaXNwb3NhYmxlOiBmYWxzZSB9O1xyXG4gIH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBDaGVja3MgaWYgYW4gZW1haWwgaXMgYWxsb3dlZCBmb3Igc2lnbiB1cCBieSB2ZXJpZnlpbmcgaXQncyBub3QgYSBkaXNwb3NhYmxlIGVtYWlsXHJcbiAqIFVzZXMgbXVsdGlwbGUgc2VydmljZXMgaW4gc2VxdWVuY2UgZm9yIHJlZHVuZGFuY3kuXHJcbiAqXHJcbiAqIEB0aHJvd3Mge1pTQUVycm9yfSBJZiBlbWFpbCBpcyBkaXNwb3NhYmxlIG9yIGlmIGFsbCBzZXJ2aWNlcyBmYWlsXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FuU2lnblVwKHsgZW1haWwgfTogeyBlbWFpbDogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBTa2lwIGRpc3Bvc2FibGUgZW1haWwgY2hlY2sgaW4gZGV2ZWxvcG1lbnRcclxuICBpZiAoIWlzUHJvZCkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdmFsaWRhdG9ycyA9IFtcclxuICAgIGNoZWNrV2l0aERlYm91bmNlLFxyXG4gICAgY2hlY2tXaXRoTWFpbGNoZWNrLFxyXG4gIF07XHJcblxyXG4gIGZvciAoY29uc3QgdmFsaWRhdG9yIG9mIHZhbGlkYXRvcnMpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRvcihlbWFpbCk7XHJcblxyXG4gICAgLy8gSWYgdGhlIHZhbGlkYXRvciBmYWlsZWQgKG5ldHdvcmsgZXJyb3IsIHJhdGUgbGltaXQsIGV0YyksIHRyeSB0aGUgbmV4dCBvbmVcclxuICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgd2UgZ290IGEgc3VjY2Vzc2Z1bCByZXNwb25zZSBhbmQgaXQncyBkaXNwb3NhYmxlLCByZWplY3QgdGhlIHNpZ251cFxyXG4gICAgaWYgKHJlc3VsdC5pc0Rpc3Bvc2FibGUpIHtcclxuICAgICAgdGhyb3cgbmV3IFpTQUVycm9yKFxyXG4gICAgICAgIFwiUFJFQ09ORElUSU9OX0ZBSUxFRFwiLFxyXG4gICAgICAgIFwiRGlzcG9zYWJsZSBlbWFpbCBhZGRyZXNzZXMgYXJlIG5vdCBhbGxvd2VkXCJcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiB3ZSBnb3QgYSBzdWNjZXNzZnVsIHJlc3BvbnNlIGFuZCBpdCdzIG5vdCBkaXNwb3NhYmxlLCBhbGxvdyB0aGUgc2lnbnVwXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvLyBJZiBhbGwgdmFsaWRhdG9ycyBmYWlsZWQsIHdlIGNhbid0IHZlcmlmeSB0aGUgZW1haWxcclxuICB0aHJvdyBuZXcgWlNBRXJyb3IoXHJcbiAgICBcIlBSRUNPTkRJVElPTl9GQUlMRURcIixcclxuICAgIFwiVW5hYmxlIHRvIHZlcmlmeSBlbWFpbCBhZGRyZXNzIGF0IHRoaXMgdGltZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIlxyXG4gICk7XHJcbn1cclxuIl0sIm5hbWVzIjpbIlJPTEVTX0VOVU0iLCJ1c2VyVGFibGUiLCJ0ZWFtTWVtYmVyc2hpcFRhYmxlIiwiU1lTVEVNX1JPTEVTX0VOVU0iLCJ0ZWFtUm9sZVRhYmxlIiwiVEVBTV9QRVJNSVNTSU9OUyIsImluaXQiLCJlbmNvZGVIZXhMb3dlckNhc2UiLCJtcyIsImdldERCIiwiZXEiLCJjb29raWVzIiwiaXNQcm9kIiwiY3JlYXRlS1ZTZXNzaW9uIiwiZGVsZXRlS1ZTZXNzaW9uIiwiZ2V0S1ZTZXNzaW9uIiwidXBkYXRlS1ZTZXNzaW9uIiwiQ1VSUkVOVF9TRVNTSU9OX1ZFUlNJT04iLCJjYWNoZSIsIlNFU1NJT05fQ09PS0lFX05BTUUiLCJaU0FFcnJvciIsImFkZEZyZWVNb250aGx5Q3JlZGl0c0lmTmVlZGVkIiwiZ2V0SW5pdGlhbHMiLCJnZXRTZXNzaW9uTGVuZ3RoIiwiZ2V0VXNlckZyb21EQiIsInVzZXJJZCIsImRiIiwicXVlcnkiLCJmaW5kRmlyc3QiLCJ3aGVyZSIsImlkIiwiY29sdW1ucyIsImVtYWlsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJyb2xlIiwiZW1haWxWZXJpZmllZCIsImF2YXRhciIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImN1cnJlbnRDcmVkaXRzIiwibGFzdENyZWRpdFJlZnJlc2hBdCIsImNyZWF0ZUlkIiwibGVuZ3RoIiwiZ2VuZXJhdGVTZXNzaW9uVG9rZW4iLCJnZW5lcmF0ZVNlc3Npb25JZCIsInRva2VuIiwiaGFzaEJ1ZmZlciIsImNyeXB0byIsInN1YnRsZSIsImRpZ2VzdCIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwiVWludDhBcnJheSIsImVuY29kZVNlc3Npb25Db29raWUiLCJkZWNvZGVTZXNzaW9uQ29va2llIiwiY29va2llIiwicGFydHMiLCJzcGxpdCIsImdldFVzZXJUZWFtc1dpdGhQZXJtaXNzaW9ucyIsInVzZXJUZWFtTWVtYmVyc2hpcHMiLCJmaW5kTWFueSIsIndpdGgiLCJ0ZWFtIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm1lbWJlcnNoaXAiLCJyb2xlTmFtZSIsInBlcm1pc3Npb25zIiwiaXNTeXN0ZW1Sb2xlIiwicm9sZUlkIiwiT1dORVIiLCJBRE1JTiIsIk9iamVjdCIsInZhbHVlcyIsIk1FTUJFUiIsIkFDQ0VTU19EQVNIQk9BUkQiLCJDUkVBVEVfQ09NUE9ORU5UUyIsIkVESVRfQ09NUE9ORU5UUyIsIkdVRVNUIiwibmFtZSIsInRlYW1JZCIsInNsdWciLCJjcmVhdGVTZXNzaW9uIiwiYXV0aGVudGljYXRpb25UeXBlIiwicGFzc2tleUNyZWRlbnRpYWxJZCIsInNlc3Npb25JZCIsImV4cGlyZXNBdCIsIkRhdGUiLCJub3ciLCJ1c2VyIiwiRXJyb3IiLCJ0ZWFtc1dpdGhQZXJtaXNzaW9ucyIsInRlYW1zIiwiY3JlYXRlQW5kU3RvcmVTZXNzaW9uIiwic2Vzc2lvblRva2VuIiwic2Vzc2lvbiIsInNldFNlc3Npb25Ub2tlbkNvb2tpZSIsInZhbGlkYXRlU2Vzc2lvblRva2VuIiwidmVyc2lvbiIsInVwZGF0ZWRTZXNzaW9uIiwiaW5pdGlhbHMiLCJpbnZhbGlkYXRlU2Vzc2lvbiIsImNvb2tpZVN0b3JlIiwic2V0IiwiaHR0cE9ubHkiLCJzYW1lU2l0ZSIsInNlY3VyZSIsImV4cGlyZXMiLCJwYXRoIiwiZGVsZXRlU2Vzc2lvblRva2VuQ29va2llIiwiZGVsZXRlIiwiZ2V0U2Vzc2lvbkZyb21Db29raWUiLCJzZXNzaW9uQ29va2llIiwiZ2V0IiwidmFsdWUiLCJkZWNvZGVkIiwicmVxdWlyZVZlcmlmaWVkRW1haWwiLCJkb05vdFRocm93RXJyb3IiLCJyZXF1aXJlQWRtaW4iLCJjaGVja1dpdGhEZWJvdW5jZSIsInJlc3BvbnNlIiwiZmV0Y2giLCJlbmNvZGVVUklDb21wb25lbnQiLCJvayIsImNvbnNvbGUiLCJlcnJvciIsInN0YXR1cyIsInN1Y2Nlc3MiLCJpc0Rpc3Bvc2FibGUiLCJkYXRhIiwianNvbiIsImRpc3Bvc2FibGUiLCJjaGVja1dpdGhNYWlsY2hlY2siLCJjYW5TaWduVXAiLCJ2YWxpZGF0b3JzIiwidmFsaWRhdG9yIiwicmVzdWx0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/credits.ts":
/*!******************************!*\
  !*** ./src/utils/credits.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addFreeMonthlyCreditsIfNeeded: () => (/* binding */ addFreeMonthlyCreditsIfNeeded),\n/* harmony export */   consumeCredits: () => (/* binding */ consumeCredits),\n/* harmony export */   getCreditPackage: () => (/* binding */ getCreditPackage),\n/* harmony export */   getCreditTransactions: () => (/* binding */ getCreditTransactions),\n/* harmony export */   getUserPurchasedItems: () => (/* binding */ getUserPurchasedItems),\n/* harmony export */   hasEnoughCredits: () => (/* binding */ hasEnoughCredits),\n/* harmony export */   logTransaction: () => (/* binding */ logTransaction),\n/* harmony export */   updateUserCredits: () => (/* binding */ updateUserCredits)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sql/expressions/select.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3/node_modules/drizzle-orm/sql/sql.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/db */ \"(rsc)/./src/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/db/schema */ \"(rsc)/./src/db/schema.ts\");\n/* harmony import */ var _kv_session__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kv-session */ \"(rsc)/./src/utils/kv-session.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/constants */ \"(rsc)/./src/constants.ts\");\n\n\n\n\n\n\nfunction getCreditPackage(packageId) {\n    return _constants__WEBPACK_IMPORTED_MODULE_4__.CREDIT_PACKAGES.find((pkg)=>pkg.id === packageId);\n}\nfunction shouldRefreshCredits(session, currentTime) {\n    // Check if it's been at least a month since last refresh\n    if (!session.user.lastCreditRefreshAt) {\n        return true;\n    }\n    // Calculate the date exactly one month after the last refresh\n    const oneMonthAfterLastRefresh = new Date(session.user.lastCreditRefreshAt);\n    oneMonthAfterLastRefresh.setMonth(oneMonthAfterLastRefresh.getMonth() + 1);\n    // Only refresh if we've passed the one month mark\n    return currentTime >= oneMonthAfterLastRefresh;\n}\nasync function processExpiredCredits(userId, currentTime) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    // Find all expired transactions that haven't been processed and have remaining credits\n    // Order by type to process MONTHLY_REFRESH first, then by creation date\n    const expiredTransactions = await db.query.creditTransactionTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.lt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDate, currentTime), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.isNull)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDateProcessedAt), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.gt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.remainingAmount, 0)),\n        orderBy: [\n            // Process MONTHLY_REFRESH transactions first\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.desc)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`CASE WHEN ${_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.type} = ${_db_schema__WEBPACK_IMPORTED_MODULE_2__.CREDIT_TRANSACTION_TYPE.MONTHLY_REFRESH} THEN 1 ELSE 0 END`),\n            // Then process by creation date (oldest first)\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.asc)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.createdAt)\n        ]\n    });\n    // Process each expired transaction\n    for (const transaction of expiredTransactions){\n        try {\n            // First, mark the transaction as processed to prevent double processing\n            await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).set({\n                expirationDateProcessedAt: currentTime,\n                remainingAmount: 0\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.id, transaction.id));\n            // Then deduct the expired credits from user's balance\n            await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n                currentCredits: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`${_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.currentCredits} - ${transaction.remainingAmount}`\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n        } catch (error) {\n            console.error(`Failed to process expired credits for transaction ${transaction.id}:`, error);\n            continue;\n        }\n    }\n}\nasync function updateUserCredits(userId, creditsToAdd) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n        currentCredits: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`${_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.currentCredits} + ${creditsToAdd}`\n    }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n    // Update all KV sessions to reflect the new credit balance\n    await (0,_kv_session__WEBPACK_IMPORTED_MODULE_3__.updateAllSessionsOfUser)(userId);\n}\nasync function updateLastRefreshDate(userId, date) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n        lastCreditRefreshAt: date\n    }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n}\nasync function logTransaction({ userId, amount, description, type, expirationDate, paymentIntentId }) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    await db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).values({\n        userId,\n        amount,\n        remainingAmount: amount,\n        type,\n        description,\n        expirationDate,\n        paymentIntentId\n    });\n}\nasync function addFreeMonthlyCreditsIfNeeded(session) {\n    const currentTime = new Date();\n    // Check if it's been at least a month since last refresh\n    if (shouldRefreshCredits(session, currentTime)) {\n        // Double check the last refresh date from the database to prevent race conditions\n        const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n        const user = await db.query.userTable.findFirst({\n            where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, session.userId),\n            columns: {\n                lastCreditRefreshAt: true,\n                currentCredits: true\n            }\n        });\n        // This should prevent race conditions between multiple sessions\n        if (!shouldRefreshCredits({\n            ...session,\n            user: {\n                ...session.user,\n                lastCreditRefreshAt: user?.lastCreditRefreshAt ?? null\n            }\n        }, currentTime)) {\n            return user?.currentCredits ?? 0;\n        }\n        // Process any expired credits first\n        await processExpiredCredits(session.userId, currentTime);\n        // Add free monthly credits with 1 month expiration\n        const expirationDate = new Date(currentTime);\n        expirationDate.setMonth(expirationDate.getMonth() + 1);\n        await updateUserCredits(session.userId, _constants__WEBPACK_IMPORTED_MODULE_4__.FREE_MONTHLY_CREDITS);\n        await logTransaction({\n            userId: session.userId,\n            amount: _constants__WEBPACK_IMPORTED_MODULE_4__.FREE_MONTHLY_CREDITS,\n            description: 'Free monthly credits',\n            type: _db_schema__WEBPACK_IMPORTED_MODULE_2__.CREDIT_TRANSACTION_TYPE.MONTHLY_REFRESH,\n            expirationDate\n        });\n        // Update last refresh date\n        await updateLastRefreshDate(session.userId, currentTime);\n        // Get the updated credit balance from the database\n        const updatedUser = await db.query.userTable.findFirst({\n            where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, session.userId),\n            columns: {\n                currentCredits: true\n            }\n        });\n        return updatedUser?.currentCredits ?? 0;\n    }\n    return session.user.currentCredits;\n}\nasync function hasEnoughCredits({ userId, requiredCredits }) {\n    const user = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)().query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId),\n        columns: {\n            currentCredits: true\n        }\n    });\n    if (!user) return false;\n    return user.currentCredits >= requiredCredits;\n}\nasync function consumeCredits({ userId, amount, description }) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    // First check if user has enough credits\n    const user = await db.query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId),\n        columns: {\n            currentCredits: true\n        }\n    });\n    if (!user || user.currentCredits < amount) {\n        throw new Error(\"Insufficient credits\");\n    }\n    // Get all non-expired transactions with remaining credits, ordered by creation date\n    const activeTransactionsWithBalance = await db.query.creditTransactionTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.gt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.remainingAmount, 0), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.isNull)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDateProcessedAt), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.or)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.isNull)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDate), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.gt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDate, new Date()))),\n        orderBy: [\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.asc)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.createdAt)\n        ]\n    });\n    let remainingToDeduct = amount;\n    // Deduct from each transaction until we've deducted the full amount\n    for (const transaction of activeTransactionsWithBalance){\n        if (remainingToDeduct <= 0) break;\n        const deductFromThis = Math.min(transaction.remainingAmount, remainingToDeduct);\n        await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).set({\n            remainingAmount: transaction.remainingAmount - deductFromThis\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.id, transaction.id));\n        remainingToDeduct -= deductFromThis;\n    }\n    // Update total credits\n    await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n        currentCredits: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`${_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.currentCredits} - ${amount}`\n    }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n    // Log the usage transaction\n    await db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).values({\n        userId,\n        amount: -amount,\n        remainingAmount: 0,\n        type: _db_schema__WEBPACK_IMPORTED_MODULE_2__.CREDIT_TRANSACTION_TYPE.USAGE,\n        description,\n        createdAt: new Date(),\n        updatedAt: new Date()\n    });\n    // Get updated credit balance\n    const updatedUser = await db.query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId),\n        columns: {\n            currentCredits: true\n        }\n    });\n    // Update all KV sessions to reflect the new credit balance\n    await (0,_kv_session__WEBPACK_IMPORTED_MODULE_3__.updateAllSessionsOfUser)(userId);\n    return updatedUser?.currentCredits ?? 0;\n}\nasync function getCreditTransactions({ userId, page = 1, limit = 10 }) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    const transactions = await db.query.creditTransactionTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId),\n        orderBy: [\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.desc)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.createdAt)\n        ],\n        limit,\n        offset: (page - 1) * limit,\n        columns: {\n            expirationDateProcessedAt: false,\n            remainingAmount: false,\n            userId: false\n        }\n    });\n    const total = await db.select({\n        count: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`count(*)`\n    }).from(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId)).then((result)=>result[0].count);\n    return {\n        transactions,\n        pagination: {\n            total,\n            pages: Math.ceil(total / limit),\n            current: page\n        }\n    };\n}\nasync function getUserPurchasedItems(userId) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    const purchasedItems = await db.query.purchasedItemsTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.purchasedItemsTable.userId, userId)\n    });\n    // Create a map of purchased items for easy lookup\n    return new Set(purchasedItems.map((item)=>`${item.itemType}:${item.itemId}`));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvY3JlZGl0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxQjtBQUNxRDtBQUM3QztBQUNpRjtBQUM1QztBQUNFO0FBSTdELFNBQVNpQixpQkFBaUJDLFNBQWlCO0lBQ2hELE9BQU9ILHVEQUFlQSxDQUFDSSxJQUFJLENBQUMsQ0FBQ0MsTUFBUUEsSUFBSUMsRUFBRSxLQUFLSDtBQUNsRDtBQUVBLFNBQVNJLHFCQUFxQkMsT0FBa0IsRUFBRUMsV0FBaUI7SUFDakUseURBQXlEO0lBQ3pELElBQUksQ0FBQ0QsUUFBUUUsSUFBSSxDQUFDQyxtQkFBbUIsRUFBRTtRQUNyQyxPQUFPO0lBQ1Q7SUFFQSw4REFBOEQ7SUFDOUQsTUFBTUMsMkJBQTJCLElBQUlDLEtBQUtMLFFBQVFFLElBQUksQ0FBQ0MsbUJBQW1CO0lBQzFFQyx5QkFBeUJFLFFBQVEsQ0FBQ0YseUJBQXlCRyxRQUFRLEtBQUs7SUFFeEUsa0RBQWtEO0lBQ2xELE9BQU9OLGVBQWVHO0FBQ3hCO0FBRUEsZUFBZUksc0JBQXNCQyxNQUFjLEVBQUVSLFdBQWlCO0lBQ3BFLE1BQU1TLEtBQUt4QiwwQ0FBS0E7SUFDaEIsdUZBQXVGO0lBQ3ZGLHdFQUF3RTtJQUN4RSxNQUFNeUIsc0JBQXNCLE1BQU1ELEdBQUdFLEtBQUssQ0FBQ3hCLHNCQUFzQixDQUFDeUIsUUFBUSxDQUFDO1FBQ3pFQyxPQUFPbEMsZ0RBQUdBLENBQ1JILCtDQUFFQSxDQUFDVyw4REFBc0JBLENBQUNxQixNQUFNLEVBQUVBLFNBQ2xDNUIsK0NBQUVBLENBQUNPLDhEQUFzQkEsQ0FBQzJCLGNBQWMsRUFBRWQsY0FDMUNuQixtREFBTUEsQ0FBQ00sOERBQXNCQSxDQUFDNEIseUJBQXlCLEdBQ3ZEakMsK0NBQUVBLENBQUNLLDhEQUFzQkEsQ0FBQzZCLGVBQWUsRUFBRTtRQUU3Q0MsU0FBUztZQUNQLDZDQUE2QztZQUM3Q3ZDLGlEQUFJQSxDQUFDRCxnREFBRyxDQUFDLFVBQVUsRUFBRVUsOERBQXNCQSxDQUFDK0IsSUFBSSxDQUFDLEdBQUcsRUFBRTlCLCtEQUF1QkEsQ0FBQytCLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQztZQUNqSCwrQ0FBK0M7WUFDL0NuQyxnREFBR0EsQ0FBQ0csOERBQXNCQSxDQUFDaUMsU0FBUztTQUNyQztJQUNIO0lBRUEsbUNBQW1DO0lBQ25DLEtBQUssTUFBTUMsZUFBZVgsb0JBQXFCO1FBQzdDLElBQUk7WUFDRix3RUFBd0U7WUFDeEUsTUFBTUQsR0FDSGEsTUFBTSxDQUFDbkMsOERBQXNCQSxFQUM3Qm9DLEdBQUcsQ0FBQztnQkFDSFIsMkJBQTJCZjtnQkFDM0JnQixpQkFBaUI7WUFDbkIsR0FDQ0gsS0FBSyxDQUFDckMsK0NBQUVBLENBQUNXLDhEQUFzQkEsQ0FBQ1UsRUFBRSxFQUFFd0IsWUFBWXhCLEVBQUU7WUFFckQsc0RBQXNEO1lBQ3RELE1BQU1ZLEdBQ0hhLE1BQU0sQ0FBQ3BDLGlEQUFTQSxFQUNoQnFDLEdBQUcsQ0FBQztnQkFDSEMsZ0JBQWdCL0MsZ0RBQUcsQ0FBQyxFQUFFUyxpREFBU0EsQ0FBQ3NDLGNBQWMsQ0FBQyxHQUFHLEVBQUVILFlBQVlMLGVBQWUsQ0FBQyxDQUFDO1lBQ25GLEdBQ0NILEtBQUssQ0FBQ3JDLCtDQUFFQSxDQUFDVSxpREFBU0EsQ0FBQ1csRUFBRSxFQUFFVztRQUM1QixFQUFFLE9BQU9pQixPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyxDQUFDLGtEQUFrRCxFQUFFSixZQUFZeEIsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFNEI7WUFDdEY7UUFDRjtJQUNGO0FBQ0Y7QUFFTyxlQUFlRSxrQkFBa0JuQixNQUFjLEVBQUVvQixZQUFvQjtJQUMxRSxNQUFNbkIsS0FBS3hCLDBDQUFLQTtJQUNoQixNQUFNd0IsR0FDSGEsTUFBTSxDQUFDcEMsaURBQVNBLEVBQ2hCcUMsR0FBRyxDQUFDO1FBQ0hDLGdCQUFnQi9DLGdEQUFHLENBQUMsRUFBRVMsaURBQVNBLENBQUNzQyxjQUFjLENBQUMsR0FBRyxFQUFFSSxhQUFhLENBQUM7SUFDcEUsR0FDQ2YsS0FBSyxDQUFDckMsK0NBQUVBLENBQUNVLGlEQUFTQSxDQUFDVyxFQUFFLEVBQUVXO0lBRTFCLDJEQUEyRDtJQUMzRCxNQUFNbEIsb0VBQXVCQSxDQUFDa0I7QUFDaEM7QUFFQSxlQUFlcUIsc0JBQXNCckIsTUFBYyxFQUFFc0IsSUFBVTtJQUM3RCxNQUFNckIsS0FBS3hCLDBDQUFLQTtJQUNoQixNQUFNd0IsR0FDSGEsTUFBTSxDQUFDcEMsaURBQVNBLEVBQ2hCcUMsR0FBRyxDQUFDO1FBQ0hyQixxQkFBcUI0QjtJQUN2QixHQUNDakIsS0FBSyxDQUFDckMsK0NBQUVBLENBQUNVLGlEQUFTQSxDQUFDVyxFQUFFLEVBQUVXO0FBQzVCO0FBRU8sZUFBZXVCLGVBQWUsRUFDbkN2QixNQUFNLEVBQ053QixNQUFNLEVBQ05DLFdBQVcsRUFDWGYsSUFBSSxFQUNKSixjQUFjLEVBQ2RvQixlQUFlLEVBUWhCO0lBQ0MsTUFBTXpCLEtBQUt4QiwwQ0FBS0E7SUFDaEIsTUFBTXdCLEdBQUcwQixNQUFNLENBQUNoRCw4REFBc0JBLEVBQUVpRCxNQUFNLENBQUM7UUFDN0M1QjtRQUNBd0I7UUFDQWhCLGlCQUFpQmdCO1FBQ2pCZDtRQUNBZTtRQUNBbkI7UUFDQW9CO0lBQ0Y7QUFDRjtBQUVPLGVBQWVHLDhCQUE4QnRDLE9BQWtCO0lBQ3BFLE1BQU1DLGNBQWMsSUFBSUk7SUFFeEIseURBQXlEO0lBQ3pELElBQUlOLHFCQUFxQkMsU0FBU0MsY0FBYztRQUM5QyxrRkFBa0Y7UUFDbEYsTUFBTVMsS0FBS3hCLDBDQUFLQTtRQUNoQixNQUFNZ0IsT0FBTyxNQUFNUSxHQUFHRSxLQUFLLENBQUN6QixTQUFTLENBQUNvRCxTQUFTLENBQUM7WUFDOUN6QixPQUFPckMsK0NBQUVBLENBQUNVLGlEQUFTQSxDQUFDVyxFQUFFLEVBQUVFLFFBQVFTLE1BQU07WUFDdEMrQixTQUFTO2dCQUNQckMscUJBQXFCO2dCQUNyQnNCLGdCQUFnQjtZQUNsQjtRQUNGO1FBRUEsZ0VBQWdFO1FBQ2hFLElBQUksQ0FBQzFCLHFCQUFxQjtZQUFFLEdBQUdDLE9BQU87WUFBRUUsTUFBTTtnQkFBRSxHQUFHRixRQUFRRSxJQUFJO2dCQUFFQyxxQkFBcUJELE1BQU1DLHVCQUF1QjtZQUFLO1FBQUUsR0FBR0YsY0FBYztZQUN6SSxPQUFPQyxNQUFNdUIsa0JBQWtCO1FBQ2pDO1FBRUEsb0NBQW9DO1FBQ3BDLE1BQU1qQixzQkFBc0JSLFFBQVFTLE1BQU0sRUFBRVI7UUFFNUMsbURBQW1EO1FBQ25ELE1BQU1jLGlCQUFpQixJQUFJVixLQUFLSjtRQUNoQ2MsZUFBZVQsUUFBUSxDQUFDUyxlQUFlUixRQUFRLEtBQUs7UUFFcEQsTUFBTXFCLGtCQUFrQjVCLFFBQVFTLE1BQU0sRUFBRWhCLDREQUFvQkE7UUFDNUQsTUFBTXVDLGVBQWU7WUFDbkJ2QixRQUFRVCxRQUFRUyxNQUFNO1lBQ3RCd0IsUUFBUXhDLDREQUFvQkE7WUFDNUJ5QyxhQUFhO1lBQ2JmLE1BQU05QiwrREFBdUJBLENBQUMrQixlQUFlO1lBQzdDTDtRQUNGO1FBRUEsMkJBQTJCO1FBQzNCLE1BQU1lLHNCQUFzQjlCLFFBQVFTLE1BQU0sRUFBRVI7UUFFNUMsbURBQW1EO1FBQ25ELE1BQU13QyxjQUFjLE1BQU0vQixHQUFHRSxLQUFLLENBQUN6QixTQUFTLENBQUNvRCxTQUFTLENBQUM7WUFDckR6QixPQUFPckMsK0NBQUVBLENBQUNVLGlEQUFTQSxDQUFDVyxFQUFFLEVBQUVFLFFBQVFTLE1BQU07WUFDdEMrQixTQUFTO2dCQUNQZixnQkFBZ0I7WUFDbEI7UUFDRjtRQUVBLE9BQU9nQixhQUFhaEIsa0JBQWtCO0lBQ3hDO0lBRUEsT0FBT3pCLFFBQVFFLElBQUksQ0FBQ3VCLGNBQWM7QUFDcEM7QUFFTyxlQUFlaUIsaUJBQWlCLEVBQUVqQyxNQUFNLEVBQUVrQyxlQUFlLEVBQStDO0lBQzdHLE1BQU16QyxPQUFPLE1BQU1oQiwwQ0FBS0EsR0FBRzBCLEtBQUssQ0FBQ3pCLFNBQVMsQ0FBQ29ELFNBQVMsQ0FBQztRQUNuRHpCLE9BQU9yQywrQ0FBRUEsQ0FBQ1UsaURBQVNBLENBQUNXLEVBQUUsRUFBRVc7UUFDeEIrQixTQUFTO1lBQ1BmLGdCQUFnQjtRQUNsQjtJQUNGO0lBQ0EsSUFBSSxDQUFDdkIsTUFBTSxPQUFPO0lBRWxCLE9BQU9BLEtBQUt1QixjQUFjLElBQUlrQjtBQUNoQztBQUVPLGVBQWVDLGVBQWUsRUFBRW5DLE1BQU0sRUFBRXdCLE1BQU0sRUFBRUMsV0FBVyxFQUEyRDtJQUMzSCxNQUFNeEIsS0FBS3hCLDBDQUFLQTtJQUVoQix5Q0FBeUM7SUFDekMsTUFBTWdCLE9BQU8sTUFBTVEsR0FBR0UsS0FBSyxDQUFDekIsU0FBUyxDQUFDb0QsU0FBUyxDQUFDO1FBQzlDekIsT0FBT3JDLCtDQUFFQSxDQUFDVSxpREFBU0EsQ0FBQ1csRUFBRSxFQUFFVztRQUN4QitCLFNBQVM7WUFDUGYsZ0JBQWdCO1FBQ2xCO0lBQ0Y7SUFFQSxJQUFJLENBQUN2QixRQUFRQSxLQUFLdUIsY0FBYyxHQUFHUSxRQUFRO1FBQ3pDLE1BQU0sSUFBSVksTUFBTTtJQUNsQjtJQUVBLG9GQUFvRjtJQUNwRixNQUFNQyxnQ0FBZ0MsTUFBTXBDLEdBQUdFLEtBQUssQ0FBQ3hCLHNCQUFzQixDQUFDeUIsUUFBUSxDQUFDO1FBQ25GQyxPQUFPbEMsZ0RBQUdBLENBQ1JILCtDQUFFQSxDQUFDVyw4REFBc0JBLENBQUNxQixNQUFNLEVBQUVBLFNBQ2xDMUIsK0NBQUVBLENBQUNLLDhEQUFzQkEsQ0FBQzZCLGVBQWUsRUFBRSxJQUMzQ25DLG1EQUFNQSxDQUFDTSw4REFBc0JBLENBQUM0Qix5QkFBeUIsR0FDdkRoQywrQ0FBRUEsQ0FDQUYsbURBQU1BLENBQUNNLDhEQUFzQkEsQ0FBQzJCLGNBQWMsR0FDNUNoQywrQ0FBRUEsQ0FBQ0ssOERBQXNCQSxDQUFDMkIsY0FBYyxFQUFFLElBQUlWO1FBR2xEYSxTQUFTO1lBQUNqQyxnREFBR0EsQ0FBQ0csOERBQXNCQSxDQUFDaUMsU0FBUztTQUFFO0lBQ2xEO0lBRUEsSUFBSTBCLG9CQUFvQmQ7SUFFeEIsb0VBQW9FO0lBQ3BFLEtBQUssTUFBTVgsZUFBZXdCLDhCQUErQjtRQUN2RCxJQUFJQyxxQkFBcUIsR0FBRztRQUU1QixNQUFNQyxpQkFBaUJDLEtBQUtDLEdBQUcsQ0FBQzVCLFlBQVlMLGVBQWUsRUFBRThCO1FBRTdELE1BQU1yQyxHQUNIYSxNQUFNLENBQUNuQyw4REFBc0JBLEVBQzdCb0MsR0FBRyxDQUFDO1lBQ0hQLGlCQUFpQkssWUFBWUwsZUFBZSxHQUFHK0I7UUFDakQsR0FDQ2xDLEtBQUssQ0FBQ3JDLCtDQUFFQSxDQUFDVyw4REFBc0JBLENBQUNVLEVBQUUsRUFBRXdCLFlBQVl4QixFQUFFO1FBRXJEaUQscUJBQXFCQztJQUN2QjtJQUVBLHVCQUF1QjtJQUN2QixNQUFNdEMsR0FDSGEsTUFBTSxDQUFDcEMsaURBQVNBLEVBQ2hCcUMsR0FBRyxDQUFDO1FBQ0hDLGdCQUFnQi9DLGdEQUFHLENBQUMsRUFBRVMsaURBQVNBLENBQUNzQyxjQUFjLENBQUMsR0FBRyxFQUFFUSxPQUFPLENBQUM7SUFDOUQsR0FDQ25CLEtBQUssQ0FBQ3JDLCtDQUFFQSxDQUFDVSxpREFBU0EsQ0FBQ1csRUFBRSxFQUFFVztJQUUxQiw0QkFBNEI7SUFDNUIsTUFBTUMsR0FBRzBCLE1BQU0sQ0FBQ2hELDhEQUFzQkEsRUFBRWlELE1BQU0sQ0FBQztRQUM3QzVCO1FBQ0F3QixRQUFRLENBQUNBO1FBQ1RoQixpQkFBaUI7UUFDakJFLE1BQU05QiwrREFBdUJBLENBQUM4RCxLQUFLO1FBQ25DakI7UUFDQWIsV0FBVyxJQUFJaEI7UUFDZitDLFdBQVcsSUFBSS9DO0lBQ2pCO0lBRUEsNkJBQTZCO0lBQzdCLE1BQU1vQyxjQUFjLE1BQU0vQixHQUFHRSxLQUFLLENBQUN6QixTQUFTLENBQUNvRCxTQUFTLENBQUM7UUFDckR6QixPQUFPckMsK0NBQUVBLENBQUNVLGlEQUFTQSxDQUFDVyxFQUFFLEVBQUVXO1FBQ3hCK0IsU0FBUztZQUNQZixnQkFBZ0I7UUFDbEI7SUFDRjtJQUVBLDJEQUEyRDtJQUMzRCxNQUFNbEMsb0VBQXVCQSxDQUFDa0I7SUFFOUIsT0FBT2dDLGFBQWFoQixrQkFBa0I7QUFDeEM7QUFFTyxlQUFlNEIsc0JBQXNCLEVBQzFDNUMsTUFBTSxFQUNONkMsT0FBTyxDQUFDLEVBQ1JDLFFBQVEsRUFBRSxFQUtYO0lBQ0MsTUFBTTdDLEtBQUt4QiwwQ0FBS0E7SUFDaEIsTUFBTXNFLGVBQWUsTUFBTTlDLEdBQUdFLEtBQUssQ0FBQ3hCLHNCQUFzQixDQUFDeUIsUUFBUSxDQUFDO1FBQ2xFQyxPQUFPckMsK0NBQUVBLENBQUNXLDhEQUFzQkEsQ0FBQ3FCLE1BQU0sRUFBRUE7UUFDekNTLFNBQVM7WUFBQ3ZDLGlEQUFJQSxDQUFDUyw4REFBc0JBLENBQUNpQyxTQUFTO1NBQUU7UUFDakRrQztRQUNBRSxRQUFRLENBQUNILE9BQU8sS0FBS0M7UUFDckJmLFNBQVM7WUFDUHhCLDJCQUEyQjtZQUMzQkMsaUJBQWlCO1lBQ2pCUixRQUFRO1FBQ1Y7SUFDRjtJQUVBLE1BQU1pRCxRQUFRLE1BQU1oRCxHQUNqQmlELE1BQU0sQ0FBQztRQUFFQyxPQUFPbEYsZ0RBQVcsQ0FBQyxRQUFRLENBQUM7SUFBQyxHQUN0Q21GLElBQUksQ0FBQ3pFLDhEQUFzQkEsRUFDM0IwQixLQUFLLENBQUNyQywrQ0FBRUEsQ0FBQ1csOERBQXNCQSxDQUFDcUIsTUFBTSxFQUFFQSxTQUN4Q3FELElBQUksQ0FBQyxDQUFDQyxTQUFXQSxNQUFNLENBQUMsRUFBRSxDQUFDSCxLQUFLO0lBRW5DLE9BQU87UUFDTEo7UUFDQVEsWUFBWTtZQUNWTjtZQUNBTyxPQUFPaEIsS0FBS2lCLElBQUksQ0FBQ1IsUUFBUUg7WUFDekJZLFNBQVNiO1FBQ1g7SUFDRjtBQUNGO0FBRU8sZUFBZWMsc0JBQXNCM0QsTUFBYztJQUN4RCxNQUFNQyxLQUFLeEIsMENBQUtBO0lBQ2hCLE1BQU1tRixpQkFBaUIsTUFBTTNELEdBQUdFLEtBQUssQ0FBQ3RCLG1CQUFtQixDQUFDdUIsUUFBUSxDQUFDO1FBQ2pFQyxPQUFPckMsK0NBQUVBLENBQUNhLDJEQUFtQkEsQ0FBQ21CLE1BQU0sRUFBRUE7SUFDeEM7SUFFQSxrREFBa0Q7SUFDbEQsT0FBTyxJQUFJNkQsSUFDVEQsZUFBZUUsR0FBRyxDQUFDQyxDQUFBQSxPQUFRLEdBQUdBLEtBQUtDLFFBQVEsQ0FBQyxDQUFDLEVBQUVELEtBQUtFLE1BQU0sRUFBRTtBQUVoRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pblxcRGVza3RvcFxcRmluYWxQcm9qZWN0XFxzcmNcXHV0aWxzXFxjcmVkaXRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcInNlcnZlci1vbmx5XCI7XHJcbmltcG9ydCB7IGVxLCBzcWwsIGRlc2MsIGFuZCwgbHQsIGlzTnVsbCwgZ3QsIG9yLCBhc2MgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcclxuaW1wb3J0IHsgZ2V0REIgfSBmcm9tIFwiQC9kYlwiO1xyXG5pbXBvcnQgeyB1c2VyVGFibGUsIGNyZWRpdFRyYW5zYWN0aW9uVGFibGUsIENSRURJVF9UUkFOU0FDVElPTl9UWVBFLCBwdXJjaGFzZWRJdGVtc1RhYmxlIH0gZnJvbSBcIkAvZGIvc2NoZW1hXCI7XHJcbmltcG9ydCB7IHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyLCBLVlNlc3Npb24gfSBmcm9tIFwiLi9rdi1zZXNzaW9uXCI7XHJcbmltcG9ydCB7IENSRURJVF9QQUNLQUdFUywgRlJFRV9NT05USExZX0NSRURJVFMgfSBmcm9tIFwiQC9jb25zdGFudHNcIjtcclxuXHJcbmV4cG9ydCB0eXBlIENyZWRpdFBhY2thZ2UgPSB0eXBlb2YgQ1JFRElUX1BBQ0tBR0VTW251bWJlcl07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3JlZGl0UGFja2FnZShwYWNrYWdlSWQ6IHN0cmluZyk6IENyZWRpdFBhY2thZ2UgfCB1bmRlZmluZWQge1xyXG4gIHJldHVybiBDUkVESVRfUEFDS0FHRVMuZmluZCgocGtnKSA9PiBwa2cuaWQgPT09IHBhY2thZ2VJZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3VsZFJlZnJlc2hDcmVkaXRzKHNlc3Npb246IEtWU2Vzc2lvbiwgY3VycmVudFRpbWU6IERhdGUpOiBib29sZWFuIHtcclxuICAvLyBDaGVjayBpZiBpdCdzIGJlZW4gYXQgbGVhc3QgYSBtb250aCBzaW5jZSBsYXN0IHJlZnJlc2hcclxuICBpZiAoIXNlc3Npb24udXNlci5sYXN0Q3JlZGl0UmVmcmVzaEF0KSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vIENhbGN1bGF0ZSB0aGUgZGF0ZSBleGFjdGx5IG9uZSBtb250aCBhZnRlciB0aGUgbGFzdCByZWZyZXNoXHJcbiAgY29uc3Qgb25lTW9udGhBZnRlckxhc3RSZWZyZXNoID0gbmV3IERhdGUoc2Vzc2lvbi51c2VyLmxhc3RDcmVkaXRSZWZyZXNoQXQpO1xyXG4gIG9uZU1vbnRoQWZ0ZXJMYXN0UmVmcmVzaC5zZXRNb250aChvbmVNb250aEFmdGVyTGFzdFJlZnJlc2guZ2V0TW9udGgoKSArIDEpO1xyXG5cclxuICAvLyBPbmx5IHJlZnJlc2ggaWYgd2UndmUgcGFzc2VkIHRoZSBvbmUgbW9udGggbWFya1xyXG4gIHJldHVybiBjdXJyZW50VGltZSA+PSBvbmVNb250aEFmdGVyTGFzdFJlZnJlc2g7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NFeHBpcmVkQ3JlZGl0cyh1c2VySWQ6IHN0cmluZywgY3VycmVudFRpbWU6IERhdGUpIHtcclxuICBjb25zdCBkYiA9IGdldERCKCk7XHJcbiAgLy8gRmluZCBhbGwgZXhwaXJlZCB0cmFuc2FjdGlvbnMgdGhhdCBoYXZlbid0IGJlZW4gcHJvY2Vzc2VkIGFuZCBoYXZlIHJlbWFpbmluZyBjcmVkaXRzXHJcbiAgLy8gT3JkZXIgYnkgdHlwZSB0byBwcm9jZXNzIE1PTlRITFlfUkVGUkVTSCBmaXJzdCwgdGhlbiBieSBjcmVhdGlvbiBkYXRlXHJcbiAgY29uc3QgZXhwaXJlZFRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLnF1ZXJ5LmNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZmluZE1hbnkoe1xyXG4gICAgd2hlcmU6IGFuZChcclxuICAgICAgZXEoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS51c2VySWQsIHVzZXJJZCksXHJcbiAgICAgIGx0KGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZXhwaXJhdGlvbkRhdGUsIGN1cnJlbnRUaW1lKSxcclxuICAgICAgaXNOdWxsKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdCksXHJcbiAgICAgIGd0KGNyZWRpdFRyYW5zYWN0aW9uVGFibGUucmVtYWluaW5nQW1vdW50LCAwKSxcclxuICAgICksXHJcbiAgICBvcmRlckJ5OiBbXHJcbiAgICAgIC8vIFByb2Nlc3MgTU9OVEhMWV9SRUZSRVNIIHRyYW5zYWN0aW9ucyBmaXJzdFxyXG4gICAgICBkZXNjKHNxbGBDQVNFIFdIRU4gJHtjcmVkaXRUcmFuc2FjdGlvblRhYmxlLnR5cGV9ID0gJHtDUkVESVRfVFJBTlNBQ1RJT05fVFlQRS5NT05USExZX1JFRlJFU0h9IFRIRU4gMSBFTFNFIDAgRU5EYCksXHJcbiAgICAgIC8vIFRoZW4gcHJvY2VzcyBieSBjcmVhdGlvbiBkYXRlIChvbGRlc3QgZmlyc3QpXHJcbiAgICAgIGFzYyhjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmNyZWF0ZWRBdCksXHJcbiAgICBdLFxyXG4gIH0pO1xyXG5cclxuICAvLyBQcm9jZXNzIGVhY2ggZXhwaXJlZCB0cmFuc2FjdGlvblxyXG4gIGZvciAoY29uc3QgdHJhbnNhY3Rpb24gb2YgZXhwaXJlZFRyYW5zYWN0aW9ucykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gRmlyc3QsIG1hcmsgdGhlIHRyYW5zYWN0aW9uIGFzIHByb2Nlc3NlZCB0byBwcmV2ZW50IGRvdWJsZSBwcm9jZXNzaW5nXHJcbiAgICAgIGF3YWl0IGRiXHJcbiAgICAgICAgLnVwZGF0ZShjcmVkaXRUcmFuc2FjdGlvblRhYmxlKVxyXG4gICAgICAgIC5zZXQoe1xyXG4gICAgICAgICAgZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdDogY3VycmVudFRpbWUsXHJcbiAgICAgICAgICByZW1haW5pbmdBbW91bnQ6IDAsIC8vIEFsbCByZW1haW5pbmcgY3JlZGl0cyBhcmUgZXhwaXJlZFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLndoZXJlKGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuaWQsIHRyYW5zYWN0aW9uLmlkKSk7XHJcblxyXG4gICAgICAvLyBUaGVuIGRlZHVjdCB0aGUgZXhwaXJlZCBjcmVkaXRzIGZyb20gdXNlcidzIGJhbGFuY2VcclxuICAgICAgYXdhaXQgZGJcclxuICAgICAgICAudXBkYXRlKHVzZXJUYWJsZSlcclxuICAgICAgICAuc2V0KHtcclxuICAgICAgICAgIGN1cnJlbnRDcmVkaXRzOiBzcWxgJHt1c2VyVGFibGUuY3VycmVudENyZWRpdHN9IC0gJHt0cmFuc2FjdGlvbi5yZW1haW5pbmdBbW91bnR9YCxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC53aGVyZShlcSh1c2VyVGFibGUuaWQsIHVzZXJJZCkpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHByb2Nlc3MgZXhwaXJlZCBjcmVkaXRzIGZvciB0cmFuc2FjdGlvbiAke3RyYW5zYWN0aW9uLmlkfTpgLCBlcnJvcik7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVVzZXJDcmVkaXRzKHVzZXJJZDogc3RyaW5nLCBjcmVkaXRzVG9BZGQ6IG51bWJlcikge1xyXG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcclxuICBhd2FpdCBkYlxyXG4gICAgLnVwZGF0ZSh1c2VyVGFibGUpXHJcbiAgICAuc2V0KHtcclxuICAgICAgY3VycmVudENyZWRpdHM6IHNxbGAke3VzZXJUYWJsZS5jdXJyZW50Q3JlZGl0c30gKyAke2NyZWRpdHNUb0FkZH1gLFxyXG4gICAgfSlcclxuICAgIC53aGVyZShlcSh1c2VyVGFibGUuaWQsIHVzZXJJZCkpO1xyXG5cclxuICAvLyBVcGRhdGUgYWxsIEtWIHNlc3Npb25zIHRvIHJlZmxlY3QgdGhlIG5ldyBjcmVkaXQgYmFsYW5jZVxyXG4gIGF3YWl0IHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyKHVzZXJJZCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUxhc3RSZWZyZXNoRGF0ZSh1c2VySWQ6IHN0cmluZywgZGF0ZTogRGF0ZSkge1xyXG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcclxuICBhd2FpdCBkYlxyXG4gICAgLnVwZGF0ZSh1c2VyVGFibGUpXHJcbiAgICAuc2V0KHtcclxuICAgICAgbGFzdENyZWRpdFJlZnJlc2hBdDogZGF0ZSxcclxuICAgIH0pXHJcbiAgICAud2hlcmUoZXEodXNlclRhYmxlLmlkLCB1c2VySWQpKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1RyYW5zYWN0aW9uKHtcclxuICB1c2VySWQsXHJcbiAgYW1vdW50LFxyXG4gIGRlc2NyaXB0aW9uLFxyXG4gIHR5cGUsXHJcbiAgZXhwaXJhdGlvbkRhdGUsXHJcbiAgcGF5bWVudEludGVudElkXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBhbW91bnQ6IG51bWJlcjtcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIHR5cGU6IGtleW9mIHR5cGVvZiBDUkVESVRfVFJBTlNBQ1RJT05fVFlQRTtcclxuICBleHBpcmF0aW9uRGF0ZT86IERhdGU7XHJcbiAgcGF5bWVudEludGVudElkPzogc3RyaW5nO1xyXG59KSB7XHJcbiAgY29uc3QgZGIgPSBnZXREQigpO1xyXG4gIGF3YWl0IGRiLmluc2VydChjcmVkaXRUcmFuc2FjdGlvblRhYmxlKS52YWx1ZXMoe1xyXG4gICAgdXNlcklkLFxyXG4gICAgYW1vdW50LFxyXG4gICAgcmVtYWluaW5nQW1vdW50OiBhbW91bnQsIC8vIEluaXRpYWxpemUgcmVtYWluaW5nIGFtb3VudCB0byBiZSB0aGUgc2FtZSBhcyBhbW91bnRcclxuICAgIHR5cGUsXHJcbiAgICBkZXNjcmlwdGlvbixcclxuICAgIGV4cGlyYXRpb25EYXRlLFxyXG4gICAgcGF5bWVudEludGVudElkXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRGcmVlTW9udGhseUNyZWRpdHNJZk5lZWRlZChzZXNzaW9uOiBLVlNlc3Npb24pOiBQcm9taXNlPG51bWJlcj4ge1xyXG4gIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKTtcclxuXHJcbiAgLy8gQ2hlY2sgaWYgaXQncyBiZWVuIGF0IGxlYXN0IGEgbW9udGggc2luY2UgbGFzdCByZWZyZXNoXHJcbiAgaWYgKHNob3VsZFJlZnJlc2hDcmVkaXRzKHNlc3Npb24sIGN1cnJlbnRUaW1lKSkge1xyXG4gICAgLy8gRG91YmxlIGNoZWNrIHRoZSBsYXN0IHJlZnJlc2ggZGF0ZSBmcm9tIHRoZSBkYXRhYmFzZSB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xyXG4gICAgY29uc3QgZGIgPSBnZXREQigpO1xyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnF1ZXJ5LnVzZXJUYWJsZS5maW5kRmlyc3Qoe1xyXG4gICAgICB3aGVyZTogZXEodXNlclRhYmxlLmlkLCBzZXNzaW9uLnVzZXJJZCksXHJcbiAgICAgIGNvbHVtbnM6IHtcclxuICAgICAgICBsYXN0Q3JlZGl0UmVmcmVzaEF0OiB0cnVlLFxyXG4gICAgICAgIGN1cnJlbnRDcmVkaXRzOiB0cnVlLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gVGhpcyBzaG91bGQgcHJldmVudCByYWNlIGNvbmRpdGlvbnMgYmV0d2VlbiBtdWx0aXBsZSBzZXNzaW9uc1xyXG4gICAgaWYgKCFzaG91bGRSZWZyZXNoQ3JlZGl0cyh7IC4uLnNlc3Npb24sIHVzZXI6IHsgLi4uc2Vzc2lvbi51c2VyLCBsYXN0Q3JlZGl0UmVmcmVzaEF0OiB1c2VyPy5sYXN0Q3JlZGl0UmVmcmVzaEF0ID8/IG51bGwgfSB9LCBjdXJyZW50VGltZSkpIHtcclxuICAgICAgcmV0dXJuIHVzZXI/LmN1cnJlbnRDcmVkaXRzID8/IDA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHJvY2VzcyBhbnkgZXhwaXJlZCBjcmVkaXRzIGZpcnN0XHJcbiAgICBhd2FpdCBwcm9jZXNzRXhwaXJlZENyZWRpdHMoc2Vzc2lvbi51c2VySWQsIGN1cnJlbnRUaW1lKTtcclxuXHJcbiAgICAvLyBBZGQgZnJlZSBtb250aGx5IGNyZWRpdHMgd2l0aCAxIG1vbnRoIGV4cGlyYXRpb25cclxuICAgIGNvbnN0IGV4cGlyYXRpb25EYXRlID0gbmV3IERhdGUoY3VycmVudFRpbWUpO1xyXG4gICAgZXhwaXJhdGlvbkRhdGUuc2V0TW9udGgoZXhwaXJhdGlvbkRhdGUuZ2V0TW9udGgoKSArIDEpO1xyXG5cclxuICAgIGF3YWl0IHVwZGF0ZVVzZXJDcmVkaXRzKHNlc3Npb24udXNlcklkLCBGUkVFX01PTlRITFlfQ1JFRElUUyk7XHJcbiAgICBhd2FpdCBsb2dUcmFuc2FjdGlvbih7XHJcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VySWQsXHJcbiAgICAgIGFtb3VudDogRlJFRV9NT05USExZX0NSRURJVFMsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiAnRnJlZSBtb250aGx5IGNyZWRpdHMnLFxyXG4gICAgICB0eXBlOiBDUkVESVRfVFJBTlNBQ1RJT05fVFlQRS5NT05USExZX1JFRlJFU0gsXHJcbiAgICAgIGV4cGlyYXRpb25EYXRlXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBVcGRhdGUgbGFzdCByZWZyZXNoIGRhdGVcclxuICAgIGF3YWl0IHVwZGF0ZUxhc3RSZWZyZXNoRGF0ZShzZXNzaW9uLnVzZXJJZCwgY3VycmVudFRpbWUpO1xyXG5cclxuICAgIC8vIEdldCB0aGUgdXBkYXRlZCBjcmVkaXQgYmFsYW5jZSBmcm9tIHRoZSBkYXRhYmFzZVxyXG4gICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBkYi5xdWVyeS51c2VyVGFibGUuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IGVxKHVzZXJUYWJsZS5pZCwgc2Vzc2lvbi51c2VySWQpLFxyXG4gICAgICBjb2x1bW5zOiB7XHJcbiAgICAgICAgY3VycmVudENyZWRpdHM6IHRydWUsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdXBkYXRlZFVzZXI/LmN1cnJlbnRDcmVkaXRzID8/IDA7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gc2Vzc2lvbi51c2VyLmN1cnJlbnRDcmVkaXRzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzRW5vdWdoQ3JlZGl0cyh7IHVzZXJJZCwgcmVxdWlyZWRDcmVkaXRzIH06IHsgdXNlcklkOiBzdHJpbmc7IHJlcXVpcmVkQ3JlZGl0czogbnVtYmVyIH0pIHtcclxuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0REIoKS5xdWVyeS51c2VyVGFibGUuZmluZEZpcnN0KHtcclxuICAgIHdoZXJlOiBlcSh1c2VyVGFibGUuaWQsIHVzZXJJZCksXHJcbiAgICBjb2x1bW5zOiB7XHJcbiAgICAgIGN1cnJlbnRDcmVkaXRzOiB0cnVlLFxyXG4gICAgfVxyXG4gIH0pO1xyXG4gIGlmICghdXNlcikgcmV0dXJuIGZhbHNlO1xyXG5cclxuICByZXR1cm4gdXNlci5jdXJyZW50Q3JlZGl0cyA+PSByZXF1aXJlZENyZWRpdHM7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25zdW1lQ3JlZGl0cyh7IHVzZXJJZCwgYW1vdW50LCBkZXNjcmlwdGlvbiB9OiB7IHVzZXJJZDogc3RyaW5nOyBhbW91bnQ6IG51bWJlcjsgZGVzY3JpcHRpb246IHN0cmluZyB9KSB7XHJcbiAgY29uc3QgZGIgPSBnZXREQigpO1xyXG5cclxuICAvLyBGaXJzdCBjaGVjayBpZiB1c2VyIGhhcyBlbm91Z2ggY3JlZGl0c1xyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBkYi5xdWVyeS51c2VyVGFibGUuZmluZEZpcnN0KHtcclxuICAgIHdoZXJlOiBlcSh1c2VyVGFibGUuaWQsIHVzZXJJZCksXHJcbiAgICBjb2x1bW5zOiB7XHJcbiAgICAgIGN1cnJlbnRDcmVkaXRzOiB0cnVlLFxyXG4gICAgfSxcclxuICB9KTtcclxuXHJcbiAgaWYgKCF1c2VyIHx8IHVzZXIuY3VycmVudENyZWRpdHMgPCBhbW91bnQpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkluc3VmZmljaWVudCBjcmVkaXRzXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IGFsbCBub24tZXhwaXJlZCB0cmFuc2FjdGlvbnMgd2l0aCByZW1haW5pbmcgY3JlZGl0cywgb3JkZXJlZCBieSBjcmVhdGlvbiBkYXRlXHJcbiAgY29uc3QgYWN0aXZlVHJhbnNhY3Rpb25zV2l0aEJhbGFuY2UgPSBhd2FpdCBkYi5xdWVyeS5jcmVkaXRUcmFuc2FjdGlvblRhYmxlLmZpbmRNYW55KHtcclxuICAgIHdoZXJlOiBhbmQoXHJcbiAgICAgIGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUudXNlcklkLCB1c2VySWQpLFxyXG4gICAgICBndChjcmVkaXRUcmFuc2FjdGlvblRhYmxlLnJlbWFpbmluZ0Ftb3VudCwgMCksXHJcbiAgICAgIGlzTnVsbChjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmV4cGlyYXRpb25EYXRlUHJvY2Vzc2VkQXQpLFxyXG4gICAgICBvcihcclxuICAgICAgICBpc051bGwoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5leHBpcmF0aW9uRGF0ZSksXHJcbiAgICAgICAgZ3QoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5leHBpcmF0aW9uRGF0ZSwgbmV3IERhdGUoKSlcclxuICAgICAgKVxyXG4gICAgKSxcclxuICAgIG9yZGVyQnk6IFthc2MoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5jcmVhdGVkQXQpXSxcclxuICB9KTtcclxuXHJcbiAgbGV0IHJlbWFpbmluZ1RvRGVkdWN0ID0gYW1vdW50O1xyXG5cclxuICAvLyBEZWR1Y3QgZnJvbSBlYWNoIHRyYW5zYWN0aW9uIHVudGlsIHdlJ3ZlIGRlZHVjdGVkIHRoZSBmdWxsIGFtb3VudFxyXG4gIGZvciAoY29uc3QgdHJhbnNhY3Rpb24gb2YgYWN0aXZlVHJhbnNhY3Rpb25zV2l0aEJhbGFuY2UpIHtcclxuICAgIGlmIChyZW1haW5pbmdUb0RlZHVjdCA8PSAwKSBicmVhaztcclxuXHJcbiAgICBjb25zdCBkZWR1Y3RGcm9tVGhpcyA9IE1hdGgubWluKHRyYW5zYWN0aW9uLnJlbWFpbmluZ0Ftb3VudCwgcmVtYWluaW5nVG9EZWR1Y3QpO1xyXG5cclxuICAgIGF3YWl0IGRiXHJcbiAgICAgIC51cGRhdGUoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSlcclxuICAgICAgLnNldCh7XHJcbiAgICAgICAgcmVtYWluaW5nQW1vdW50OiB0cmFuc2FjdGlvbi5yZW1haW5pbmdBbW91bnQgLSBkZWR1Y3RGcm9tVGhpcyxcclxuICAgICAgfSlcclxuICAgICAgLndoZXJlKGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuaWQsIHRyYW5zYWN0aW9uLmlkKSk7XHJcblxyXG4gICAgcmVtYWluaW5nVG9EZWR1Y3QgLT0gZGVkdWN0RnJvbVRoaXM7XHJcbiAgfVxyXG5cclxuICAvLyBVcGRhdGUgdG90YWwgY3JlZGl0c1xyXG4gIGF3YWl0IGRiXHJcbiAgICAudXBkYXRlKHVzZXJUYWJsZSlcclxuICAgIC5zZXQoe1xyXG4gICAgICBjdXJyZW50Q3JlZGl0czogc3FsYCR7dXNlclRhYmxlLmN1cnJlbnRDcmVkaXRzfSAtICR7YW1vdW50fWAsXHJcbiAgICB9KVxyXG4gICAgLndoZXJlKGVxKHVzZXJUYWJsZS5pZCwgdXNlcklkKSk7XHJcblxyXG4gIC8vIExvZyB0aGUgdXNhZ2UgdHJhbnNhY3Rpb25cclxuICBhd2FpdCBkYi5pbnNlcnQoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSkudmFsdWVzKHtcclxuICAgIHVzZXJJZCxcclxuICAgIGFtb3VudDogLWFtb3VudCxcclxuICAgIHJlbWFpbmluZ0Ftb3VudDogMCwgLy8gVXNhZ2UgdHJhbnNhY3Rpb25zIGRvbid0IGhhdmUgcmVtYWluaW5nIGFtb3VudFxyXG4gICAgdHlwZTogQ1JFRElUX1RSQU5TQUNUSU9OX1RZUEUuVVNBR0UsXHJcbiAgICBkZXNjcmlwdGlvbixcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcclxuICB9KTtcclxuXHJcbiAgLy8gR2V0IHVwZGF0ZWQgY3JlZGl0IGJhbGFuY2VcclxuICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGRiLnF1ZXJ5LnVzZXJUYWJsZS5maW5kRmlyc3Qoe1xyXG4gICAgd2hlcmU6IGVxKHVzZXJUYWJsZS5pZCwgdXNlcklkKSxcclxuICAgIGNvbHVtbnM6IHtcclxuICAgICAgY3VycmVudENyZWRpdHM6IHRydWUsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICAvLyBVcGRhdGUgYWxsIEtWIHNlc3Npb25zIHRvIHJlZmxlY3QgdGhlIG5ldyBjcmVkaXQgYmFsYW5jZVxyXG4gIGF3YWl0IHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyKHVzZXJJZCk7XHJcblxyXG4gIHJldHVybiB1cGRhdGVkVXNlcj8uY3VycmVudENyZWRpdHMgPz8gMDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENyZWRpdFRyYW5zYWN0aW9ucyh7XHJcbiAgdXNlcklkLFxyXG4gIHBhZ2UgPSAxLFxyXG4gIGxpbWl0ID0gMTBcclxufToge1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG4gIHBhZ2U/OiBudW1iZXI7XHJcbiAgbGltaXQ/OiBudW1iZXI7XHJcbn0pIHtcclxuICBjb25zdCBkYiA9IGdldERCKCk7XHJcbiAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIucXVlcnkuY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5maW5kTWFueSh7XHJcbiAgICB3aGVyZTogZXEoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS51c2VySWQsIHVzZXJJZCksXHJcbiAgICBvcmRlckJ5OiBbZGVzYyhjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmNyZWF0ZWRBdCldLFxyXG4gICAgbGltaXQsXHJcbiAgICBvZmZzZXQ6IChwYWdlIC0gMSkgKiBsaW1pdCxcclxuICAgIGNvbHVtbnM6IHtcclxuICAgICAgZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdDogZmFsc2UsXHJcbiAgICAgIHJlbWFpbmluZ0Ftb3VudDogZmFsc2UsXHJcbiAgICAgIHVzZXJJZDogZmFsc2UsXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHRvdGFsID0gYXdhaXQgZGJcclxuICAgIC5zZWxlY3QoeyBjb3VudDogc3FsPG51bWJlcj5gY291bnQoKilgIH0pXHJcbiAgICAuZnJvbShjcmVkaXRUcmFuc2FjdGlvblRhYmxlKVxyXG4gICAgLndoZXJlKGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUudXNlcklkLCB1c2VySWQpKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4gcmVzdWx0WzBdLmNvdW50KTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHRyYW5zYWN0aW9ucyxcclxuICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgdG90YWwsXHJcbiAgICAgIHBhZ2VzOiBNYXRoLmNlaWwodG90YWwgLyBsaW1pdCksXHJcbiAgICAgIGN1cnJlbnQ6IHBhZ2UsXHJcbiAgICB9LFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyUHVyY2hhc2VkSXRlbXModXNlcklkOiBzdHJpbmcpIHtcclxuICBjb25zdCBkYiA9IGdldERCKCk7XHJcbiAgY29uc3QgcHVyY2hhc2VkSXRlbXMgPSBhd2FpdCBkYi5xdWVyeS5wdXJjaGFzZWRJdGVtc1RhYmxlLmZpbmRNYW55KHtcclxuICAgIHdoZXJlOiBlcShwdXJjaGFzZWRJdGVtc1RhYmxlLnVzZXJJZCwgdXNlcklkKSxcclxuICB9KTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgbWFwIG9mIHB1cmNoYXNlZCBpdGVtcyBmb3IgZWFzeSBsb29rdXBcclxuICByZXR1cm4gbmV3IFNldChcclxuICAgIHB1cmNoYXNlZEl0ZW1zLm1hcChpdGVtID0+IGAke2l0ZW0uaXRlbVR5cGV9OiR7aXRlbS5pdGVtSWR9YClcclxuICApO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJlcSIsInNxbCIsImRlc2MiLCJhbmQiLCJsdCIsImlzTnVsbCIsImd0Iiwib3IiLCJhc2MiLCJnZXREQiIsInVzZXJUYWJsZSIsImNyZWRpdFRyYW5zYWN0aW9uVGFibGUiLCJDUkVESVRfVFJBTlNBQ1RJT05fVFlQRSIsInB1cmNoYXNlZEl0ZW1zVGFibGUiLCJ1cGRhdGVBbGxTZXNzaW9uc09mVXNlciIsIkNSRURJVF9QQUNLQUdFUyIsIkZSRUVfTU9OVEhMWV9DUkVESVRTIiwiZ2V0Q3JlZGl0UGFja2FnZSIsInBhY2thZ2VJZCIsImZpbmQiLCJwa2ciLCJpZCIsInNob3VsZFJlZnJlc2hDcmVkaXRzIiwic2Vzc2lvbiIsImN1cnJlbnRUaW1lIiwidXNlciIsImxhc3RDcmVkaXRSZWZyZXNoQXQiLCJvbmVNb250aEFmdGVyTGFzdFJlZnJlc2giLCJEYXRlIiwic2V0TW9udGgiLCJnZXRNb250aCIsInByb2Nlc3NFeHBpcmVkQ3JlZGl0cyIsInVzZXJJZCIsImRiIiwiZXhwaXJlZFRyYW5zYWN0aW9ucyIsInF1ZXJ5IiwiZmluZE1hbnkiLCJ3aGVyZSIsImV4cGlyYXRpb25EYXRlIiwiZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdCIsInJlbWFpbmluZ0Ftb3VudCIsIm9yZGVyQnkiLCJ0eXBlIiwiTU9OVEhMWV9SRUZSRVNIIiwiY3JlYXRlZEF0IiwidHJhbnNhY3Rpb24iLCJ1cGRhdGUiLCJzZXQiLCJjdXJyZW50Q3JlZGl0cyIsImVycm9yIiwiY29uc29sZSIsInVwZGF0ZVVzZXJDcmVkaXRzIiwiY3JlZGl0c1RvQWRkIiwidXBkYXRlTGFzdFJlZnJlc2hEYXRlIiwiZGF0ZSIsImxvZ1RyYW5zYWN0aW9uIiwiYW1vdW50IiwiZGVzY3JpcHRpb24iLCJwYXltZW50SW50ZW50SWQiLCJpbnNlcnQiLCJ2YWx1ZXMiLCJhZGRGcmVlTW9udGhseUNyZWRpdHNJZk5lZWRlZCIsImZpbmRGaXJzdCIsImNvbHVtbnMiLCJ1cGRhdGVkVXNlciIsImhhc0Vub3VnaENyZWRpdHMiLCJyZXF1aXJlZENyZWRpdHMiLCJjb25zdW1lQ3JlZGl0cyIsIkVycm9yIiwiYWN0aXZlVHJhbnNhY3Rpb25zV2l0aEJhbGFuY2UiLCJyZW1haW5pbmdUb0RlZHVjdCIsImRlZHVjdEZyb21UaGlzIiwiTWF0aCIsIm1pbiIsIlVTQUdFIiwidXBkYXRlZEF0IiwiZ2V0Q3JlZGl0VHJhbnNhY3Rpb25zIiwicGFnZSIsImxpbWl0IiwidHJhbnNhY3Rpb25zIiwib2Zmc2V0IiwidG90YWwiLCJzZWxlY3QiLCJjb3VudCIsImZyb20iLCJ0aGVuIiwicmVzdWx0IiwicGFnaW5hdGlvbiIsInBhZ2VzIiwiY2VpbCIsImN1cnJlbnQiLCJnZXRVc2VyUHVyY2hhc2VkSXRlbXMiLCJwdXJjaGFzZWRJdGVtcyIsIlNldCIsIm1hcCIsIml0ZW0iLCJpdGVtVHlwZSIsIml0ZW1JZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/credits.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/get-IP.ts":
/*!*****************************!*\
  !*** ./src/utils/get-IP.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getIP: () => (/* binding */ getIP)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/api/headers.js\");\n\n\nasync function getIP() {\n    const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.headers)();\n    const ip = headersList.get('cf-connecting-ip') || headersList.get('x-forwarded-for') || headersList.get('x-real-ip') || headersList.get('true-client-ip') || headersList.get('x-client-ip') || headersList.get('x-cluster-client-ip') || null;\n    if (!ip) {\n        return null;\n    }\n    return ip;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvZ2V0LUlQLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBcUI7QUFFa0I7QUFFaEMsZUFBZUM7SUFDcEIsTUFBTUMsY0FBYyxNQUFNRixxREFBT0E7SUFFakMsTUFBTUcsS0FBS0QsWUFBWUUsR0FBRyxDQUFDLHVCQUN0QkYsWUFBWUUsR0FBRyxDQUFDLHNCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLGdCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLHFCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLGtCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLDBCQUNoQjtJQUVMLElBQUksQ0FBQ0QsSUFBSTtRQUNQLE9BQU87SUFDVDtJQUVBLE9BQU9BO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW5cXERlc2t0b3BcXEZpbmFsUHJvamVjdFxcc3JjXFx1dGlsc1xcZ2V0LUlQLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcInNlcnZlci1vbmx5XCI7XHJcblxyXG5pbXBvcnQgeyBoZWFkZXJzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldElQKCkge1xyXG4gIGNvbnN0IGhlYWRlcnNMaXN0ID0gYXdhaXQgaGVhZGVycygpO1xyXG5cclxuICBjb25zdCBpcCA9IGhlYWRlcnNMaXN0LmdldCgnY2YtY29ubmVjdGluZy1pcCcpXHJcbiAgICB8fCBoZWFkZXJzTGlzdC5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpXHJcbiAgICB8fCBoZWFkZXJzTGlzdC5nZXQoJ3gtcmVhbC1pcCcpXHJcbiAgICB8fCBoZWFkZXJzTGlzdC5nZXQoJ3RydWUtY2xpZW50LWlwJylcclxuICAgIHx8IGhlYWRlcnNMaXN0LmdldCgneC1jbGllbnQtaXAnKVxyXG4gICAgfHwgaGVhZGVyc0xpc3QuZ2V0KCd4LWNsdXN0ZXItY2xpZW50LWlwJylcclxuICAgIHx8IG51bGw7XHJcblxyXG4gIGlmICghaXApIHtcclxuICAgIHJldHVybiBudWxsXHJcbiAgfVxyXG5cclxuICByZXR1cm4gaXA7XHJcbn1cclxuIl0sIm5hbWVzIjpbImhlYWRlcnMiLCJnZXRJUCIsImhlYWRlcnNMaXN0IiwiaXAiLCJnZXQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/get-IP.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/is-prod.ts":
/*!******************************!*\
  !*** ./src/utils/is-prod.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"development\" === \"production\");\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvaXMtcHJvZC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWVBLGtCQUF5QixZQUFZLEVBQUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW5cXERlc2t0b3BcXEZpbmFsUHJvamVjdFxcc3JjXFx1dGlsc1xcaXMtcHJvZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCI7XHJcbiJdLCJuYW1lcyI6WyJwcm9jZXNzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/is-prod.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/kv-session.ts":
/*!*********************************!*\
  !*** ./src/utils/kv-session.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CURRENT_SESSION_VERSION: () => (/* binding */ CURRENT_SESSION_VERSION),\n/* harmony export */   createKVSession: () => (/* binding */ createKVSession),\n/* harmony export */   deleteKVSession: () => (/* binding */ deleteKVSession),\n/* harmony export */   getAllSessionIdsOfUser: () => (/* binding */ getAllSessionIdsOfUser),\n/* harmony export */   getKV: () => (/* binding */ getKV),\n/* harmony export */   getKVSession: () => (/* binding */ getKVSession),\n/* harmony export */   getSessionKey: () => (/* binding */ getSessionKey),\n/* harmony export */   updateAllSessionsOfUser: () => (/* binding */ updateAllSessionsOfUser),\n/* harmony export */   updateKVSession: () => (/* binding */ updateKVSession)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @opennextjs/cloudflare */ \"(rsc)/./node_modules/.pnpm/@opennextjs+cloudflare@1.6.5_wrangler@4.28.0/node_modules/@opennextjs/cloudflare/dist/api/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/utils/auth */ \"(rsc)/./src/utils/auth.ts\");\n/* harmony import */ var _get_IP__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./get-IP */ \"(rsc)/./src/utils/get-IP.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/constants */ \"(rsc)/./src/constants.ts\");\n\n\n\n\n\n\nconst SESSION_PREFIX = \"session:\";\nfunction getSessionKey(userId, sessionId) {\n    return `${SESSION_PREFIX}${userId}:${sessionId}`;\n}\n/**\r\n *  !!!!!!!!!!!!!!!!!!!!!\r\n *  !!!   IMPORTANT   !!!\r\n *  !!!!!!!!!!!!!!!!!!!!!\r\n *\r\n * IF YOU MAKE ANY CHANGES TO THE KVSESSION TYPE ABOVE, YOU NEED TO INCREMENT THIS VERSION.\r\n * THIS IS HOW WE TRACK WHEN WE NEED TO UPDATE THE SESSIONS IN THE KV STORE.\r\n */ const CURRENT_SESSION_VERSION = 2;\nasync function getKV() {\n    const { env } = (0,_opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_1__.getCloudflareContext)();\n    return env.NEXT_INC_CACHE_KV;\n}\nasync function createKVSession({ sessionId, userId, expiresAt, user, authenticationType, passkeyCredentialId, teams }) {\n    const { cf } = (0,_opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_1__.getCloudflareContext)();\n    const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.headers)();\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const session = {\n        id: sessionId,\n        userId,\n        expiresAt: expiresAt.getTime(),\n        createdAt: Date.now(),\n        country: cf?.country,\n        city: cf?.city,\n        continent: cf?.continent,\n        ip: await (0,_get_IP__WEBPACK_IMPORTED_MODULE_4__.getIP)(),\n        userAgent: headersList.get('user-agent'),\n        user,\n        authenticationType,\n        passkeyCredentialId,\n        teams,\n        version: CURRENT_SESSION_VERSION\n    };\n    // Check if user has reached the session limit\n    const existingSessions = await getAllSessionIdsOfUser(userId);\n    // If user has MAX_SESSIONS_PER_USER or more sessions, delete the oldest one\n    if (existingSessions.length >= _constants__WEBPACK_IMPORTED_MODULE_5__.MAX_SESSIONS_PER_USER) {\n        // Sort sessions by expiration time (oldest first)\n        const sortedSessions = [\n            ...existingSessions\n        ].sort((a, b)=>{\n            // If a session has no expiration, treat it as oldest\n            if (!a.absoluteExpiration) return -1;\n            if (!b.absoluteExpiration) return 1;\n            return a.absoluteExpiration.getTime() - b.absoluteExpiration.getTime();\n        });\n        // Delete the oldest session\n        const oldestSessionKey = sortedSessions?.[0]?.key;\n        const oldestSessionId = oldestSessionKey?.split(':')?.[2]; // Extract sessionId from key\n        await deleteKVSession(oldestSessionId, userId);\n    }\n    await kv.put(getSessionKey(userId, sessionId), JSON.stringify(session), {\n        expirationTtl: Math.floor((expiresAt.getTime() - Date.now()) / 1000)\n    });\n    return session;\n}\nasync function getKVSession(sessionId, userId) {\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const sessionStr = await kv.get(getSessionKey(userId, sessionId));\n    if (!sessionStr) return null;\n    const session = JSON.parse(sessionStr);\n    if (session?.user?.createdAt) {\n        session.user.createdAt = new Date(session.user.createdAt);\n    }\n    if (session?.user?.updatedAt) {\n        session.user.updatedAt = new Date(session.user.updatedAt);\n    }\n    if (session?.user?.lastCreditRefreshAt) {\n        session.user.lastCreditRefreshAt = new Date(session.user.lastCreditRefreshAt);\n    }\n    if (session?.user?.emailVerified) {\n        session.user.emailVerified = new Date(session.user.emailVerified);\n    }\n    return session;\n}\nasync function updateKVSession(sessionId, userId, expiresAt) {\n    const session = await getKVSession(sessionId, userId);\n    if (!session) return null;\n    const updatedUser = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserFromDB)(userId);\n    if (!updatedUser) {\n        throw new Error(\"User not found\");\n    }\n    // Get updated teams data with permissions\n    const teamsWithPermissions = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserTeamsWithPermissions)(userId);\n    const updatedSession = {\n        ...session,\n        version: CURRENT_SESSION_VERSION,\n        expiresAt: expiresAt.getTime(),\n        user: updatedUser,\n        teams: teamsWithPermissions\n    };\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    await kv.put(getSessionKey(userId, sessionId), JSON.stringify(updatedSession), {\n        expirationTtl: Math.floor((expiresAt.getTime() - Date.now()) / 1000)\n    });\n    return updatedSession;\n}\nasync function deleteKVSession(sessionId, userId) {\n    const session = await getKVSession(sessionId, userId);\n    if (!session) return;\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    await kv.delete(getSessionKey(userId, sessionId));\n}\nasync function getAllSessionIdsOfUser(userId) {\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const sessions = await kv.list({\n        prefix: getSessionKey(userId, \"\")\n    });\n    return sessions.keys.map((session)=>({\n            key: session.name,\n            absoluteExpiration: session.expiration ? new Date(session.expiration * 1000) : undefined\n        }));\n}\n/**\r\n * Update all sessions of a user. It can only be called in a server actions and api routes.\r\n * @param userId\r\n */ async function updateAllSessionsOfUser(userId) {\n    const sessions = await getAllSessionIdsOfUser(userId);\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const newUserData = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserFromDB)(userId);\n    if (!newUserData) return;\n    // Get updated teams data with permissions\n    const teamsWithPermissions = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserTeamsWithPermissions)(userId);\n    for (const sessionObj of sessions){\n        const session = await kv.get(sessionObj.key);\n        if (!session) continue;\n        const sessionData = JSON.parse(session);\n        // Only update non-expired sessions\n        if (sessionObj.absoluteExpiration && sessionObj.absoluteExpiration.getTime() > Date.now()) {\n            const ttlInSeconds = Math.floor((sessionObj.absoluteExpiration.getTime() - Date.now()) / 1000);\n            await kv.put(sessionObj.key, JSON.stringify({\n                ...sessionData,\n                user: newUserData,\n                teams: teamsWithPermissions\n            }), {\n                expirationTtl: ttlInSeconds\n            });\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFFL0QsS0FBSyxNQUFNcUUsY0FBY1YsU0FBVTtRQUNqQyxNQUFNM0MsVUFBVSxNQUFNRixHQUFHYSxHQUFHLENBQUMwQyxXQUFXL0IsR0FBRztRQUMzQyxJQUFJLENBQUN0QixTQUFTO1FBRWQsTUFBTXNELGNBQWMzQixLQUFLTyxLQUFLLENBQUNsQztRQUUvQixtQ0FBbUM7UUFDbkMsSUFBSXFELFdBQVdqQyxrQkFBa0IsSUFBSWlDLFdBQVdqQyxrQkFBa0IsQ0FBQ2xCLE9BQU8sS0FBS0UsS0FBS0MsR0FBRyxJQUFJO1lBQ3pGLE1BQU1rRCxlQUFlekIsS0FBS0MsS0FBSyxDQUFDLENBQUNzQixXQUFXakMsa0JBQWtCLENBQUNsQixPQUFPLEtBQUtFLEtBQUtDLEdBQUcsRUFBQyxJQUFLO1lBRXpGLE1BQU1QLEdBQUc0QixHQUFHLENBQ1YyQixXQUFXL0IsR0FBRyxFQUNkSyxLQUFLQyxTQUFTLENBQUM7Z0JBQ2IsR0FBRzBCLFdBQVc7Z0JBQ2Q5RCxNQUFNNEQ7Z0JBQ056RCxPQUFPNkM7WUFDVCxJQUNBO2dCQUFFWCxlQUFlMEI7WUFBYTtRQUVsQztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW5cXERlc2t0b3BcXEZpbmFsUHJvamVjdFxcc3JjXFx1dGlsc1xca3Ytc2Vzc2lvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXCJzZXJ2ZXItb25seVwiO1xyXG5cclxuaW1wb3J0IHsgZ2V0Q2xvdWRmbGFyZUNvbnRleHQgfSBmcm9tIFwiQG9wZW5uZXh0anMvY2xvdWRmbGFyZVwiO1xyXG5pbXBvcnQgeyBoZWFkZXJzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xyXG5cclxuaW1wb3J0IHsgZ2V0VXNlckZyb21EQiwgZ2V0VXNlclRlYW1zV2l0aFBlcm1pc3Npb25zIH0gZnJvbSBcIkAvdXRpbHMvYXV0aFwiO1xyXG5pbXBvcnQgeyBnZXRJUCB9IGZyb20gXCIuL2dldC1JUFwiO1xyXG5pbXBvcnQgeyBNQVhfU0VTU0lPTlNfUEVSX1VTRVIgfSBmcm9tIFwiQC9jb25zdGFudHNcIjtcclxuY29uc3QgU0VTU0lPTl9QUkVGSVggPSBcInNlc3Npb246XCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Vzc2lvbktleSh1c2VySWQ6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBgJHtTRVNTSU9OX1BSRUZJWH0ke3VzZXJJZH06JHtzZXNzaW9uSWR9YDtcclxufVxyXG5cclxudHlwZSBLVlNlc3Npb25Vc2VyID0gRXhjbHVkZTxBd2FpdGVkPFJldHVyblR5cGU8dHlwZW9mIGdldFVzZXJGcm9tREI+PiwgdW5kZWZpbmVkPjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgS1ZTZXNzaW9uIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG4gIGV4cGlyZXNBdDogbnVtYmVyO1xyXG4gIGNyZWF0ZWRBdDogbnVtYmVyO1xyXG4gIHVzZXI6IEtWU2Vzc2lvblVzZXIgJiB7XHJcbiAgICBpbml0aWFscz86IHN0cmluZztcclxuICB9O1xyXG4gIGNvdW50cnk/OiBzdHJpbmc7XHJcbiAgY2l0eT86IHN0cmluZztcclxuICBjb250aW5lbnQ/OiBzdHJpbmc7XHJcbiAgaXA/OiBzdHJpbmcgfCBudWxsO1xyXG4gIHVzZXJBZ2VudD86IHN0cmluZyB8IG51bGw7XHJcbiAgYXV0aGVudGljYXRpb25UeXBlPzogXCJwYXNza2V5XCIgfCBcInBhc3N3b3JkXCIgfCBcImdvb2dsZS1vYXV0aFwiO1xyXG4gIHBhc3NrZXlDcmVkZW50aWFsSWQ/OiBzdHJpbmc7XHJcbiAgLyoqXHJcbiAgICogVGVhbXMgZGF0YSAtIGNvbnRhaW5zIGxpc3Qgb2YgdGVhbXMgdGhlIHVzZXIgaXMgYSBtZW1iZXIgb2ZcclxuICAgKiBhbG9uZyB3aXRoIHJvbGUgYW5kIHBlcm1pc3Npb25zIGRhdGFcclxuICAgKi9cclxuICB0ZWFtcz86IHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBzbHVnOiBzdHJpbmc7XHJcbiAgICByb2xlOiB7XHJcbiAgICAgIGlkOiBzdHJpbmc7XHJcbiAgICAgIG5hbWU6IHN0cmluZztcclxuICAgICAgaXNTeXN0ZW1Sb2xlOiBib29sZWFuO1xyXG4gICAgfTtcclxuICAgIHBlcm1pc3Npb25zOiBzdHJpbmdbXTtcclxuICB9W107XHJcbiAgLyoqXHJcbiAgICogICEhISEhISEhISEhISEhISEhISEhIVxyXG4gICAqICAhISEgICBJTVBPUlRBTlQgICAhISFcclxuICAgKiAgISEhISEhISEhISEhISEhISEhISEhXHJcbiAgICpcclxuICAgKiAgSUYgWU9VIE1BS0UgQU5ZIENIQU5HRVMgVE8gVEhJUyBPQkpFQ1QgRE9OJ1QgRk9SR0VUIFRPIElOQ1JFTUVOVCBcIkNVUlJFTlRfU0VTU0lPTl9WRVJTSU9OXCIgQkVMT1dcclxuICAgKiAgSUYgWU9VIEZPUkdFVCwgVEhFIFNFU1NJT04gV0lMTCBOT1QgQkUgVVBEQVRFRCBJTiBUSEUgREFUQUJBU0VcclxuICAgKi9cclxuICB2ZXJzaW9uPzogbnVtYmVyO1xyXG59XHJcblxyXG4vKipcclxuICogICEhISEhISEhISEhISEhISEhISEhIVxyXG4gKiAgISEhICAgSU1QT1JUQU5UICAgISEhXHJcbiAqICAhISEhISEhISEhISEhISEhISEhISFcclxuICpcclxuICogSUYgWU9VIE1BS0UgQU5ZIENIQU5HRVMgVE8gVEhFIEtWU0VTU0lPTiBUWVBFIEFCT1ZFLCBZT1UgTkVFRCBUTyBJTkNSRU1FTlQgVEhJUyBWRVJTSU9OLlxyXG4gKiBUSElTIElTIEhPVyBXRSBUUkFDSyBXSEVOIFdFIE5FRUQgVE8gVVBEQVRFIFRIRSBTRVNTSU9OUyBJTiBUSEUgS1YgU1RPUkUuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgQ1VSUkVOVF9TRVNTSU9OX1ZFUlNJT04gPSAyO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEtWKCkge1xyXG4gIGNvbnN0IHsgZW52IH0gPSBnZXRDbG91ZGZsYXJlQ29udGV4dCgpO1xyXG4gIHJldHVybiBlbnYuTkVYVF9JTkNfQ0FDSEVfS1Y7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlS1ZTZXNzaW9uUGFyYW1zIGV4dGVuZHMgT21pdDxLVlNlc3Npb24sIFwiaWRcIiB8IFwiY3JlYXRlZEF0XCIgfCBcImV4cGlyZXNBdFwiPiB7XHJcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XHJcbiAgZXhwaXJlc0F0OiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlS1ZTZXNzaW9uKHtcclxuICBzZXNzaW9uSWQsXHJcbiAgdXNlcklkLFxyXG4gIGV4cGlyZXNBdCxcclxuICB1c2VyLFxyXG4gIGF1dGhlbnRpY2F0aW9uVHlwZSxcclxuICBwYXNza2V5Q3JlZGVudGlhbElkLFxyXG4gIHRlYW1zXHJcbn06IENyZWF0ZUtWU2Vzc2lvblBhcmFtcyk6IFByb21pc2U8S1ZTZXNzaW9uPiB7XHJcbiAgY29uc3QgeyBjZiB9ID0gZ2V0Q2xvdWRmbGFyZUNvbnRleHQoKTtcclxuICBjb25zdCBoZWFkZXJzTGlzdCA9IGF3YWl0IGhlYWRlcnMoKTtcclxuICBjb25zdCBrdiA9IGF3YWl0IGdldEtWKCk7XHJcblxyXG4gIGlmICgha3YpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGNvbm5lY3QgdG8gS1Ygc3RvcmVcIik7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzZXNzaW9uOiBLVlNlc3Npb24gPSB7XHJcbiAgICBpZDogc2Vzc2lvbklkLFxyXG4gICAgdXNlcklkLFxyXG4gICAgZXhwaXJlc0F0OiBleHBpcmVzQXQuZ2V0VGltZSgpLFxyXG4gICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpLFxyXG4gICAgY291bnRyeTogY2Y/LmNvdW50cnksXHJcbiAgICBjaXR5OiBjZj8uY2l0eSxcclxuICAgIGNvbnRpbmVudDogY2Y/LmNvbnRpbmVudCxcclxuICAgIGlwOiBhd2FpdCBnZXRJUCgpLFxyXG4gICAgdXNlckFnZW50OiBoZWFkZXJzTGlzdC5nZXQoJ3VzZXItYWdlbnQnKSxcclxuICAgIHVzZXIsXHJcbiAgICBhdXRoZW50aWNhdGlvblR5cGUsXHJcbiAgICBwYXNza2V5Q3JlZGVudGlhbElkLFxyXG4gICAgdGVhbXMsXHJcbiAgICB2ZXJzaW9uOiBDVVJSRU5UX1NFU1NJT05fVkVSU0lPTlxyXG4gIH07XHJcblxyXG4gIC8vIENoZWNrIGlmIHVzZXIgaGFzIHJlYWNoZWQgdGhlIHNlc3Npb24gbGltaXRcclxuICBjb25zdCBleGlzdGluZ1Nlc3Npb25zID0gYXdhaXQgZ2V0QWxsU2Vzc2lvbklkc09mVXNlcih1c2VySWQpO1xyXG5cclxuICAvLyBJZiB1c2VyIGhhcyBNQVhfU0VTU0lPTlNfUEVSX1VTRVIgb3IgbW9yZSBzZXNzaW9ucywgZGVsZXRlIHRoZSBvbGRlc3Qgb25lXHJcbiAgaWYgKGV4aXN0aW5nU2Vzc2lvbnMubGVuZ3RoID49IE1BWF9TRVNTSU9OU19QRVJfVVNFUikge1xyXG4gICAgLy8gU29ydCBzZXNzaW9ucyBieSBleHBpcmF0aW9uIHRpbWUgKG9sZGVzdCBmaXJzdClcclxuICAgIGNvbnN0IHNvcnRlZFNlc3Npb25zID0gWy4uLmV4aXN0aW5nU2Vzc2lvbnNdLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgLy8gSWYgYSBzZXNzaW9uIGhhcyBubyBleHBpcmF0aW9uLCB0cmVhdCBpdCBhcyBvbGRlc3RcclxuICAgICAgaWYgKCFhLmFic29sdXRlRXhwaXJhdGlvbikgcmV0dXJuIC0xO1xyXG4gICAgICBpZiAoIWIuYWJzb2x1dGVFeHBpcmF0aW9uKSByZXR1cm4gMTtcclxuICAgICAgcmV0dXJuIGEuYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKSAtIGIuYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIERlbGV0ZSB0aGUgb2xkZXN0IHNlc3Npb25cclxuICAgIGNvbnN0IG9sZGVzdFNlc3Npb25LZXkgPSBzb3J0ZWRTZXNzaW9ucz8uWzBdPy5rZXk7XHJcbiAgICBjb25zdCBvbGRlc3RTZXNzaW9uSWQgPSBvbGRlc3RTZXNzaW9uS2V5Py5zcGxpdCgnOicpPy5bMl07IC8vIEV4dHJhY3Qgc2Vzc2lvbklkIGZyb20ga2V5XHJcblxyXG4gICAgYXdhaXQgZGVsZXRlS1ZTZXNzaW9uKG9sZGVzdFNlc3Npb25JZCwgdXNlcklkKTtcclxuICB9XHJcblxyXG4gIGF3YWl0IGt2LnB1dChcclxuICAgIGdldFNlc3Npb25LZXkodXNlcklkLCBzZXNzaW9uSWQpLFxyXG4gICAgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbiksXHJcbiAgICB7XHJcbiAgICAgIGV4cGlyYXRpb25UdGw6IE1hdGguZmxvb3IoKGV4cGlyZXNBdC5nZXRUaW1lKCkgLSBEYXRlLm5vdygpKSAvIDEwMDApXHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIHNlc3Npb247XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRLVlNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxLVlNlc3Npb24gfCBudWxsPiB7XHJcbiAgY29uc3Qga3YgPSBhd2FpdCBnZXRLVigpO1xyXG5cclxuICBpZiAoIWt2KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBjb25uZWN0IHRvIEtWIHN0b3JlXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2Vzc2lvblN0ciA9IGF3YWl0IGt2LmdldChnZXRTZXNzaW9uS2V5KHVzZXJJZCwgc2Vzc2lvbklkKSk7XHJcbiAgaWYgKCFzZXNzaW9uU3RyKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgY29uc3Qgc2Vzc2lvbiA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0cikgYXMgS1ZTZXNzaW9uXHJcblxyXG4gIGlmIChzZXNzaW9uPy51c2VyPy5jcmVhdGVkQXQpIHtcclxuICAgIHNlc3Npb24udXNlci5jcmVhdGVkQXQgPSBuZXcgRGF0ZShzZXNzaW9uLnVzZXIuY3JlYXRlZEF0KTtcclxuICB9XHJcblxyXG4gIGlmIChzZXNzaW9uPy51c2VyPy51cGRhdGVkQXQpIHtcclxuICAgIHNlc3Npb24udXNlci51cGRhdGVkQXQgPSBuZXcgRGF0ZShzZXNzaW9uLnVzZXIudXBkYXRlZEF0KTtcclxuICB9XHJcblxyXG4gIGlmIChzZXNzaW9uPy51c2VyPy5sYXN0Q3JlZGl0UmVmcmVzaEF0KSB7XHJcbiAgICBzZXNzaW9uLnVzZXIubGFzdENyZWRpdFJlZnJlc2hBdCA9IG5ldyBEYXRlKHNlc3Npb24udXNlci5sYXN0Q3JlZGl0UmVmcmVzaEF0KTtcclxuICB9XHJcblxyXG4gIGlmIChzZXNzaW9uPy51c2VyPy5lbWFpbFZlcmlmaWVkKSB7XHJcbiAgICBzZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCA9IG5ldyBEYXRlKHNlc3Npb24udXNlci5lbWFpbFZlcmlmaWVkKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBzZXNzaW9uO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlS1ZTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgZXhwaXJlc0F0OiBEYXRlKTogUHJvbWlzZTxLVlNlc3Npb24gfCBudWxsPiB7XHJcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldEtWU2Vzc2lvbihzZXNzaW9uSWQsIHVzZXJJZCk7XHJcbiAgaWYgKCFzZXNzaW9uKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBnZXRVc2VyRnJvbURCKHVzZXJJZCk7XHJcblxyXG4gIGlmICghdXBkYXRlZFVzZXIpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIlVzZXIgbm90IGZvdW5kXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHVwZGF0ZWQgdGVhbXMgZGF0YSB3aXRoIHBlcm1pc3Npb25zXHJcbiAgY29uc3QgdGVhbXNXaXRoUGVybWlzc2lvbnMgPSBhd2FpdCBnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnModXNlcklkKTtcclxuXHJcbiAgY29uc3QgdXBkYXRlZFNlc3Npb246IEtWU2Vzc2lvbiA9IHtcclxuICAgIC4uLnNlc3Npb24sXHJcbiAgICB2ZXJzaW9uOiBDVVJSRU5UX1NFU1NJT05fVkVSU0lPTixcclxuICAgIGV4cGlyZXNBdDogZXhwaXJlc0F0LmdldFRpbWUoKSxcclxuICAgIHVzZXI6IHVwZGF0ZWRVc2VyLFxyXG4gICAgdGVhbXM6IHRlYW1zV2l0aFBlcm1pc3Npb25zXHJcbiAgfTtcclxuXHJcbiAgY29uc3Qga3YgPSBhd2FpdCBnZXRLVigpO1xyXG5cclxuICBpZiAoIWt2KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBjb25uZWN0IHRvIEtWIHN0b3JlXCIpO1xyXG4gIH1cclxuXHJcbiAgYXdhaXQga3YucHV0KFxyXG4gICAgZ2V0U2Vzc2lvbktleSh1c2VySWQsIHNlc3Npb25JZCksXHJcbiAgICBKU09OLnN0cmluZ2lmeSh1cGRhdGVkU2Vzc2lvbiksXHJcbiAgICB7XHJcbiAgICAgIGV4cGlyYXRpb25UdGw6IE1hdGguZmxvb3IoKGV4cGlyZXNBdC5nZXRUaW1lKCkgLSBEYXRlLm5vdygpKSAvIDEwMDApXHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9uO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlS1ZTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRLVlNlc3Npb24oc2Vzc2lvbklkLCB1c2VySWQpO1xyXG4gIGlmICghc2Vzc2lvbikgcmV0dXJuO1xyXG5cclxuICBjb25zdCBrdiA9IGF3YWl0IGdldEtWKCk7XHJcblxyXG4gIGlmICgha3YpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGNvbm5lY3QgdG8gS1Ygc3RvcmVcIik7XHJcbiAgfVxyXG5cclxuICBhd2FpdCBrdi5kZWxldGUoZ2V0U2Vzc2lvbktleSh1c2VySWQsIHNlc3Npb25JZCkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU2Vzc2lvbklkc09mVXNlcih1c2VySWQ6IHN0cmluZykge1xyXG4gIGNvbnN0IGt2ID0gYXdhaXQgZ2V0S1YoKTtcclxuXHJcbiAgaWYgKCFrdikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgY29ubmVjdCB0byBLViBzdG9yZVwiKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHNlc3Npb25zID0gYXdhaXQga3YubGlzdCh7IHByZWZpeDogZ2V0U2Vzc2lvbktleSh1c2VySWQsIFwiXCIpIH0pO1xyXG5cclxuICByZXR1cm4gc2Vzc2lvbnMua2V5cy5tYXAoKHNlc3Npb24pID0+ICh7XHJcbiAgICBrZXk6IHNlc3Npb24ubmFtZSxcclxuICAgIGFic29sdXRlRXhwaXJhdGlvbjogc2Vzc2lvbi5leHBpcmF0aW9uID8gbmV3IERhdGUoc2Vzc2lvbi5leHBpcmF0aW9uICogMTAwMCkgOiB1bmRlZmluZWRcclxuICB9KSlcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBhbGwgc2Vzc2lvbnMgb2YgYSB1c2VyLiBJdCBjYW4gb25seSBiZSBjYWxsZWQgaW4gYSBzZXJ2ZXIgYWN0aW9ucyBhbmQgYXBpIHJvdXRlcy5cclxuICogQHBhcmFtIHVzZXJJZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyKHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBnZXRBbGxTZXNzaW9uSWRzT2ZVc2VyKHVzZXJJZCk7XHJcbiAgY29uc3Qga3YgPSBhd2FpdCBnZXRLVigpO1xyXG5cclxuICBpZiAoIWt2KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBjb25uZWN0IHRvIEtWIHN0b3JlXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgbmV3VXNlckRhdGEgPSBhd2FpdCBnZXRVc2VyRnJvbURCKHVzZXJJZCk7XHJcblxyXG4gIGlmICghbmV3VXNlckRhdGEpIHJldHVybjtcclxuXHJcbiAgLy8gR2V0IHVwZGF0ZWQgdGVhbXMgZGF0YSB3aXRoIHBlcm1pc3Npb25zXHJcbiAgY29uc3QgdGVhbXNXaXRoUGVybWlzc2lvbnMgPSBhd2FpdCBnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnModXNlcklkKTtcclxuXHJcbiAgZm9yIChjb25zdCBzZXNzaW9uT2JqIG9mIHNlc3Npb25zKSB7XHJcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQga3YuZ2V0KHNlc3Npb25PYmoua2V5KTtcclxuICAgIGlmICghc2Vzc2lvbikgY29udGludWU7XHJcblxyXG4gICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBKU09OLnBhcnNlKHNlc3Npb24pIGFzIEtWU2Vzc2lvbjtcclxuXHJcbiAgICAvLyBPbmx5IHVwZGF0ZSBub24tZXhwaXJlZCBzZXNzaW9uc1xyXG4gICAgaWYgKHNlc3Npb25PYmouYWJzb2x1dGVFeHBpcmF0aW9uICYmIHNlc3Npb25PYmouYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKSA+IERhdGUubm93KCkpIHtcclxuICAgICAgY29uc3QgdHRsSW5TZWNvbmRzID0gTWF0aC5mbG9vcigoc2Vzc2lvbk9iai5hYnNvbHV0ZUV4cGlyYXRpb24uZ2V0VGltZSgpIC0gRGF0ZS5ub3coKSkgLyAxMDAwKTtcclxuXHJcbiAgICAgIGF3YWl0IGt2LnB1dChcclxuICAgICAgICBzZXNzaW9uT2JqLmtleSxcclxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAuLi5zZXNzaW9uRGF0YSxcclxuICAgICAgICAgIHVzZXI6IG5ld1VzZXJEYXRhLFxyXG4gICAgICAgICAgdGVhbXM6IHRlYW1zV2l0aFBlcm1pc3Npb25zLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIHsgZXhwaXJhdGlvblR0bDogdHRsSW5TZWNvbmRzIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImdldENsb3VkZmxhcmVDb250ZXh0IiwiaGVhZGVycyIsImdldFVzZXJGcm9tREIiLCJnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnMiLCJnZXRJUCIsIk1BWF9TRVNTSU9OU19QRVJfVVNFUiIsIlNFU1NJT05fUFJFRklYIiwiZ2V0U2Vzc2lvbktleSIsInVzZXJJZCIsInNlc3Npb25JZCIsIkNVUlJFTlRfU0VTU0lPTl9WRVJTSU9OIiwiZ2V0S1YiLCJlbnYiLCJORVhUX0lOQ19DQUNIRV9LViIsImNyZWF0ZUtWU2Vzc2lvbiIsImV4cGlyZXNBdCIsInVzZXIiLCJhdXRoZW50aWNhdGlvblR5cGUiLCJwYXNza2V5Q3JlZGVudGlhbElkIiwidGVhbXMiLCJjZiIsImhlYWRlcnNMaXN0Iiwia3YiLCJFcnJvciIsInNlc3Npb24iLCJpZCIsImdldFRpbWUiLCJjcmVhdGVkQXQiLCJEYXRlIiwibm93IiwiY291bnRyeSIsImNpdHkiLCJjb250aW5lbnQiLCJpcCIsInVzZXJBZ2VudCIsImdldCIsInZlcnNpb24iLCJleGlzdGluZ1Nlc3Npb25zIiwiZ2V0QWxsU2Vzc2lvbklkc09mVXNlciIsImxlbmd0aCIsInNvcnRlZFNlc3Npb25zIiwic29ydCIsImEiLCJiIiwiYWJzb2x1dGVFeHBpcmF0aW9uIiwib2xkZXN0U2Vzc2lvbktleSIsImtleSIsIm9sZGVzdFNlc3Npb25JZCIsInNwbGl0IiwiZGVsZXRlS1ZTZXNzaW9uIiwicHV0IiwiSlNPTiIsInN0cmluZ2lmeSIsImV4cGlyYXRpb25UdGwiLCJNYXRoIiwiZmxvb3IiLCJnZXRLVlNlc3Npb24iLCJzZXNzaW9uU3RyIiwicGFyc2UiLCJ1cGRhdGVkQXQiLCJsYXN0Q3JlZGl0UmVmcmVzaEF0IiwiZW1haWxWZXJpZmllZCIsInVwZGF0ZUtWU2Vzc2lvbiIsInVwZGF0ZWRVc2VyIiwidGVhbXNXaXRoUGVybWlzc2lvbnMiLCJ1cGRhdGVkU2Vzc2lvbiIsImRlbGV0ZSIsInNlc3Npb25zIiwibGlzdCIsInByZWZpeCIsImtleXMiLCJtYXAiLCJuYW1lIiwiZXhwaXJhdGlvbiIsInVuZGVmaW5lZCIsInVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyIiwibmV3VXNlckRhdGEiLCJzZXNzaW9uT2JqIiwic2Vzc2lvbkRhdGEiLCJ0dGxJblNlY29uZHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/kv-session.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/name-initials.ts":
/*!************************************!*\
  !*** ./src/utils/name-initials.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getInitials: () => (/* binding */ getInitials)\n/* harmony export */ });\n/**\r\n * Generates initials from a name string\r\n * @param name - The full name to generate initials from\r\n * @param maxLength - Maximum number of initials to return (default: 2)\r\n * @returns The initials as a string\r\n */ function getInitials(name, maxLength = 2) {\n    if (!name) return \"\";\n    // Split the name into parts and filter out empty strings\n    const parts = name.split(/\\s+/).filter(Boolean);\n    // If we have no parts, return empty string\n    if (parts.length === 0) return \"\";\n    // Take the first letter of each part up to maxLength\n    const initials = parts.slice(0, maxLength).map((part)=>part[0].toUpperCase()).join(\"\");\n    return initials;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvbmFtZS1pbml0aWFscy50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7O0NBS0MsR0FDTSxTQUFTQSxZQUFZQyxJQUFZLEVBQUVDLFlBQVksQ0FBQztJQUNyRCxJQUFJLENBQUNELE1BQU0sT0FBTztJQUVsQix5REFBeUQ7SUFDekQsTUFBTUUsUUFBUUYsS0FBS0csS0FBSyxDQUFDLE9BQU9DLE1BQU0sQ0FBQ0M7SUFFdkMsMkNBQTJDO0lBQzNDLElBQUlILE1BQU1JLE1BQU0sS0FBSyxHQUFHLE9BQU87SUFFL0IscURBQXFEO0lBQ3JELE1BQU1DLFdBQVdMLE1BQ2RNLEtBQUssQ0FBQyxHQUFHUCxXQUNUUSxHQUFHLENBQUNDLENBQUFBLE9BQVFBLElBQUksQ0FBQyxFQUFFLENBQUNDLFdBQVcsSUFDL0JDLElBQUksQ0FBQztJQUVSLE9BQU9MO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW5cXERlc2t0b3BcXEZpbmFsUHJvamVjdFxcc3JjXFx1dGlsc1xcbmFtZS1pbml0aWFscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogR2VuZXJhdGVzIGluaXRpYWxzIGZyb20gYSBuYW1lIHN0cmluZ1xyXG4gKiBAcGFyYW0gbmFtZSAtIFRoZSBmdWxsIG5hbWUgdG8gZ2VuZXJhdGUgaW5pdGlhbHMgZnJvbVxyXG4gKiBAcGFyYW0gbWF4TGVuZ3RoIC0gTWF4aW11bSBudW1iZXIgb2YgaW5pdGlhbHMgdG8gcmV0dXJuIChkZWZhdWx0OiAyKVxyXG4gKiBAcmV0dXJucyBUaGUgaW5pdGlhbHMgYXMgYSBzdHJpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRJbml0aWFscyhuYW1lOiBzdHJpbmcsIG1heExlbmd0aCA9IDIpOiBzdHJpbmcge1xyXG4gIGlmICghbmFtZSkgcmV0dXJuIFwiXCJcclxuXHJcbiAgLy8gU3BsaXQgdGhlIG5hbWUgaW50byBwYXJ0cyBhbmQgZmlsdGVyIG91dCBlbXB0eSBzdHJpbmdzXHJcbiAgY29uc3QgcGFydHMgPSBuYW1lLnNwbGl0KC9cXHMrLykuZmlsdGVyKEJvb2xlYW4pXHJcblxyXG4gIC8vIElmIHdlIGhhdmUgbm8gcGFydHMsIHJldHVybiBlbXB0eSBzdHJpbmdcclxuICBpZiAocGFydHMubGVuZ3RoID09PSAwKSByZXR1cm4gXCJcIlxyXG5cclxuICAvLyBUYWtlIHRoZSBmaXJzdCBsZXR0ZXIgb2YgZWFjaCBwYXJ0IHVwIHRvIG1heExlbmd0aFxyXG4gIGNvbnN0IGluaXRpYWxzID0gcGFydHNcclxuICAgIC5zbGljZSgwLCBtYXhMZW5ndGgpXHJcbiAgICAubWFwKHBhcnQgPT4gcGFydFswXS50b1VwcGVyQ2FzZSgpKVxyXG4gICAgLmpvaW4oXCJcIilcclxuXHJcbiAgcmV0dXJuIGluaXRpYWxzXHJcbn1cclxuIl0sIm5hbWVzIjpbImdldEluaXRpYWxzIiwibmFtZSIsIm1heExlbmd0aCIsInBhcnRzIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGVuZ3RoIiwiaW5pdGlhbHMiLCJzbGljZSIsIm1hcCIsInBhcnQiLCJ0b1VwcGVyQ2FzZSIsImpvaW4iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/name-initials.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c","vendor-chunks/drizzle-orm@0.39.3","vendor-chunks/zod@3.25.67","vendor-chunks/zsa@0.6.0_zod@3.25.67","vendor-chunks/@noble+hashes@1.8.0","vendor-chunks/@opennextjs+cloudflare@1.6.5_wrangler@4.28.0","vendor-chunks/@oslojs+encoding@1.1.0","vendor-chunks/@paralleldrive+cuid2@2.2.2","vendor-chunks/ms@2.1.3"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.3.5_@babel+core@7.2_59a685cecc86146db29560d6fd5f016c/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdmin%5CDesktop%5CFinalProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();